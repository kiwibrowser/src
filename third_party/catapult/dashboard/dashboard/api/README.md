# Perf dashboard API

## Authenticating
The perf dashboard API uses OAuth to authenticate. You must either have a
Google account or a service account to access the API. See
[examples](/dashboard/dashboard/api/examples/) directory
for examples of how to access the API.

## Alerts
URL patterns for accessing alerts:

 * `/api/alerts/bug_id/id`: Get all the alerts associated with bug `id`.
 * `/api/alerts/keys/comma_sep_list`: Get the alerts with the given list of
   keys, separated by commas.
 * `/api/alerts/rev/revision`: Get all the alerts with `revision` in the
   revision range. Note that `revision` should be the revision that is sent to
   the perf dashboard as the point ID; for ChromiumPerf it is the chromium
   commit pos; for v8 master it is the v8 commit pos.
 * `/api/alerts/history/N`: Get all the alerts for N days (defaults to 7).
   Can specify a `sheriff` param in postdata, defaults to `Chromium Perf
   Sheriff`. Can specify an `improvements` param equal to 1 to include
   improvements. Can specify a `benchmark` param equal to the name to include
   only alerts for a given benchmark.

No matter what the url pattern, the alerts API returns a JSON list of alerts
with the following fields:

 * `date`: Date the alert fired in YYYY-MM-DD format
 * `master`: Buildbot master the alert fired on.
 * `bot`: Buildbot device type the alert fired on (for example, "nexus 7").
 * `test`: Test path of the test the alert was fired on. This contains the
    benchmark/metric/page, like page_cycler/time_to_load/cnn.
 * `ref_test`: If there was a ref build, the test_path of the ref build.
 * `testsuite`: Name of the benchmark the alert was fired on.
 * `recovered`: Whether the dashboard was able to detect that the alert
    recovered. Note that this is not possible to detect perfectly, as perf
    graphs are noisy and there may be multiple performance changes. The
    dashboard errs on the side of false negatives, only marking an alert
    recovered if it finds a change almost exactly opposite of the one in the
    alert.
 * `percent_changed`: The percentage difference before/after the alert.
 * `absolute_delta`: The difference before/after the alert, in `units`.
 * `median_before_anomaly`: The median value of the chart segment before the
    alert, in `units`.
 * `median_after_anomaly`: The median value of the chart segment after the
    alert, in `units`.
 * `units`: The units for the metric that was alerted on (for example,
    milliseconds).
 * `improvement`: true if the alert fired on an improvement; false otherwise.
    (note improvements can be filtered out of the history API with the
    `improvements` param).
 * `start_revision`: Start of the revision range where the change occurred.
 * `end_revision`: End of the revision range where the change occurred.
 * `dashboard_link`: Link to view the chart with the alert on the perf
    dashboard.
 * `bug_id`: The bug linked to the alert in the perf dashboard. -1 means the
    perf sheriff marked the bug invalid, and -2 means ignored (known issue).
    An empty bug id means the alert has not been triaged yet.
 * `group`: Unique id of the group the alert was placed in by the perf
    dashboard.
 * `key`: Unique id of the alert, generated by the perf dashboard.

## Bugs

For internal users only, the bugs API gives data about bugs so that it can
easily be lined up with alerts. URL pattern for accessing bugs:

 * `/api/bugs/id`: Get all the information about bug `id`.

The bugs API returns the following JSON about the bug:

 * `author`: Email of the issue author
 * `legacy_bisects`: List of bisects (to be replaced by pinpoint). Each has:
   * `status`: Job status, such as "started" or "failed
   * `bot`: Name of the bisector the job ran on,
   * `buildbucket_link`: Link to buildbucket page with more info
   * `command`: The command the bisect was run with
   * `metric`: The metric that was bisected
 * `cc`: List of emails cc-ed to the issue
 * `comments`: List of comments. Each has:
   * `content`: Text of the comment
   * `author`: Email of the comment author
   * `published`: Date the comment was published, in milliseconds since 1970
 * `components`: List of components associated with the issue
 * `id`: The same id that was passed in
 * `labels`: List of labels associated with the issue
 * `published`: Date the comment was published, in milliseconds since 1970
 * `state`: Issue state (open or closed)
 * `status`: Status of work on the issue (Assigned, Fixed, etc)
 * `summary`: The issue summary/title text.

 ## Timeseries

 URL patterns for accessing timeseries:

  * `/api/list_timeseries/benchmark`: List all the monitored timeseries
    associated with `benchmark`. Takes an optional `sheriff` param in postdata,
    which can be set to a name of the seriff rotation or `all` to search for
    metrics in all rotations. If not specified, the `Chromium Perf Sheriff`
    rotation is used. Returns an array of test_paths
    (master/bot/benchmark/metric/page).
  * `/api/timeseries/test_path`: Return the timeseries data for the given
    `test_path` as JSON. Can specify `num_days` param in postdata, defaults to
    30.
