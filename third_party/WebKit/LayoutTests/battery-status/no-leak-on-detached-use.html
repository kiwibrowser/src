<!DOCTYPE html>
<html>
<head>
<script src="../resources/js-test.js"></script>
</head>
<body onload="test()">
<script>
description("Check if calling navigator.getBattery() on a detached frame doesn't leak.");

window.jsTestIsAsync = true;

function test() {
  old_nav = window.frames[0].navigator;
  var p = document.getElementById('subframe');
  p.parentNode.removeChild(p);
  old_nav.getBattery();

  testPassed('DONE');
  finishJSTest();
}
</script>
<!-- iframe with some contents -->
<iframe src="data:text/html,<html></html>" id="subframe"></iframe>
</body>
</html>
