<iframe style="background-color: blue; width: 320px; height: 240px;"></iframe>
<!--
Tests that when a progressive png is loaded as document, the image is shown
progressively during loading.
The result image should show the dice image partially.
-->
<script>
if (window.testRunner) {
    testRunner.dumpAsTextWithPixelResults();
    testRunner.waitUntilDone();
}

function loadAndStall()
{
    return "http://127.0.0.1:8000/resources/load-and-stall.php";
}

function pngImage()
{
    return "?name=../../../images/resources/dice.png&mimeType=image%2Fpng";
}

function testDone()
{
    if (window.testRunner) {
        window.stop();
        testRunner.notifyDone();
    }
}

function runTest()
{
    document.querySelector("iframe").src = loadAndStall() + pngImage() + "&stallAt=45057&stallFor=60";
    setTimeout(testDone, 1500);
}

window.onload = function() {
    setTimeout(runTest, 0);
}
</script>
