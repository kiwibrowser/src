LavaPack.loadBundle([[3117,{"@ethereumjs/common":439,"@ethereumjs/tx":443,"bn.js":3118,buffer:2478,crypto:2592,"ethereumjs-util":3195,events:2479,"gridplus-sdk":5001,secp256k1:6461},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){const s=t("crypto"),n=t("events").EventEmitter,i=t("bn.js"),a=t("gridplus-sdk"),o=t("@ethereumjs/tx"),c=(t("@ethereumjs/common").default,t("ethereumjs-util")),u=t("secp256k1"),h="Lattice Hardware",l=12e4;class d extends n{constructor(t={}){super(),this.type=h,this._resetDefaults(),this.deserialize(t)}async deserialize(t={}){t.hdPath&&(this.hdPath=t.hdPath),t.creds&&(this.creds=t.creds),t.accounts&&(this.accounts=t.accounts),t.accountIndices&&(this.accountIndices=t.accountIndices),t.accountOpts&&(this.accountOpts=t.accountOpts),t.walletUID&&(this.walletUID=t.walletUID),t.name&&(this.appName=t.name),t.appName&&(this.appName=t.appName),t.network&&(this.network=t.network),t.page&&(this.page=t.page),t.sdkState&&(this.sdkState=t.sdkState)}setHdPath(t){this.hdPath=t}async serialize(){return{creds:this.creds,accounts:this.accounts,accountIndices:this.accountIndices,accountOpts:this.accountOpts,walletUID:this.walletUID,appName:this.appName,name:this.name,network:this.network,page:this.page,hdPath:this.hdPath,sdkState:this.sdkSession?this.sdkSession.getStateData():null}}isUnlocked(){return!!this._getCurrentWalletUID()&&!!this.sdkSession}async unlock(t=!1){if(!this.accountOpts||this.accounts.length>0&&this.accountOpts.length!=this.accounts.length)throw this.forgetDevice(),new Error("You can now add multiple Lattice and SafeCard accounts at the same time! "+"Your accounts have been cleared. Please press Continue to add them back in.");if(this.isUnlocked())return"Unlocked";const e=await this._getCreds();e&&(this.creds.deviceID=e.deviceID,this.creds.password=e.password,this.creds.endpoint=e.endpoint||null);return await this._initSession()&&t||await this._connect(),"Unlocked"}async addAccounts(t=1){if(-1e3===t)return this.forgetDevice(),[];if(t<=0)throw new Error("Number of accounts to add must be a positive number.");await this.unlock();const e=await this._fetchAddresses(t,this.unlockedAccount),r=this._getCurrentWalletUID();if(!r)throw await this._connect(),new Error("No active wallet found in Lattice. Please retry.");return e.forEach(((t,e)=>{let s=!1;for(let e=0;e<this.accounts.length;e++)this.accounts[e]===t&&this.accountOpts[e].walletUID===r&&this.accountOpts[e].hdPath===this.hdPath&&(s=!0);s||(this.accounts.push(t),this.accountIndices.push(this.unlockedAccount+e),this.accountOpts.push({walletUID:r,hdPath:this.hdPath}))})),this.accounts}async getAccounts(){return this.accounts?[...this.accounts]:[]}async signTransaction(t,e){let r,s;const n=e.toJSON();n.type=e._type||null;const i=await this._findSignerIdx(t),u=m(e).toNumber(),h=this.sdkSession.getFwVersion(),l=this.accountIndices[i],{hdPath:d}=this.accountOpts[i];if(h.major>0||h.minor>=15){const t={payload:e._type?e.getMessageToSign(!1):rlp.encode(e.getMessageToSign(!1)),curveType:a.Constants.SIGNING.CURVES.SECP256K1,hashType:a.Constants.SIGNING.HASHES.KECCAK256,encodingType:a.Constants.SIGNING.ENCODINGS.EVM,signerPath:this._getHDPathIndices(d,l)};r=await this.sdkSession.sign({data:t}),s=p(e,r)}else{let t;try{switch(t={chainId:u,nonce:`0x${e.nonce.toString("hex")}`||0,gasLimit:`0x${e.gasLimit.toString("hex")}`,to:e.to?e.to.toString("hex"):null,value:`0x${e.value.toString("hex")}`,data:0===e.data.length?null:`0x${e.data.toString("hex")}`,signerPath:this._getHDPathIndices(d,l)},e._type){case 2:if(null===e.maxPriorityFeePerGas||null===e.maxFeePerGas||e.maxPriorityFeePerGas===undefined||e.maxFeePerGas===undefined)throw new Error("`maxPriorityFeePerGas` and `maxFeePerGas` must be included for EIP1559 transactions.");t.maxPriorityFeePerGas=`0x${e.maxPriorityFeePerGas.toString("hex")}`,t.maxFeePerGas=`0x${e.maxFeePerGas.toString("hex")}`,t.accessList=e.accessList||[],t.type=2;break;case 1:t.accessList=e.accessList||[],t.gasPrice=`0x${e.gasPrice.toString("hex")}`,t.type=1;break;default:t.gasPrice=`0x${e.gasPrice.toString("hex")}`,t.type=null}if(0===h.major&&h.minor<=11&&t.type)throw new Error("Please update Lattice firmware.")}catch(t){throw new Error("Failed to build transaction.")}if(r=await this.sdkSession.sign({currency:"ETH",data:t}),!r.sig||!r.sig.r||!r.sig.s)throw new Error("No signature returned.");s=r.sig.v===undefined?p(e,r):0===r.sig.v.length?"0":r.sig.v.toString("hex")}n.r=c.addHexPrefix(r.sig.r.toString("hex")),n.s=c.addHexPrefix(r.sig.s.toString("hex")),n.v=c.addHexPrefix(s);if(null===await this._accountIdxInCurrentWallet(t))throw new Error("Wrong account. Please change your Lattice wallet or "+"switch to an account on your current active wallet.");return o.TransactionFactory.fromTxData(n,{common:e.common,freeze:Object.isFrozen(e)})}async signPersonalMessage(t,e){return this.signMessage(t,{payload:e,protocol:"signPersonal"})}async signTypedData(t,e,r){if(r.version&&"V4"!==r.version&&"V3"!==r.version)throw new Error(`Only signTypedData V3 and V4 messages (EIP712) are supported. Got version ${r.version}`);return this.signMessage(t,{payload:e,protocol:"eip712"})}async signMessage(t,e){const r=await this._findSignerIdx(t);let{payload:s,protocol:n}=e;s&&n||(s=e,n="signPersonal");const i=this.accountIndices[r],a=this.accountOpts[r].hdPath,o={currency:"ETH_MSG",data:{protocol:n,payload:s,signerPath:this._getHDPathIndices(a,i)}},c=await this.sdkSession.sign(o);if(!c.sig)throw new Error("No signature returned");let u;try{u=c.sig.v.toString("hex"),u.length<2&&(u=`0${u}`)}catch(t){throw new Error("Invalid signature format returned.")}if(null===await this._accountIdxInCurrentWallet(t))throw new Error("Wrong account. Please change your Lattice wallet or "+"switch to an account on your current active wallet.");return`0x${c.sig.r}${c.sig.s}${u}`}async exportAccount(t){throw new Error("exportAccount not supported by this device")}removeAccount(t){this.accounts.forEach(((e,r)=>{if(e.toLowerCase()===t.toLowerCase())return this.accounts.splice(r,1),this.accountIndices.splice(r,1),void this.accountOpts.splice(r,1)}))}async getFirstPage(){return this.page=0,this._getPage(0)}async getNextPage(){return this._getPage(1)}async getPreviousPage(){return this._getPage(-1)}setAccountToUnlock(t){this.unlockedAccount=parseInt(t,10)}forgetDevice(){this._resetDefaults()}async _findSignerIdx(t){const e=this.isUnlocked();await this.unlock(!0);let r=await this._accountIdxInCurrentWallet(t);if(null!==r)return r;if(e&&(await this._connect(),r=await this._accountIdxInCurrentWallet(t),null!==r))return r;throw new Error("Account not found in active Lattice wallet. Please switch.")}async _accountIdxInCurrentWallet(t){const e=await this._findAccountByAddress(t),{walletUID:r}=this.accountOpts[e],s=this.sdkSession.getActiveWallet();if(!s)throw this._connect(),new Error("No active wallet in Lattice.");const n=s.uid.toString("hex");return r.toString("hex")===n?e:null}async _findAccountByAddress(t){const e=await this.getAccounts();let r=-1;if(e.forEach(((e,s)=>{t.toLowerCase()===e.toLowerCase()&&(r=s)})),r<0)throw new Error("Signer not present");return r}_getHDPathIndices(t,e=0){const r=t.split("/").slice(1),s=[];let n=!1;if(r.forEach((t=>{const r="'"===t[t.length-1];let i=r?2147483648:0;t.indexOf("x")>-1?(i+=e,n=!0):i+=Number(r?t.slice(0,t.length-1):t),s.push(i)})),!1===n&&s.push(e),s.length>5)throw new Error("Only HD paths with up to 5 indices are allowed.");return s}_resetDefaults(){this.accounts=[],this.accountIndices=[],this.accountOpts=[],this.isLocked=!0,this.creds={deviceID:null,password:null,endpoint:null},this.walletUID=null,this.sdkSession=null,this.page=0,this.unlockedAccount=0,this.network=null,this.hdPath="m/44'/60'/0'/0/x"}async _openConnectorTab(t){try{const e=window.open(t);if(e)return{chromium:e};if(browser&&browser.tabs&&browser.tabs.create){return{firefox:await browser.tabs.create({url:t})}}throw new Error("Unknown browser context. Cannot open Lattice connector.")}catch(t){throw new Error("Failed to open Lattice connector.")}}async _findTabById(t){return browser.tabs.query({}).forEach((e=>{if(e.id===t)return e})),null}_getCreds(){return new Promise(((t,e)=>{if(this._hasCreds())return t();const s=this.appName?this.appName:"Unknown",n="https://lattice.gridplus.io",i=`${n}?keyring=${s}&forceLogin=true`;let a;function o(r){if(r.origin===n)try{clearInterval(a);const s=JSON.parse(r.data);return s.deviceID&&s.password?t(s):e(new Error("Invalid credentials returned from Lattice."))}catch(t){return e(t)}}this._openConnectorTab(i).then((s=>{if(s.chromium)window.addEventListener("message",o,!1),a=setInterval((()=>{if(s.chromium.closed)return clearInterval(a),e(new Error("Lattice connector closed."))}),500);else if(s.firefox){const n="&loginCache=";a=setInterval((()=>{this._findTabById(s.firefox.id).then((s=>{if(!s||!s.url)return e(new Error("Lattice connector closed."));const i=s.url.indexOf(n);if(i<0)return;const o=i+n.length;clearInterval(a);try{const n=r.from(s.url.slice(o),"base64").toString();browser.tabs.remove(s.id).then((()=>{const r=JSON.parse(n);return r.deviceID&&r.password?t(r):e(new Error("Invalid credentials returned from Lattice."))}))}catch(t){return e("Failed to get login data from Lattice. Please try again.")}}))}),500)}}))}))}async _connect(){try{this.sdkSession.timeout=2e4,await this.sdkSession.connect(this.creds.deviceID)}finally{this.sdkSession.timeout=l}}async _initSession(){if(this.isUnlocked())return;let t="https://signing.gridpl.us";this.creds.endpoint&&(t=this.creds.endpoint);let e={name:this.appName,baseUrl:t,timeout:l,privKey:this._genSessionKey(),network:this.network,skipRetryOnWrongWallet:!0};return this.sdkSession=new a.Client(e),!!e.stateData}async _fetchAddresses(t=1,e=0,r=[]){if(!this.isUnlocked())throw new Error("No connection to Lattice. Cannot fetch addresses.");return this.__fetchAddresses(t,e)}async __fetchAddresses(t=1,e=0,r=[]){if(0===t)return r;const s=this._hdPathHasInternalVarIdx(),n={currency:"ETH",startPath:this._getHDPathIndices(this.hdPath,e),n:s?1:t},i=await this.sdkSession.getAddresses(n);if(i.length<1)throw new Error("No addresses returned");return s?await this.__fetchAddresses(t-1,e+1,r.concat(i)):i}async _getPage(t=0){try{this.page+=t,this.page<0&&(this.page=0);const e=5*this.page;await this.unlock();const r=await this._fetchAddresses(5,e);return r.map(((t,r)=>({address:t,balance:null,index:e+r})))}catch(t){try{await this._connect();return await this._getPage(0)}catch(t){throw new Error("Failed to get accounts. Please forget the device and try again. "+"Make sure you do not have a locked SafeCard inserted.")}}}_hasCreds(){return null!==this.creds.deviceID&&null!==this.creds.password&&this.appName}_genSessionKey(){if(this.name&&!this.appName&&(this.appName=this.name),!this._hasCreds())throw new Error("No credentials -- cannot create session key!");const t=r.concat([r.from(this.creds.password),r.from(this.creds.deviceID),r.from(this.appName)]);return s.createHash("sha256").update(t).digest()}_hdPathHasInternalVarIdx(){const t=this.hdPath.split("/").slice(1);for(let e=0;e<t.length-1;e++)if(t[e].indexOf("x")>-1)return!0;return!1}_getCurrentWalletUID(){if(!this.sdkSession)return null;const t=this.sdkSession.getActiveWallet();return t&&t.uid?t.uid.toString("hex"):null}}function p(t,e){const s=t.getMessageToSign(!0),n=new Uint8Array(r.concat([e.sig.r,e.sig.s])),a=new Uint8Array(e.pubkey),c=u.ecdsaRecover(n,0,s,!1),h=u.ecdsaRecover(n,1,s,!1),l=r.from(a).toString("hex"),d=r.from(c).toString("hex"),p=r.from(h).toString("hex");let f;if(l===d)f=0;else{if(l!==p)return null;f=1}if(t._type)return f.toString(16);const g=m(t);return t.supports(o.Capability.EIP155ReplayProtection)||t.common&&t.common.gteHardfork("spuriousDragon")?g.muln(2).addn(35).addn(f).toString("hex"):new i(f).addn(27).toString("hex")}function m(t){return t&&t.common&&"function"==typeof t.common.chainIdBN?t.common.chainIdBN():t&&t.chainId?new i(t.chainId):new i(1)}d.type=h,e.exports=d}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-lattice-keyring",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-lattice-keyring/index.js"}],[14,{"../../../shared/constants/labels":6902,"../../../ui/helpers/utils/fetch":7461,"../../../ui/helpers/utils/util":7478,"../../../ui/misesPages/accountSet/misesNetwork.util":7517,"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"bignumber.js":2348,"mises-js-sdk":5893},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(t("@babel/runtime/helpers/defineProperty")),i=s(t("mises-js-sdk")),a=s(t("bignumber.js")),o=t("../../../ui/misesPages/accountSet/misesNetwork.util"),c=t("../../../ui/helpers/utils/fetch"),u=t("../../../ui/helpers/utils/util"),h=t("../../../shared/constants/labels");function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){(0,n.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}r.default=class{constructor({exportAccount:t,getKeyringAccounts:e,preferencesStore:r}){(0,n.default)(this,"timer",void 0),(0,n.default)(this,"intervalTime",2e5),(0,n.default)(this,"misesGasfee",void 0),this.exportAccount=t,this.getKeyringAccounts=e,this.store=r,this.config=i.default.newConfig(),this.coinDefine=i.default.newCoinDefine(),this.msgReader=i.default.newMsgReader(),this.coinDefine.load(),this.config.setLCDEndpoint(o.MISES_POINT),this.misesSdk=i.default.newSdk(this.config),this.misesUser=this.misesSdk.userMgr(),this.misesAppMgr=this.misesSdk.appMgr(),this.gasPriceAndLimit()}async updataBalance(){const t=await this.getAccountMisesBalance();Promise.all(t).then((t=>{let e=this.getAccountList();e=e.map((e=>{const r=t.findIndex((t=>t.address===e.address));return r>-1&&(e.misesBalance=t[r].misesBalance),e})),console.log("updataBalance",e),this.store.updateState({accountList:e})}))}getAccountList(){const{accountList:t}=this.store.getState();return t}getMisesAccount(t){if(t){const e=this.getAccountList().find((e=>e.address===t));if(e)return e}return{}}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=null)}async activate(t){return this.misesUser.activateUser(t)}getServerToken(t){return(0,c.request)({url:(0,o.getBaseApi)("signin"),method:"POST",body:t})}async getGasPrices(){try{return await(0,c.request)({url:(0,o.getBaseApi)("gasprices")})}catch(t){return Promise.resolve({})}}getActive(){return this.misesUser.activeUser()}async getMisesUserInfo(t){const{accountList:e}=this.store.getState(),r=this.getActive();console.log(r,"activeUser");const s=r?r.address():"";let n=e.find((e=>e.address===t))||null;const i=(new Date).getTime(),{auth:a}=await this.generateAuth(i);if(!n){const e=await this.getUserBalance(t);n={address:t,misesId:s,misesBalance:e,auth:a}}const o=(new Date).getTime(),c=n.token&&n.timestamp&&o-n.timestamp>6048e5;if(!n.token||c){try{const t=await this.getinstallreferrer(),{token:e}=await this.getServerToken({provider:"mises",user_authz:{auth:a},referrer:t});n.token=e,n.timestamp=(new Date).getTime()}catch(t){return Promise.reject(t,"get token Error")}const t=await r.isRegistered();if(t){console.log(t,"not found userinfo cache");const e=await r.info();n.userInfo={name:e.name||(0,u.shortenAddress)(s,h.MISES_TRUNCATED_ADDRESS_START_CHARS),avatarUrl:e.avatarUrl}}const i=e.findIndex((t=>t.address===n.address));i>-1?e[i]=n:e.push(n),this.store.updateState({accountList:e})}const l={nickname:n.userInfo?n.userInfo.name:(0,u.shortenAddress)(s,h.MISES_TRUNCATED_ADDRESS_START_CHARS),avatar:n.userInfo&&n.userInfo.avatarUrl,misesId:s,token:n.token};return console.log(l,"method:getMisesUserInfo"),l}async generateAuth(t,e){try{const r=e?await this.activate(e):this.getActive();return{auth:await r.generateAuth(t),misesId:r.address()}}catch(t){return console.log(t),t}}setToMisesPrivate(t){return console.log("Ready to call setmisesid",t),window.localStorage.setItem("setAccount",!0),new Promise((e=>chrome.misesPrivate?(chrome.misesPrivate.setMisesId(JSON.stringify(t)),e()):(console.log("The missesprivate object does not exist"),e("not defind setMisesId Function"))))}lockAll(){}async setUserInfo(t){try{const e=this.getActive(),r=(await e.info()).version.add(1),s=await e.setInfo(d(d({},t),{},{version:r})),{accountList:n}=this.store.getState(),i=e.address(),a=n.findIndex((t=>t.misesId===i));if(a>-1){const{token:e}=n[a]||{},r={nickname:t.name||(0,u.shortenAddress)(i,h.MISES_TRUNCATED_ADDRESS_START_CHARS),avatar:t.avatarUrl,token:e,misesId:i};e&&this.setToMisesPrivate(r),n[a].userInfo={name:r.nickname,avatarUrl:r.avatar},this.store.updateState({accountList:n}),console.log("update userinfo cache ",n[a])}return console.log("setinfo success",s),s}catch(t){return console.log(t,"error"),!1}}setUnFollow(t){console.log("mises:setUnFollow");return this.getActive().unfollow(t)}setFollow(t){console.log("mises:setFollow");return this.getActive().follow(t)}async connect({domain:t,appid:e,userid:r,permissions:s}){try{await this.misesAppMgr.ensureApp(e,t);return await this.misesSdk.connect(t,e,r,s)}catch(t){return!1}}disconnect({appid:t,userid:e}){return this.misesSdk.disconnect(t,e)}async getAccountMisesBalance(){const t=await this.getKeyringAccounts(),e=this.getAccountList();return t.map((async t=>{const r=await this.getUserBalance(t),s=await this.getMisesUser(t);return d(d({},e.find((e=>e.address===t))||{}),{},{address:t,misesBalance:r,misesId:s.address()})}))}async initMisesBalance(){const t=await this.getAccountMisesBalance();Promise.all(t).then((t=>{this.store.updateState({accountList:t})}))}async getMisesUser(t){const e=await this.exportAccount(t);return await this.misesUser.getUser(e)}async addressToMisesId(t){return(await this.getMisesUser(t)).address()}async getUserBalance(t){try{const e=await this.getMisesUser(t),r=await e.getBalanceUMIS();if(e&&r){const t=this.coinDefine.toCoinMIS(r);return t.denom=t.denom.toUpperCase(),t}return Promise.resolve({amount:"0",denom:"MIS"})}catch(t){return Promise.resolve({amount:"0",denom:"MIS"})}}async gasPriceAndLimit(){try{const t=(await this.getGasPrices()).propose_gasprice||this.config.gasPrice();return this.config.setGasPriceAndLimit(t,2e5),console.log("gasPriceAndLimit",t),t}catch(t){return Promise.resolve(this.config.gasPrice())}}async setMisesBook(t,e,r=!1,s=""){const n=this.getActive(),i=this.coinDefine.fromCoin({amount:e,denom:"mis"});if(console.log(r,"simulate"),console.log(s,"getMemo"),!r)try{const e=await n.sendUMIS(t,i,r,s);return this.store.updateState({transformFlag:0===e.code?"success":"error"}),console.log(e,s,"success-setMisesBook"),!0}catch(t){return this.store.updateState({transformFlag:"error"}),console.log(t,"err-setMisesBook"),!1}try{if(this.misesGasfee)return console.log("get cache misesGasfee"),this.misesGasfee;const e=await n.sendUMIS(t,i,r,s),o=await this.gasPriceAndLimit(),c=new a.default(o).times(new a.default(e.gasWanted||67751)).toString();console.log(o,e,"propose_gasprice");const u=this.coinDefine.fromCoin({amount:c,denom:"umis"}),h=await this.coinDefine.toCoinMIS(u);return e.gasWanted=h.amount,this.misesGasfee=e,e}catch(t){return console.log(t,"err-simulate"),!1}}resetTranstionFlag(){this.store.updateState({transformFlag:"loading"})}parseAmountItem(t){const e=t.value.replace("umis","|umis").split("|"),r=this.coinDefine.fromCoin({amount:e[0],denom:e[1]}),s=this.coinDefine.toCoinMIS(r);return{amount:s.amount,denom:s.denom.toUpperCase()}}parseTxEvents(t,e){return e.raw.reduce(((r,s)=>{var n,i;let a={amount:"",denom:""},o={},c={},u="",h="";let l="misesIn";switch(s.type){case"transfer":{const e=s.attributes.find((t=>"amount"===t.key));e&&(a=this.parseAmountItem(e)),o=s.attributes.find((t=>"recipient"===t.key)),c=s.attributes.find((t=>"sender"===t.key)),u=o&&o.value===t?"receive":"send",l=o&&o.value===t?"misesIn":"misesOut";break}case"withdraw_rewards":{const e=s.attributes.find((t=>"amount"===t.key));e&&(a=this.parseAmountItem(e)),c=s.attributes.find((t=>"validator"===t.key)),o={value:t},u="interaction",h="Withdraw Rewards",l="misesIn";break}case"delegate":{const e=s.attributes.find((t=>"amount"===t.key));e&&(a=this.parseAmountItem(e)),c={value:t},o=s.attributes.find((t=>"validator"===t.key)),u="interaction",h="Delegate",l="misesOut";break}case"redelegate":{const e=s.attributes.find((t=>"amount"===t.key));e&&(a=this.parseAmountItem(e)),c={value:t},o=s.attributes.find((t=>"destination_validator"===t.key)),u="interaction",h="Redelegate",l="misesOut";break}case"unbond":{const e=s.attributes.find((t=>"amount"===t.key));e&&(a=this.parseAmountItem(e)),c=s.attributes.find((t=>"validator"===t.key)),o={value:t},u="interaction",h="Undelegate",l="misesIn";break}default:return r}return r.concat({category:u,date:0===r.length?`${e.height}`:`${e.height}:${r.length}`,height:e.height,displayedStatusKey:"confirmed",isPending:!1,primaryCurrency:`${a.amount} ${a.denom}`,recipientAddress:null!==(n=o.value)&&void 0!==n?n:"",secondaryCurrency:`${a.amount} ${a.denom}`,senderAddress:null!==(i=c.value)&&void 0!==i?i:"",subtitle:"",subtitleContainsOrigin:!1,title:h,nonce:"0x0",transactionGroupType:l,hasCancelled:!1,hasRetried:!1,initialTransaction:{id:"0x0",hash:e.hash},primaryTransaction:{err:{},status:"",hash:e.hash}})}),[])}async recentTransactions(t,e){const r=this.getAccountList(),s=r.findIndex((t=>t.address===e)),n=r[s]||{};if("cache"===t)return console.log("get cache",n),n.transactions||[];console.log("get network");try{const t=this.getActive();let e=await t.recentTransactions(n.height);return console.log(e,"recentTransactions"),e=e.reduce(((e,r)=>(r.rawLog=JSON.parse(r.rawLog),r.raw=[],r.rawLog.forEach((t=>{r.raw=[...r.raw,...t.events]})),e.concat(this.parseTxEvents(t.address(),r)))),[]),s>-1&&(r[s].transactions=e,this.store.updateState({accountList:r})),console.log(e),e}catch(t){return console.log(t),Promise.reject(t)}}getAccountFlag(){return window.localStorage.getItem("setAccount")}async setAccountTransactionsHeight(t){const e=this.getAccountList(),r=e.findIndex((e=>e.address===t));if(r>-1){const{transactions:t=[]}=e[r],s=t[0]||{};console.log(s),e[r].height=s.height+1,this.store.updateState({accountList:e})}}getinstallreferrer(){return new Promise((t=>{chrome.misesPrivate&&chrome.misesPrivate.getInstallReferrer?chrome.misesPrivate.getInstallReferrer((e=>{t(e)})):t("")}))}async postTx(t){console.log(t,"postTx:getParmas===");const e=this.getActive(),r=await e.postTx(t.msgs,"",t.gasFee,t.gasLimit);return 0!==r.code?Promise.reject(r.rawLog):r}getReader(t){return this.msgReader.summary(t)}}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/mises.js"}],[3153,{"@ethereumjs/tx":443,buffer:2478,"ethereumjs-util":3195,events:2479,hdkey:3154,"trezor-connect":6670,"trezor-connect/lib/plugins/ethereum/typedData":6673},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){const{EventEmitter:s}=t("events"),n=t("ethereumjs-util"),i=t("hdkey"),a=t("trezor-connect").default,{TransactionFactory:o}=t("@ethereumjs/tx"),c=t("trezor-connect/lib/plugins/ethereum/typedData"),u="m/44'/60'/0'/0",h={[u]:!0,"m/44'/1'/0'/0":!0},l="Trezor Hardware",d=1e3,p={email:"support@metamask.io",appUrl:"https://metamask.io"};function m(t){return new Promise((e=>setTimeout(e,t)))}function f(t){return"function"==typeof t.getChainId}class g extends s{constructor(t={}){super(),this.type=l,this.accounts=[],this.hdk=new i,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},this.deserialize(t),a.on("DEVICE_EVENT",(t=>{t&&t.payload&&t.payload.features&&(this.model=t.payload.features.model)})),a.init({manifest:p})}getModel(){return this.model}dispose(){a.dispose()}serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts,page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}deserialize(t={}){return this.hdPath=t.hdPath||u,this.accounts=t.accounts||[],this.page=t.page||0,this.perPage=t.perPage||5,Promise.resolve()}isUnlocked(){return Boolean(this.hdk&&this.hdk.publicKey)}unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise(((t,e)=>{a.getPublicKey({path:this.hdPath,coin:"ETH"}).then((s=>{s.success?(this.hdk.publicKey=r.from(s.payload.publicKey,"hex"),this.hdk.chainCode=r.from(s.payload.chainCode,"hex"),t("just unlocked")):e(new Error(s.payload&&s.payload.error||"Unknown error"))})).catch((t=>{e(new Error(t&&t.toString()||"Unknown error"))}))}))}setAccountToUnlock(t){this.unlockedAccount=parseInt(t,10)}addAccounts(t=1){return new Promise(((e,r)=>{this.unlock().then((r=>{const s=this.unlockedAccount,n=s+t;for(let t=s;t<n;t++){const e=this._addressFromIndex("m",t);this.accounts.includes(e)||this.accounts.push(e),this.page=0}e(this.accounts)})).catch((t=>{r(t)}))}))}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}__getPage(t){return this.page+=t,this.page<=0&&(this.page=1),new Promise(((t,e)=>{this.unlock().then((e=>{const r=(this.page-1)*this.perPage,s=r+this.perPage,i=[];for(let t=r;t<s;t++){const e=this._addressFromIndex("m",t);i.push({address:e,balance:null,index:t}),this.paths[n.toChecksumAddress(e)]=t}t(i)})).catch((t=>{e(t)}))}))}getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(t){if(!this.accounts.map((t=>t.toLowerCase())).includes(t.toLowerCase()))throw new Error(`Address ${t} not found in this keyring`);this.accounts=this.accounts.filter((e=>e.toLowerCase()!==t.toLowerCase()))}signTransaction(t,e){return f(e)?this._signTransaction(t,e.getChainId(),e,(t=>(e.v=r.from(t.v,"hex"),e.r=r.from(t.r,"hex"),e.s=r.from(t.s,"hex"),e))):this._signTransaction(t,e.common.chainIdBN().toNumber(),e,(t=>{const r=e.toJSON();return r.type=e.type,r.v=n.addHexPrefix(t.v),r.r=n.addHexPrefix(t.r),r.s=n.addHexPrefix(t.s),o.fromTxData(r,{common:e.common,freeze:Object.isFrozen(e)})}))}async _signTransaction(t,e,r,s){let i;i=f(r)?{to:this._normalize(r.to),value:this._normalize(r.value),data:this._normalize(r.data),chainId:e,nonce:this._normalize(r.nonce),gasLimit:this._normalize(r.gasLimit),gasPrice:this._normalize(r.gasPrice)}:{...r.toJSON(),chainId:e,to:this._normalize(r.to)};try{const e=await this.unlock();await m("just unlocked"===e?d:0);const r=await a.ethereumSignTransaction({path:this._pathFromAddress(t),transaction:i});if(r.success){const e=s(r.payload),i=n.toChecksumAddress(n.addHexPrefix(e.getSenderAddress().toString("hex")));if(i!==n.toChecksumAddress(t))throw new Error("signature doesn't match the right address");return e}throw new Error(r.payload&&r.payload.error||"Unknown error")}catch(t){throw new Error(t&&t.toString()||"Unknown error")}}signMessage(t,e){return this.signPersonalMessage(t,e)}signPersonalMessage(t,e){return new Promise(((r,s)=>{this.unlock().then((i=>{setTimeout((i=>{a.ethereumSignMessage({path:this._pathFromAddress(t),message:n.stripHexPrefix(e),hex:!0}).then((e=>{if(e.success){e.payload.address!==n.toChecksumAddress(t)&&s(new Error("signature doesnt match the right address"));const i=`0x${e.payload.signature}`;r(i)}else s(new Error(e.payload&&e.payload.error||"Unknown error"))})).catch((t=>{s(new Error(t&&t.toString()||"Unknown error"))}))}),"just unlocked"===i?d:0)})).catch((t=>{s(new Error(t&&t.toString()||"Unknown error"))}))}))}async signTypedData(t,e,{version:r}){const s=c(e,"V4"===r),{types:{EIP712Domain:i=[],...o}={},message:u={},domain:h={},primaryType:l,domain_separator_hash:p,message_hash:f}=s,g=await this.unlock();await m("just unlocked"===g?d:0);const y=await a.ethereumSignTypedData({path:this._pathFromAddress(t),data:{types:{EIP712Domain:i,...o},message:u,domain:h,primaryType:l},metamask_v4_compat:!0,domain_separator_hash:p,message_hash:f});if(y.success){if(n.toChecksumAddress(t)!==y.payload.address)throw new Error("signature doesnt match the right address");return y.payload.signature}throw new Error(y.payload&&y.payload.error||"Unknown error")}exportAccount(){return Promise.reject(new Error("Not supported on this device"))}forgetDevice(){this.accounts=[],this.hdk=new i,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(t){if(!h[t])throw new Error(`The setHdPath method does not support setting HD Path to ${t}`);this.hdPath!==t&&(this.hdk=new i,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=t}_normalize(t){return n.bufferToHex(t).toString()}_addressFromIndex(t,e){const r=this.hdk.derive(`${t}/${e}`),s=n.publicToAddress(r.publicKey,!0).toString("hex");return n.toChecksumAddress(`0x${s}`)}_pathFromAddress(t){const e=n.toChecksumAddress(t);let r=this.paths[e];if(void 0===r)for(let t=0;t<1e3;t++)if(e===this._addressFromIndex("m",t)){r=t;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${r}`}}g.type=l,e.exports=g}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-trezor-keyring",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-trezor-keyring/index.js"}],[610,{"./metamask-airgapped-keyring.cjs.development.js":611,"./metamask-airgapped-keyring.cjs.production.min.js":612},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports=t("./metamask-airgapped-keyring.cjs.production.min.js")}}},{package:"@keystonehq/metamask-airgapped-keyring",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/@keystonehq/metamask-airgapped-keyring/dist/index.js"}],[35,{"../../../development/mock-3box":174,"../lib/createOriginMiddleware":50,"../lib/migrator":66,"../migrations":170,"./network/createMetamaskMiddleware":20,"3box":180,"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"@metamask/obs-store":1237,_process:6127,"eth-json-rpc-middleware":3080,"json-rpc-engine":5419,loglevel:5876},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(t("@babel/runtime/helpers/defineProperty")),i=t("@metamask/obs-store"),a=s(t("loglevel")),o=t("json-rpc-engine"),c=t("eth-json-rpc-middleware"),u=s(t("../lib/migrator")),h=s(t("../migrations")),l=s(t("../lib/createOriginMiddleware")),d=s(t("./network/createMetamaskMiddleware"));function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){(0,n.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}const f=e.env.IN_TEST?t("../../../development/mock-3box"):t("3box");r.default=class{constructor(t={}){const{preferencesController:e,keyringController:r,addressBookController:s,version:n,getKeyringControllerState:a,trackMetaMetricsEvent:o}=t;this.preferencesController=e,this.addressBookController=s,this.keyringController=r,this.provider=this._createProvider({version:n,getAccounts:async({origin:t})=>{if("3Box"!==t)return[];const{isUnlocked:e}=a(),r=await this.keyringController.getAccounts();if(e&&r[0]){return[await this.keyringController.getAppKeyAddress(r[0],"wallet://3box.metamask.io")]}return[]},processPersonalMessage:async t=>{const e=await this.keyringController.getAccounts();return r.signPersonalMessage(m(m({},t),{},{from:e[0]}),{withAppKeyOrigin:"wallet://3box.metamask.io"})}}),this._trackMetaMetricsEvent=o;const c=m(m({threeBoxSyncingAllowed:!1,showRestorePrompt:!0,threeBoxLastUpdated:0},t.initState),{},{threeBoxAddress:null,threeBoxSynced:!1,threeBoxDisabled:!1});this.store=new i.ObservableStore(c),this.registeringUpdates=!1,this.lastMigration=h.default.sort(((t,e)=>t.version-e.version)).slice(-1)[0],c.threeBoxSyncingAllowed&&this.init()}async init(){const t=await this.keyringController.getAccounts();this.address=t[0],this._trackMetaMetricsEvent({event:"3Box Initiated",category:"3Box"}),!this.address||this.box&&this.store.getState().threeBoxSynced||await this.new3Box()}async _update3Box(){try{const{threeBoxSyncingAllowed:t,threeBoxSynced:e}=this.store.getState();if(t&&e){const t={preferences:this.preferencesController.store.getState(),addressBook:this.addressBookController.state,lastUpdated:Date.now(),lastMigration:this.lastMigration};await this.space.private.set("metamaskBackup",JSON.stringify(t)),await this.setShowRestorePromptToFalse()}}catch(t){console.error(t)}}_createProvider(t){const e=(0,d.default)(t),r=new o.JsonRpcEngine;r.push((0,l.default)({origin:"3Box"})),r.push(e);return(0,c.providerFromEngine)(r)}_waitForOnSyncDone(){return new Promise((t=>{this.box.onSyncDone((()=>(a.default.debug("3Box box sync done"),t())))}))}async new3Box(){const t=await this.keyringController.getAccounts();let e;this.address=await this.keyringController.getAppKeyAddress(t[0],"wallet://3box.metamask.io");try{const t=await f.getConfig(this.address);e=t.spaces&&t.spaces.metamask}catch(t){if(!t.message.match(/^Error: Invalid response \(404\)/u))throw this._trackMetaMetricsEvent({event:"3Box Config Error",category:"3Box"}),t;this._trackMetaMetricsEvent({event:"3Box Backup does not exist",category:"3Box"}),e=!1}if(this.getThreeBoxSyncingState()||e){this.store.updateState({threeBoxSynced:!1});let t=!1;const e=setTimeout((()=>{a.default.error("3Box sync timed out after 60000 ms"),t=!0,this.store.updateState({threeBoxDisabled:!0,threeBoxSyncingAllowed:!1})}),6e4);try{this.box=await f.openBox(this.address,this.provider),await this._waitForOnSyncDone(),this.space=await this.box.openSpace("metamask",{onSyncDone:async()=>{const r={threeBoxSynced:!0,threeBoxAddress:this.address};t&&(a.default.info("3Box sync completed after timeout; no longer disabled"),r.threeBoxDisabled=!1),clearTimeout(e),this.store.updateState(r),a.default.debug("3Box space sync done"),this._trackMetaMetricsEvent({event:"3Box Synced",category:"3Box"})}})}catch(t){throw this._trackMetaMetricsEvent({event:"3Box Initiation Error",category:"3Box"}),console.error(t),t}}}async getLastUpdated(){const t=await this.space.private.get("metamaskBackup");return JSON.parse(t||"{}").lastUpdated}async migrateBackedUpState(t){const e=new u.default({migrations:h.default}),{preferences:r,addressBook:s}=JSON.parse(t),n={PreferencesController:r,AddressBookController:s},i=e.generateInitialState(n),a=await e.migrateData(i);return{preferences:a.data.PreferencesController,addressBook:a.data.AddressBookController}}async restoreFromThreeBox(){const t=await this.space.private.get("metamaskBackup"),{preferences:e,addressBook:r}=await this.migrateBackedUpState(t);this.store.updateState({threeBoxLastUpdated:t.lastUpdated}),e&&this.preferencesController.store.updateState(e),r&&this.addressBookController.update(r,!0),this.setShowRestorePromptToFalse(),this._trackMetaMetricsEvent({event:"3Box Restored Data",category:"3Box"})}turnThreeBoxSyncingOn(){this._trackMetaMetricsEvent({event:"3Box Sync Turned On",category:"3Box"}),this._registerUpdates()}turnThreeBoxSyncingOff(){this._trackMetaMetricsEvent({event:"3Box Sync Turned Off",category:"3Box"}),this.box.logout()}setShowRestorePromptToFalse(){this.store.updateState({showRestorePrompt:!1})}setThreeBoxSyncingPermission(t){this.store.getState().threeBoxDisabled||(this.store.updateState({threeBoxSyncingAllowed:t}),t&&this.box&&this.turnThreeBoxSyncingOn(),!t&&this.box&&this.turnThreeBoxSyncingOff())}getThreeBoxSyncingState(){return this.store.getState().threeBoxSyncingAllowed}_registerUpdates(){if(!this.registeringUpdates){const t=this._update3Box.bind(this);this.preferencesController.store.subscribe(t);const e=this._update3Box.bind(this);this.addressBookController.subscribe(e),this.registeringUpdates=!0}}}}).call(this)}).call(this,t("_process"))}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/threebox.js"}],[93,{"./createMethodMiddleware":70},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0});var s=t("./createMethodMiddleware");Object.keys(s).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in r&&r[t]===s[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return s[t]}}))}))}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/lib/rpc-method-middleware/index.js"}],[1239,{_process:6127,"readable-stream":6410,util:2485,xtend:6886},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){var s=t("readable-stream").Transform,n=t("util").inherits,i=t("xtend");function a(t){s.call(this,t),this._destroyed=!1}function o(t,e,r){r(null,t)}function c(t){return function(e,r,s){return"function"==typeof e&&(s=r,r=e,e={}),"function"!=typeof r&&(r=o),"function"!=typeof s&&(s=null),t(e,r,s)}}n(a,s),a.prototype.destroy=function(t){if(!this._destroyed){this._destroyed=!0;var e=this;r.nextTick((function(){t&&e.emit("error",t),e.emit("close")}))}},e.exports=c((function(t,e,r){var s=new a(t);return s._transform=e,r&&(s._flush=r),s})),e.exports.ctor=c((function(t,e,r){function s(e){if(!(this instanceof s))return new s(e);this.options=i(t,e),a.call(this,this.options)}return n(s,a),s.prototype._transform=e,r&&(s.prototype._flush=r),s})),e.exports.obj=c((function(t,e,r){var s=new a(i({objectMode:!0,highWaterMark:16},t));return s._transform=e,r&&(s._flush=r),s}))}).call(this)}).call(this,t("_process"))}}},{package:"through2",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/@metamask/obs-store/node_modules/through2/through2.js"}],[169,{"../../../shared/constants/transaction":6908,lodash:5866},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t,e,r){return function(i){const a=(0,s.cloneDeep)(i);a.meta.version=t;try{const t=function(t,e,r){const s=t,{TransactionController:i}=s;if(i&&i.transactions){const{transactions:t}=i;s.TransactionController.transactions=t.map((t=>e(t)?(t.status=n.TRANSACTION_STATUSES.FAILED,t.err={message:r,note:`Tx automatically failed by migration because ${r}`},t):t))}return s}(a.data,r,e);a.data=t}catch(e){console.warn(`MetaMask Migration #${t}${e.stack}`)}return Promise.resolve(a)}};var s=t("lodash"),n=t("../../../shared/constants/transaction")}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/migrations/fail-tx.js"}],[37,{"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"fast-json-patch":4969,lodash:5866},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.generateHistoryEntry=c,r.migrateFromSnapshotsToDiffs=function(t){return t.map(((e,r)=>0===r?e:c(t[r-1],e)))},r.replayHistory=function(t){return(0,a.cloneDeep)(t).reduce(((t,e)=>i.default.applyPatch(t,e).newDocument))},r.snapshotFromTxMeta=function(t){const e=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){(0,n.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t);return delete e.history,(0,a.cloneDeep)(e)};var n=s(t("@babel/runtime/helpers/defineProperty")),i=s(t("fast-json-patch")),a=t("lodash");function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function c(t,e,r){const s=i.default.compare(t,e);return s[0]&&(r&&(s[0].note=r),s[0].timestamp=Date.now()),s}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/transactions/lib/tx-state-history-helpers.js"}],[6653,{},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports=function(t){if(t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray)return new DataView(t.buffer,t.byteOffset,t.byteLength);if(t instanceof ArrayBuffer)return new DataView(t);throw new TypeError("Expected `data` to be an ArrayBuffer, Buffer, Int8Array, Uint8Array or Uint8ClampedArray")}}}},{package:"to-data-view",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/to-data-view/index.js"}],[57,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=[{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes32"}],name:"setContent",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"content",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"},{name:"value",type:"string"}],name:"setText",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"setPubkey",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setContenthash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"addr",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"key",type:"string"}],name:"text",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],name:"setABI",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"contenthash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"pubkey",outputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"addr",type:"address"}],name:"setAddr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[{name:"ensAddr",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"contentType",type:"uint256"}],name:"ABIChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"x",type:"bytes32"},{indexed:!1,name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"indexedKey",type:"string"},{indexed:!1,name:"key",type:"string"}],name:"TextChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"}];r.default=s}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/lib/ens-ipfs/contracts/resolver.js"}],[56,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=[{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"resolver",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"label",type:"bytes32"},{name:"owner",type:"address"}],name:"setSubnodeOwner",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"ttl",type:"uint64"}],name:"setTTL",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"ttl",outputs:[{name:"",type:"uint64"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"resolver",type:"address"}],name:"setResolver",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"owner",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"ttl",type:"uint64"}],name:"NewTTL",type:"event"}];r.default=s}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/lib/ens-ipfs/contracts/registry.js"}],[302,{"./helpers":301,"./profiles":303,multicodec:287,multihashes:293},function(){with(this)return function(){"use strict";return function(t,e,r){const s=t("multicodec"),n=t("multihashes"),{hexStringToBuffer:i,profiles:a}=t("./profiles"),{cidForWeb:o,cidV0ToV1Base32:c}=t("./helpers");e.exports={helpers:{cidForWeb:o,cidV0ToV1Base32:c},decode:function(t){const e=i(t),r=s.getCodec(e),n=s.rmPrefix(e);let o=a[r];return o||(o=a.default),o.decode(n)},fromIpfs:function(t){return this.encode("ipfs-ns",t)},fromSkylink:function(t){return this.encode("skynet-ns",t)},fromSwarm:function(t){return this.encode("swarm-ns",t)},encode:function(t,e){let r=a[t];r||(r=a.default);const i=r.encode(e);return n.toHexString(s.addPrefix(t,i))},getCodec:function(t){let e=i(t);return s.getCodec(e)}}}}},{package:"@ensdomains/content-hash",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/@ensdomains/content-hash/src/index.js"}],[4,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN=r.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY=r.SINGLE_CALL_BALANCES_ADDRESS_KOVAN=r.SINGLE_CALL_BALANCES_ADDRESS=void 0;r.SINGLE_CALL_BALANCES_ADDRESS="0xb1f8e55c7f64d203c1400b9d8555d050f94adf39";r.SINGLE_CALL_BALANCES_ADDRESS_RINKEBY="0x9f510b19f1ad66f0dcf6e45559fab0d6752c1db7";r.SINGLE_CALL_BALANCES_ADDRESS_ROPSTEN="0xb8e671734ce5c8d7dfbbea5574fa4cf39f7a54a4";r.SINGLE_CALL_BALANCES_ADDRESS_KOVAN="0xb1d3fbb2f83aecd196f474c16ca5d9cffa0d0ffc"}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/constants/contracts.js"}],[2065,{"./package.json":2069,"@segment/loosely-validate-event":1856,_process:6127,assert:2088,axios:2172,"axios-retry":2170,"lodash.isstring":5693,md5:5886,ms:5899,"remove-trailing-slash":6439,"uuid/v4":2068},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){const s=t("assert"),n=t("remove-trailing-slash"),i=t("@segment/loosely-validate-event"),a=t("axios"),o=t("axios-retry"),c=t("ms"),u=t("uuid/v4"),h=t("md5"),l=t("./package.json").version,d=t("lodash.isstring"),p=global.setImmediate||r.nextTick.bind(r),m=()=>{};e.exports=class{constructor(t,e){e=e||{},s(t,"You must pass your Segment project's write key."),this.queue=[],this.writeKey=t,this.host=n(e.host||"https://api.segment.io"),this.timeout=e.timeout||!1,this.flushAt=Math.max(e.flushAt,1)||20,this.flushInterval=e.flushInterval||1e4,this.flushed=!1,Object.defineProperty(this,"enable",{configurable:!1,writable:!1,enumerable:!0,value:"boolean"!=typeof e.enable||e.enable}),this.axiosClient=a.create(),o(this.axiosClient,{retries:e.retryCount||3,retryCondition:this._isErrorRetryable,retryDelay:o.exponentialDelay})}_validate(t,e){try{i(t,e)}catch(e){if("Your message must be < 32kb."===e.message)return void console.log("Your message must be < 32kb. This is currently surfaced as a warning to allow clients to update. Versions released after August 1, 2018 will throw an error instead. Please update your code before then.",t);throw e}}identify(t,e){return this._validate(t,"identify"),this.enqueue("identify",t,e),this}group(t,e){return this._validate(t,"group"),this.enqueue("group",t,e),this}track(t,e){return this._validate(t,"track"),this.enqueue("track",t,e),this}page(t,e){return this._validate(t,"page"),this.enqueue("page",t,e),this}screen(t,e){return this._validate(t,"screen"),this.enqueue("screen",t,e),this}alias(t,e){return this._validate(t,"alias"),this.enqueue("alias",t,e),this}enqueue(t,e,s){return s=s||m,this.enable?((e=Object.assign({},e)).type=t,e.context=Object.assign({library:{name:"analytics-node",version:l}},e.context),e._metadata=Object.assign({nodeVersion:r.versions.node},e._metadata),e.timestamp||(e.timestamp=new Date),e.messageId||(e.messageId=`node-${h(JSON.stringify(e))}-${u()}`),e.anonymousId&&!d(e.anonymousId)&&(e.anonymousId=JSON.stringify(e.anonymousId)),e.userId&&!d(e.userId)&&(e.userId=JSON.stringify(e.userId)),this.queue.push({message:e,callback:s}),this.flushed?(this.queue.length>=this.flushAt&&this.flush(),void(this.flushInterval&&!this.timer&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval)))):(this.flushed=!0,void this.flush())):p(s)}flush(t){if(t=t||m,!this.enable)return p(t);if(this.timer&&(clearTimeout(this.timer),this.timer=null),!this.queue.length)return p(t);const e=this.queue.splice(0,this.flushAt),r=e.map((t=>t.callback)),s={batch:e.map((t=>t.message)),timestamp:new Date,sentAt:new Date},n=e=>{r.forEach((t=>t(e))),t(e,s)},i={};"undefined"==typeof window&&(i["user-agent"]=`analytics-node/${l}`);const a={method:"POST",url:`${this.host}/v1/batch`,auth:{username:this.writeKey},data:s,headers:i};this.timeout&&(a.timeout="string"==typeof this.timeout?c(this.timeout):this.timeout),this.axiosClient(a).then((()=>n())).catch((t=>{if(t.response){const e=new Error(t.response.statusText);return n(e)}n(t)}))}_isErrorRetryable(t){return!!o.isNetworkError(t)||!!t.response&&(t.response.status>=500&&t.response.status<=599||429===t.response.status)}}}).call(this)}).call(this,t("_process"))}}},{package:"analytics-node",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/analytics-node/index.js"}],[10,{"@babel/runtime/helpers/interopRequireDefault":213,"ethereum-ens-network-map":3174,"ethjs-ens":3231},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(t("ethjs-ens")),i=s(t("ethereum-ens-network-map"));r.default=class{static getNetworkEnsSupport(t){return Boolean(i.default[t])}constructor({network:t,provider:e}={}){this._ethJsEns=new n.default({network:t,provider:e})}lookup(t){return this._ethJsEns.lookup(t)}reverse(t){return this._ethJsEns.reverse(t)}}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/ens/ens.js"}],[28,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WALLET_PREFIX=r.NOTIFICATION_NAMES=r.LOG_METHOD_TYPES=r.LOG_LIMIT=r.LOG_IGNORE_METHODS=void 0;r.WALLET_PREFIX="wallet_";r.NOTIFICATION_NAMES={accountsChanged:"metamask_accountsChanged",unlockStateChanged:"metamask_unlockStateChanged",chainChanged:"metamask_chainChanged"};r.LOG_IGNORE_METHODS=["wallet_registerOnboarding","wallet_watchAsset"];r.LOG_METHOD_TYPES={restricted:"restricted",internal:"internal"};r.LOG_LIMIT=100}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/permissions/enums.js"}],[31,{"../../../../shared/constants/permissions":6905,reselect:6440},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getPermittedAccountsByOrigin=r.getChangedAccounts=void 0;var s=t("reselect"),n=t("../../../../shared/constants/permissions");const i=(0,s.createSelector)((t=>t.subjects),(t=>Object.values(t).reduce(((t,e)=>{var r,s;const i=null===(r=e.permissions)||void 0===r||null===(s=r.eth_accounts)||void 0===s?void 0:s.caveats.find((({type:t})=>t===n.CaveatTypes.restrictReturnedAccounts));return i&&t.set(e.origin,i.value),t}),new Map)));r.getPermittedAccountsByOrigin=i;r.getChangedAccounts=(t,e)=>{if(e===undefined)return t;const r=new Map;if(t===e)return r;const s=new Set([...t.keys()]);for(const i of e.keys()){var n;const a=null!==(n=t.get(i))&&void 0!==n?n:[];e.get(i)!==a&&r.set(i,a),s.delete(i)}for(const e of s.keys())r.set(e,t.get(e));return r}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/permissions/selectors.js"}],[27,{"../../../../shared/constants/permissions":6905,"@metamask/controllers":1080},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CaveatMutatorFactories=void 0;var s=t("@metamask/controllers");const n={[t("../../../../shared/constants/permissions").CaveatTypes.restrictReturnedAccounts]:{removeAccount:function(t,e){const r=e.filter((e=>e!==t));if(r.length===e.length)return{operation:s.CaveatMutatorOperation.noop};if(r.length>0)return{operation:s.CaveatMutatorOperation.updateValue,value:r};return{operation:s.CaveatMutatorOperation.revokePermission}}}};r.CaveatMutatorFactories=n}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/permissions/caveat-mutators.js"}],[26,{"../../../../shared/constants/permissions":6905,"@babel/runtime/helpers/interopRequireDefault":213,nanoid:5952},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.getPermissionBackgroundApiMethods=function(t){return{addPermittedAccount:(e,r)=>{const s=t.getCaveat(e,i.RestrictedMethods.eth_accounts,i.CaveatTypes.restrictReturnedAccounts);if(s.value.includes(r))throw new Error(`eth_accounts permission for origin "${e}" already permits account "${r}".`);t.updateCaveat(e,i.RestrictedMethods.eth_accounts,i.CaveatTypes.restrictReturnedAccounts,[...s.value,r])},removePermittedAccount:(e,r)=>{const s=t.getCaveat(e,i.RestrictedMethods.eth_accounts,i.CaveatTypes.restrictReturnedAccounts);if(!s.value.includes(r))throw new Error(`eth_accounts permission for origin "${e}" already does not permit account "${r}".`);const n=s.value.filter((t=>t!==r));0===n.length?t.revokePermission(e,i.RestrictedMethods.eth_accounts):t.updateCaveat(e,i.RestrictedMethods.eth_accounts,i.CaveatTypes.restrictReturnedAccounts,n)},requestAccountsPermissionWithId:async e=>{const r=(0,n.default)();return t.requestPermissions({origin:e},{eth_accounts:{}},{id:r}),r}}};var n=s(t("nanoid")),i=t("../../../../shared/constants/permissions")}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/permissions/background-api.js"}],[32,{"../../../../shared/constants/permissions":6905,"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"@metamask/controllers":1080},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.unrestrictedMethods=r.getPermissionSpecifications=r.getCaveatSpecifications=void 0;var n=s(t("@babel/runtime/helpers/defineProperty")),i=t("@metamask/controllers"),a=t("../../../../shared/constants/permissions");function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){(0,n.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}const u=Object.freeze(c({},a.RestrictedMethods)),h=Object.freeze({[a.CaveatTypes.restrictReturnedAccounts]:t=>({type:a.CaveatTypes.restrictReturnedAccounts,value:t})});r.getCaveatSpecifications=({getIdentities:t})=>({[a.CaveatTypes.restrictReturnedAccounts]:{type:a.CaveatTypes.restrictReturnedAccounts,decorator:(t,e)=>async r=>(await t(r)).filter((t=>e.value.includes(t))).slice(0,1),validator:(e,r,s)=>function(t,e){if(!Array.isArray(t)||0===t.length)throw new Error(`${u.eth_accounts} error: Expected non-empty array of Ethereum addresses.`);const r=e();t.forEach((t=>{if(!t||"string"!=typeof t)throw new Error(`${u.eth_accounts} error: Expected an array of Ethereum addresses. Received: "${t}".`);if(!r[t])throw new Error(`${u.eth_accounts} error: Received unrecognized address: "${t}".`)}))}(e.value,t)}});r.getPermissionSpecifications=({getAllAccounts:t,getIdentities:e,captureKeyringTypesWithMissingIdentities:r})=>({[u.eth_accounts]:{permissionType:i.PermissionType.RestrictedMethod,targetKey:u.eth_accounts,allowedCaveats:[a.CaveatTypes.restrictReturnedAccounts],factory:(t,e)=>{if(Array.isArray(t.caveats))throw new Error(`${u.eth_accounts} error: Received unexpected caveats. Any permitted caveats will be added automatically.`);if(!e.approvedAccounts)throw new Error(`${u.eth_accounts} error: No approved accounts specified.`);return(0,i.constructPermission)(c(c({},t),{},{caveats:[h[a.CaveatTypes.restrictReturnedAccounts](e.approvedAccounts)]}))},methodImplementation:async s=>{const n=await t(),i=e();return n.sort(((t,e)=>{if(!i[t])throw r(i,n),new Error(`Missing identity for address: "${t}".`);if(!i[e])throw r(i,n),new Error(`Missing identity for address: "${e}".`);return i[t].lastSelected===i[e].lastSelected?0:i[t].lastSelected===undefined?1:i[e].lastSelected===undefined?-1:i[e].lastSelected-i[t].lastSelected}))},validator:(t,e,r)=>{const{caveats:s}=t;if(!s||1!==s.length||s[0].type!==a.CaveatTypes.restrictReturnedAccounts)throw new Error(`${u.eth_accounts} error: Invalid caveats. There must be a single caveat of type "${a.CaveatTypes.restrictReturnedAccounts}".`)}}});const l=Object.freeze(["eth_blockNumber","eth_call","eth_chainId","eth_coinbase","eth_decrypt","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getEncryptionPublicKey","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getWork","eth_hashrate","eth_mining","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_protocolVersion","eth_sendRawTransaction","eth_sendTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","eth_submitHashrate","eth_submitWork","eth_syncing","eth_uninstallFilter","metamask_getProviderState","metamask_watchAsset","net_listening","net_peerCount","net_version","personal_ecRecover","personal_sign","wallet_watchAsset","web3_clientVersion","web3_sha3","mises_requestAccounts","mises_setUserInfo","mises_userFollow","mises_userUnFollow","mises_getMisesAccount","mises_openRestore","mises_connect","mises_disconnect","mises_getAddressToMisesId","mises_getCollectibles","mises_openNFTPage","mises_stakingPostTx"]);r.unrestrictedMethods=l}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/permissions/specifications.js"}],[30,{"../../../../shared/constants/permissions":6905,"./enums":28,"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"@metamask/obs-store":1237,"fast-safe-stringify":4973},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionLogController=void 0;var n=s(t("@babel/runtime/helpers/defineProperty")),i=t("@metamask/obs-store"),a=s(t("fast-safe-stringify")),o=t("../../../../shared/constants/permissions"),c=t("./enums");function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){(0,n.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e){return(Array.isArray(t)?t:t.accounts).reduce(((t,r)=>h(h({},t),{},{[r]:e})),{})}r.PermissionLogController=class{constructor({restrictedMethods:t,initState:e}){this.restrictedMethods=t,this.store=new i.ObservableStore(h({permissionHistory:{},permissionActivityLog:[]},e))}getActivityLog(){return this.store.getState().permissionActivityLog}updateActivityLog(t){this.store.updateState({permissionActivityLog:t})}getHistory(){return this.store.getState().permissionHistory}updateHistory(t){this.store.updateState({permissionHistory:t})}updateAccountsHistory(t,e){if(0===e.length)return;const r=l(e,Date.now());this.commitNewHistory(t,{eth_accounts:{accounts:r}})}createMiddleware(){return(t,e,r,s)=>{let n,i;const{origin:a,method:o}=t,u=o.startsWith(c.WALLET_PREFIX);if(c.LOG_IGNORE_METHODS.includes(o)||!u&&!this.restrictedMethods.has(o)){if(!["eth_requestAccounts","mises_requestAccounts"].includes(o))return void r();n=this.logRequest(t,u),i=["eth_accounts"]}else n=this.logRequest(t,u),o===`${c.WALLET_PREFIX}requestPermissions`&&(i=this.getRequestedMethods(t));r((t=>{const r=Date.now();this.logResponse(n,e,r),i&&!e.error&&e.result&&this.logPermissionsHistory(i,a,e.result,r,["eth_requestAccounts","mises_requestAccounts"].includes(o)),t()}))}}logRequest(t,e){const r={id:t.id,method:t.method,methodType:e?c.LOG_METHOD_TYPES.internal:c.LOG_METHOD_TYPES.restricted,origin:t.origin,request:(0,a.default)(t,null,2),requestTime:Date.now(),response:null,responseTime:null,success:null};return this.commitNewActivity(r),r}logResponse(t,e,r){t&&e&&(t.response=(0,a.default)(e,null,2),t.responseTime=r,t.success=!e.error)}commitNewActivity(t){const e=this.getActivityLog();e.push(t),e.length>c.LOG_LIMIT&&e.shift(),this.updateActivityLog(e)}logPermissionsHistory(t,e,r,s,n){let i,a;if(n){i=r;a={eth_accounts:{accounts:l(i,s),lastApproved:s}}}else a=r.map((t=>("eth_accounts"===t.parentCapability&&(i=this.getAccountsFromPermission(t)),t.parentCapability))).reduce(((e,r)=>{if(t.includes(r))if("eth_accounts"===r){const t=l(i,s);e[r]={lastApproved:s,accounts:t}}else e[r]={lastApproved:s};return e}),{});Object.keys(a).length>0&&this.commitNewHistory(e,a)}commitNewHistory(t,e){const r=this.getHistory(),s=h(h({},r[t]),e),n=r[t]&&r[t].eth_accounts,i=e.eth_accounts;if(n&&i){const t=i.lastApproved||n.lastApproved;s.eth_accounts={lastApproved:t,accounts:h(h({},n.accounts),i.accounts)}}r[t]=s,this.updateHistory(r)}getRequestedMethods(t){return t.params&&t.params[0]&&"object"==typeof t.params[0]&&!Array.isArray(t.params[0])?Object.keys(t.params[0]):null}getAccountsFromPermission(t){if("eth_accounts"!==t.parentCapability||!t.caveats)return[];const e=new Set;for(const r of t.caveats)if(r.type===o.CaveatTypes.restrictReturnedAccounts&&Array.isArray(r.value))for(const t of r.value)e.add(t);return[...e]}}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/permissions/permission-log.js"}],[16,{"../../../../shared/constants/network":6904,"../../../../ui/helpers/utils/fetch":7461,"../../../../ui/misesPages/accountSet/misesNetwork.util":7517,"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"@metamask/controllers":1080},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(t("@babel/runtime/helpers/defineProperty")),i=t("@metamask/controllers"),a=t("../../../../shared/constants/network"),o=t("../../../../ui/helpers/utils/fetch"),c=t("../../../../ui/misesPages/accountSet/misesNetwork.util");function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){(0,n.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}class l extends i.CollectiblesController{constructor(t,e,r){super(t,e,r),this.getMisesAccount=t.getMisesAccount}getNetwork(){const{chainId:t}=this.config;return t===a.MAINNET_CHAIN_ID?"main":t===a.RINKEBY_CHAIN_ID?"test":"unknown"}getCollectibleApi(t,e){return`${(0,c.getBaseApi)("single_asset")}?asset_contract_address=${t}&token_id=${e}&network=${this.getNetwork()}`}getCollectibleContractInformationApi(t){return`${(0,c.getBaseApi)("assets_contract")}?asset_contract_address=${t}&network=${this.getNetwork()}`}async isCollectibleOwner(t,e,r){try{const s=await this.getERC721OwnerOf(e,r);if("0x"!==s.toLowerCase())return t.toLowerCase()===s.toLowerCase()}catch(t){console.log(t,"isCollectibleOwner")}try{return await this.getERC1155BalanceOf(t,e,r)>0}catch(t){}throw new Error("Unable to verify ownership. Probably because the standard is not supported or the chain is incorrect.")}async getCollectibleInformationFromApi(t,e){try{const r=this.getCollectibleApi(t,e),{token:s}=this.getMisesAccount(t),n=await(0,o.request)({url:r,method:"GET",headers:{Authorization:`Bearer ${s}`},isCustom:!0}),{num_sales:i,background_color:a,image_url:c,image_preview_url:u,image_thumbnail_url:l,image_original_url:d,animation_url:p,animation_original_url:m,name:f,description:g,external_link:y,creator:w,last_sale:v,asset_contract:{schema_name:b}}=n;return h(h(h(h(h(h(h(h(h(h(h({name:f||null,description:g||null,image:c||null},w&&{creator:w}),i&&{numberOfSales:i}),a&&{backgroundColor:a}),u&&{imagePreview:u}),l&&{imageThumbnail:l}),d&&{imageOriginal:d}),p&&{animation:p}),m&&{animationOriginal:m}),y&&{externalLink:y}),v&&{lastSale:v}),b&&{standard:b})}catch(t){return t}}getCollectibleContractInformationFromApi(t){const e=this.getCollectibleContractInformationApi(t),{token:r}=this.getMisesAccount(t);return(0,o.request)({url:e,method:"GET",headers:{Authorization:`Bearer ${r}`},isCustom:!0})}}r.default=l}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/misesCollectibles/CollectiblesController.js"}],[15,{"../../../../shared/constants/network":6904,"../../../../ui/helpers/utils/fetch":7461,"../../../../ui/misesPages/accountSet/misesNetwork.util":7517,"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"@metamask/controllers":1080},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(t("@babel/runtime/helpers/defineProperty")),i=t("@metamask/controllers"),a=t("../../../../ui/misesPages/accountSet/misesNetwork.util"),o=t("../../../../ui/helpers/utils/fetch"),c=t("../../../../shared/constants/network");class u extends i.CollectibleDetectionController{constructor(t,e,r){super(t,e,r),(0,n.default)(this,"offset",""),(0,n.default)(this,"requestLock",!1),this.isMainnet=()=>![c.MISES_CHAIN_ID].includes(this.config.chainId),t.onNetworkStateChange((async({provider:e})=>{if(![c.MISES_CHAIN_ID].includes(e.chainId)&&t.isUnlocked()&&!this.requestLock){this.requestLock=!0;try{await this.startPolling()}finally{setTimeout((()=>{this.requestLock=!1}),100)}}})),this.getNetwork=t.getNetwork,this.getMisesAccount=t.getMisesAccount}getOwnerCollectiblesApi(t,e){return`${(0,a.getBaseApi)("assets")}?owner=${t}&cursor=${e}&limit=50&network=${this.getNetwork()}`}startPolling(){this.detectCollectibles()}async getOwnerCollectibles(t){const{token:e}=this.getMisesAccount(t);if(!e)return Promise.resolve([]);try{const r=this.getOwnerCollectiblesApi(t,this.offset),{assets:s,next:n}=await(0,o.request)({url:r,method:"GET",headers:{Authorization:`Bearer ${e}`},isCustom:!0});return this.offset=n||"",s}catch(t){return[]}}}r.default=u}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/misesCollectibles/CollectibleDetectionController.js"}],[46,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){let{name:e}=t;e=e===undefined?"Error":String(e);let r=t.message;r=r===undefined?"":String(r),""===e?t.stack=t.message:""===r?t.stack=t.name:t.stack||(t.stack=`${t.name}: ${t.message}`);return t}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/lib/cleanErrorStack.js"}],[5992,{assert:2088,"await-semaphore":2169,"ethjs-query":3244},function(){with(this)return function(){"use strict";return function(t,e,r){const s=t("ethjs-query"),n=t("assert"),i=t("await-semaphore").Mutex;e.exports=class{constructor({provider:t,blockTracker:e,getPendingTransactions:r,getConfirmedTransactions:n}){this.provider=t,this.blockTracker=e,this.ethQuery=new s(t),this.getPendingTransactions=r,this.getConfirmedTransactions=n,this.lockMap={}}async getGlobalLock(){const t=this._lookupMutex("global");return{releaseLock:await t.acquire()}}async getNonceLock(t){await this._globalMutexFree();const e=await this._takeMutex(t);try{const r={},s=await this._getNetworkNextNonce(t),i=this._getHighestLocallyConfirmed(t),a=s.nonce,o=Math.max(a,i),c=this.getPendingTransactions(t),u=this._getHighestContinuousFrom(c,o)||0;r.params={highestLocallyConfirmed:i,highestSuggested:o,nextNetworkNonce:a},r.local=u,r.network=s;const h=Math.max(s.nonce,u.nonce);return n(Number.isInteger(h),`nonce-tracker - nextNonce is not an integer - got: (${typeof h}) "${h}"`),{nextNonce:h,nonceDetails:r,releaseLock:e}}catch(t){throw e(),t}}async _globalMutexFree(){const t=this._lookupMutex("global");(await t.acquire())()}async _takeMutex(t){const e=this._lookupMutex(t);return await e.acquire()}_lookupMutex(t){let e=this.lockMap[t];return e||(e=new i,this.lockMap[t]=e),e}async _getNetworkNextNonce(t){const e=await this.blockTracker.getLatestBlock(),r=(await this.ethQuery.getTransactionCount(t,e)).toNumber();n(Number.isInteger(r),`nonce-tracker - baseCount is not an integer - got: (${typeof r}) "${r}"`);return{name:"network",nonce:r,details:{blockNumber:e,baseCount:r}}}_getHighestLocallyConfirmed(t){const e=this.getConfirmedTransactions(t),r=this._getHighestNonce(e);return Number.isInteger(r)?r+1:0}_getHighestNonce(t){const e=t.map((t=>{const e=t.txParams.nonce;return n(typeof e,"string","nonces should be hex strings"),parseInt(e,16)}));return Math.max.apply(null,e)}_getHighestContinuousFrom(t,e){const r=t.map((t=>{const e=t.txParams.nonce;return n(typeof e,"string","nonces should be hex strings"),parseInt(e,16)}));let s=e;for(;r.includes(s);)s++;return{name:"local",nonce:s,details:{startPoint:e,highest:s}}}}}}},{package:"nonce-tracker",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/nonce-tracker/index.js"}],[38,{"../../../../../shared/constants/transaction":6908,"../../../../../shared/modules/hexstring-utils":6914,"../../../../../shared/modules/transaction.utils":6920,"../../../lib/util":99,"eth-rpc-errors":3129},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getFinalStates=function(){return[i.TRANSACTION_STATUSES.REJECTED,i.TRANSACTION_STATUSES.CONFIRMED,i.TRANSACTION_STATUSES.FAILED,i.TRANSACTION_STATUSES.DROPPED]},r.normalizeAndValidateTxParams=function(t,e=!0){const r=u(t,e);return p(r),r},r.normalizeTxParams=u,r.normalizeTxReceiptGasUsed=function(t){return"string"==typeof t?t:t.toString(16)},r.validateConfirmedExternalTransaction=void 0,r.validateFrom=m,r.validateRecipient=f,r.validateTxParams=p;var s=t("eth-rpc-errors"),n=t("../../../lib/util"),i=t("../../../../../shared/constants/transaction"),a=t("../../../../../shared/modules/transaction.utils"),o=t("../../../../../shared/modules/hexstring-utils");const c={from:n.addHexPrefix,to:(t,e)=>e?(0,n.addHexPrefix)(t).toLowerCase():(0,n.addHexPrefix)(t),nonce:n.addHexPrefix,value:n.addHexPrefix,data:n.addHexPrefix,gas:n.addHexPrefix,gasPrice:n.addHexPrefix,maxFeePerGas:n.addHexPrefix,maxPriorityFeePerGas:n.addHexPrefix,type:n.addHexPrefix,estimateSuggested:t=>t,estimateUsed:t=>t};function u(t,e=!0){const r={};for(const s in c)t[s]&&(r[s]=c[s](t[s],e));return r}function h(t,e,r){if(void 0!==t[r])throw s.ethErrors.rpc.invalidParams(`Invalid transaction params: specified ${e} but also included ${r}, these cannot be mixed`)}function l(t,e){if("string"!=typeof t[e])throw s.ethErrors.rpc.invalidParams(`Invalid transaction params: ${e} is not a string. got: (${t[e]})`)}function d(t,e){switch(e){case"maxFeePerGas":case"maxPriorityFeePerGas":if(t.type&&t.type!==i.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw s.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${t.type}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "${i.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET}"`);break;default:if(t.type&&t.type===i.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw s.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${t.type}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function p(t,e=!0){if(!t||"object"!=typeof t||Array.isArray(t))throw s.ethErrors.rpc.invalidParams("Invalid transaction params: must be an object.");if(!t.to&&!t.data)throw s.ethErrors.rpc.invalidParams('Invalid transaction params: must specify "data" for contract deployments, or "to" (and optionally "data") for all other types of transactions.');if((0,a.isEIP1559Transaction)({txParams:t})&&!e)throw s.ethErrors.rpc.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559");Object.entries(t).forEach((([e,r])=>{switch(e){case"from":m(t);break;case"to":f(t);break;case"gasPrice":d(t,"gasPrice"),h(t,"gasPrice","maxFeePerGas"),h(t,"gasPrice","maxPriorityFeePerGas"),l(t,"gasPrice");break;case"maxFeePerGas":d(t,"maxFeePerGas"),h(t,"maxFeePerGas","gasPrice"),l(t,"maxFeePerGas");break;case"maxPriorityFeePerGas":d(t,"maxPriorityFeePerGas"),h(t,"maxPriorityFeePerGas","gasPrice"),l(t,"maxPriorityFeePerGas");break;case"value":if(l(t,"value"),r.toString().includes("-"))throw s.ethErrors.rpc.invalidParams(`Invalid transaction value "${r}": not a positive number.`);if(r.toString().includes("."))throw s.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": number must be in wei.`);if(!r.match(/^0x[a-fA-F0-9]+$/u))throw s.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": not a valid hex string.`);break;case"chainId":if("number"!=typeof r&&"string"!=typeof r)throw s.ethErrors.rpc.invalidParams(`Invalid transaction params: ${e} is not a Number or hex string. got: (${r})`);break;default:l(t,e)}}))}function m(t){if("string"!=typeof t.from)throw s.ethErrors.rpc.invalidParams(`Invalid "from" address "${t.from}": not a string.`);if(!(0,o.isValidHexAddress)(t.from,{allowNonPrefixed:!1}))throw s.ethErrors.rpc.invalidParams('Invalid "from" address.')}function f(t){if("0x"===t.to||null===t.to){if(!t.data)throw s.ethErrors.rpc.invalidParams('Invalid "to" address.');delete t.to}else if(t.to!==undefined&&!(0,o.isValidHexAddress)(t.to,{allowNonPrefixed:!1}))throw s.ethErrors.rpc.invalidParams('Invalid "to" address.');return t}r.validateConfirmedExternalTransaction=({txMeta:t,pendingTransactions:e,confirmedTransactions:r}={})=>{if(!t||!t.txParams)throw s.ethErrors.rpc.invalidParams('"txMeta" or "txMeta.txParams" is missing');if(t.status!==i.TRANSACTION_STATUSES.CONFIRMED)throw s.ethErrors.rpc.invalidParams('External transaction status should be "confirmed"');const n=t.txParams.nonce;if(e&&e.length>0){if(e.find((t=>{var e;return(null===(e=t.txParams)||void 0===e?void 0:e.nonce)===n})))throw s.ethErrors.rpc.invalidParams("External transaction nonce should not be in pending txs")}if(r&&r.length>0){if(r.find((t=>{var e;return(null===(e=t.txParams)||void 0===e?void 0:e.nonce)===n})))throw s.ethErrors.rpc.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/transactions/lib/util.js"}],[40,{"../../lib/util":99,"@babel/runtime/helpers/interopRequireDefault":213,"ethereumjs-util":3195,"ethjs-query":3244,lodash:5866,loglevel:5876},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(t("ethjs-query")),i=s(t("loglevel")),a=t("ethereumjs-util"),o=t("lodash"),c=t("../../lib/util");r.default=class{constructor(t){this.query=new n.default(t)}async analyzeGasUsage(t){const e=await this.query.getBlockByNumber("latest",!1),r=(0,c.hexToBn)(e.gasLimit),s=(0,c.BnMultiplyByFraction)(r,19,20);let n,a=(0,c.bnToHex)(s);try{a=await this.estimateTxGas(t)}catch(t){i.default.warn(t),n={reason:t.message,errorKey:t.errorKey,debug:{blockNumber:e.number,blockGasLimit:e.gasLimit}}}return{blockGasLimit:e.gasLimit,estimatedGasHex:a,simulationFails:n}}async estimateTxGas(t){const e=(0,o.cloneDeep)(t.txParams);return delete e.gasPrice,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas,await this.query.estimateGas(e)}addGasBuffer(t,e,r=1.5){const s=(0,c.hexToBn)(t),n=(0,c.hexToBn)(e).muln(.9),i=s.muln(r);return s.gt(n)?(0,c.bnToHex)(s):i.lt(n)?(0,c.bnToHex)(i):(0,c.bnToHex)(n)}async getBufferedGasLimit(t,e){const{blockGasLimit:r,estimatedGasHex:s,simulationFails:n}=await this.analyzeGasUsage(t);return{gasLimit:this.addGasBuffer((0,a.addHexPrefix)(s),r,e),simulationFails:n}}}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/transactions/tx-gas-utils.js"}],[39,{"../../../../shared/constants/transaction":6908,"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"ethjs-query":3244,loglevel:5876,"safe-event-emitter":6451},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(t("@babel/runtime/helpers/defineProperty")),i=s(t("safe-event-emitter")),a=s(t("loglevel")),o=s(t("ethjs-query")),c=t("../../../../shared/constants/transaction");class u extends i.default{constructor(t){super(),(0,n.default)(this,"DROPPED_BUFFER_COUNT",3),(0,n.default)(this,"droppedBlocksBufferByHash",new Map),this.query=t.query||new o.default(t.provider),this.nonceTracker=t.nonceTracker,this.getPendingTransactions=t.getPendingTransactions,this.getCompletedTransactions=t.getCompletedTransactions,this.publishTransaction=t.publishTransaction,this.approveTransaction=t.approveTransaction,this.confirmTransaction=t.confirmTransaction}async updatePendingTxs(){const t=await this.nonceTracker.getGlobalLock();try{const t=this.getPendingTransactions();await Promise.all(t.map((t=>this._checkPendingTx(t))))}catch(t){a.default.error("PendingTransactionTracker - Error updating pending transactions"),a.default.error(t)}t.releaseLock()}async resubmitPendingTxs(t){const e=this.getPendingTransactions();if(e.length)for(const n of e)try{await this._resubmitTx(n,t)}catch(t){var r,s;const e=(null===(r=t.value)||void 0===r||null===(s=r.message)||void 0===s?void 0:s.toLowerCase())||t.message.toLowerCase();if(e.includes("replacement transaction underpriced")||e.includes("known transaction")||e.includes("gas price too low to replace")||e.includes("transaction with the same hash was already imported")||e.includes("gateway timeout")||e.includes("nonce too low"))return;n.warning={error:e,message:"There was an error when resubmitting this transaction."},this.emit("tx:warning",n,t)}}async _resubmitTx(t,e){t.firstRetryBlockNumber||this.emit("tx:block-update",t,e);const r=t.firstRetryBlockNumber||e,s=Number.parseInt(e,16)-Number.parseInt(r,16),n=t.retryCount||0;if(s<Math.min(50,Math.pow(2,n)))return undefined;if(!("rawTx"in t))return this.approveTransaction(t.id);const{rawTx:i}=t,a=await this.publishTransaction(i);return this.emit("tx:retry",t),a}async _checkPendingTx(t){const e=t.hash,r=t.id;if(t.status===c.TRANSACTION_STATUSES.SUBMITTED){if(!e){const t=new Error("We had an error while submitting this transaction, please try again.");return t.name="NoTxHashError",void this.emit("tx:failed",r,t)}if(await this._checkIfNonceIsTaken(t))this.emit("tx:dropped",r);else{try{const t=await this.query.getTransactionReceipt(e);if(null!=t&&t.blockNumber){const{baseFeePerGas:e,timestamp:s}=await this.query.getBlockByHash(null==t?void 0:t.blockHash,!1);return void this.emit("tx:confirmed",r,t,e,s)}}catch(e){return t.warning={error:e.message,message:"There was a problem loading this transaction."},void this.emit("tx:warning",t,e)}await this._checkIfTxWasDropped(t)&&this.emit("tx:dropped",r)}}}async _checkIfTxWasDropped(t){const{hash:e,txParams:{nonce:r,from:s}}=t,n=await this.query.getTransactionCount(s);if(parseInt(r,16)>=n.toNumber())return!1;this.droppedBlocksBufferByHash.has(e)||this.droppedBlocksBufferByHash.set(e,0);const i=this.droppedBlocksBufferByHash.get(e);return i<this.DROPPED_BUFFER_COUNT?(this.droppedBlocksBufferByHash.set(e,i+1),!1):(this.droppedBlocksBufferByHash.delete(e),!0)}async _checkIfNonceIsTaken(t){const e=t.txParams.from;return this.getCompletedTransactions(e).some((e=>!(e.id===t.id)&&e.txParams.nonce===t.txParams.nonce))}}r.default=u}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/transactions/pending-tx-tracker.js"}],[41,{"../../../../shared/constants/transaction":6908,"../../../../shared/modules/random-id":6916,"../../../../shared/modules/transaction.utils":6920,"../../metamask-controller":100,"./lib/tx-state-history-helpers":37,"./lib/util":38,"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"@metamask/obs-store":1237,lodash:5866,loglevel:5876,"safe-event-emitter":6451},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(t("@babel/runtime/helpers/defineProperty")),i=s(t("safe-event-emitter")),a=t("@metamask/obs-store"),o=s(t("loglevel")),c=t("lodash"),u=s(t("../../../../shared/modules/random-id")),h=t("../../../../shared/constants/transaction"),l=t("../../metamask-controller"),d=t("../../../../shared/modules/transaction.utils"),p=t("./lib/tx-state-history-helpers"),m=t("./lib/util");function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function g(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach((function(e){(0,n.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}class y extends i.default{constructor({initState:t,txHistoryLimit:e,getNetwork:r,getCurrentChainId:s}){super(),this.store=new a.ObservableStore(g({transactions:{}},t)),this.txHistoryLimit=e,this.getNetwork=r,this.getCurrentChainId=s}generateTxMeta(t={}){var e;const r=this.getNetwork(),s=this.getCurrentChainId();if("loading"===r)throw new Error("MetaMask is having trouble connecting to the network");let n=null;return t.txParams&&"string"==typeof t.origin&&"metamask"!==t.origin&&(void 0!==t.txParams.gasPrice?n={gasPrice:t.txParams.gasPrice}:void 0===t.txParams.maxFeePerGas&&void 0===t.txParams.maxPriorityFeePerGas||(n={maxPriorityFeePerGas:t.txParams.maxPriorityFeePerGas,maxFeePerGas:t.txParams.maxFeePerGas}),void 0!==t.txParams.gas&&(n=g(g({},n),{},{gas:t.txParams.gas}))),g({id:(0,u.default)(),time:(new Date).getTime(),status:h.TRANSACTION_STATUSES.UNAPPROVED,metamaskNetworkId:r,originalGasEstimate:null===(e=t.txParams)||void 0===e?void 0:e.gas,userEditedGasLimit:!1,chainId:s,loadingDefaults:!0,dappSuggestedGasFees:n},t)}getUnapprovedTxList(){const t=this.getCurrentChainId(),e=this.getNetwork();return(0,c.pickBy)(this.store.getState().transactions,(r=>r.status===h.TRANSACTION_STATUSES.UNAPPROVED&&(0,d.transactionMatchesNetwork)(r,t,e)))}getApprovedTransactions(t){const e={status:h.TRANSACTION_STATUSES.APPROVED};return t&&(e.from=t),this.getTransactions({searchCriteria:e})}getPendingTransactions(t){const e={status:h.TRANSACTION_STATUSES.SUBMITTED};return t&&(e.from=t),this.getTransactions({searchCriteria:e})}getConfirmedTransactions(t){const e={status:h.TRANSACTION_STATUSES.CONFIRMED};return t&&(e.from=t),this.getTransactions({searchCriteria:e})}addTransaction(t){t.txParams&&(t.txParams=(0,m.normalizeAndValidateTxParams)(t.txParams,!1)),this.once(`${t.id}:signed`,(()=>{this.removeAllListeners(`${t.id}:rejected`)})),this.once(`${t.id}:rejected`,(()=>{this.removeAllListeners(`${t.id}:signed`)})),t.history=[];const e=(0,p.snapshotFromTxMeta)(t);t.history.push(e);const r=this.getTransactions({filterToCurrentNetwork:!1}),{txHistoryLimit:s}=this,n=new Set,i=r.reverse().filter((t=>{const{nonce:e,from:r}=t.txParams,{chainId:i,metamaskNetworkId:a,status:o}=t,c=`${e}-${null!=i?i:a}-${r}`;return!n.has(c)&&(!(n.size<s-1||!1===(0,m.getFinalStates)().includes(o))||(n.add(c),!1))})).map((t=>t.id));return this._deleteTransactions(i),this._addTransactionsToState([t]),t}addExternalTransaction(t){var e;const r=null==t||null===(e=t.txParams)||void 0===e?void 0:e.from,s=this.getConfirmedTransactions(r),n=this.getPendingTransactions(r);return(0,m.validateConfirmedExternalTransaction)({txMeta:t,pendingTransactions:n,confirmedTransactions:s}),this._addTransactionsToState([t]),t}getTransaction(t){const{transactions:e}=this.store.getState();return e[t]}updateTransaction(t,e){t.txParams&&(t.txParams=(0,m.normalizeAndValidateTxParams)(t.txParams,!1));const r=(0,p.snapshotFromTxMeta)(t),s=(0,p.replayHistory)(t.history),n=(0,p.generateHistoryEntry)(s,r,e);n.length&&t.history.push(n);const i=t.id;this.store.updateState({transactions:g(g({},this.store.getState().transactions),{},{[i]:t})})}getTransactions({searchCriteria:t={},initialList:e,filterToCurrentNetwork:r=!0,limit:s}={}){const n=this.getCurrentChainId(),i=this.getNetwork(),a=(0,c.mapValues)(t,(t=>"function"==typeof t?t:e=>e===t)),o=e?(0,c.keyBy)(e,"id"):this.store.getState().transactions,u=(0,c.sortBy)((0,c.pickBy)(o,(t=>{if(r&&!1===(0,d.transactionMatchesNetwork)(t,n,i))return!1;for(const[e,r]of Object.entries(a))if(e in t.txParams){if(!1===r(t.txParams[e]))return!1}else if(!1===r(t[e]))return!1;return!0})),"time");if(s!==undefined){const t=new Set,e=[];for(let r=u.length-1;r>-1;r--){const n=u[r],{nonce:i}=n.txParams;if(!t.has(i)){if(!(t.size<s))continue;t.add(i)}e.unshift(n)}return e}return u}setTxStatusRejected(t){this._setTransactionStatus(t,h.TRANSACTION_STATUSES.REJECTED),this._deleteTransaction(t)}setTxStatusUnapproved(t){this._setTransactionStatus(t,h.TRANSACTION_STATUSES.UNAPPROVED)}setTxStatusApproved(t){this._setTransactionStatus(t,h.TRANSACTION_STATUSES.APPROVED)}setTxStatusSigned(t){this._setTransactionStatus(t,h.TRANSACTION_STATUSES.SIGNED)}setTxStatusSubmitted(t){const e=this.getTransaction(t);e.submittedTime=(new Date).getTime(),this.updateTransaction(e,"txStateManager - add submitted time stamp"),this._setTransactionStatus(t,h.TRANSACTION_STATUSES.SUBMITTED)}setTxStatusConfirmed(t){this._setTransactionStatus(t,h.TRANSACTION_STATUSES.CONFIRMED)}setTxStatusDropped(t){this._setTransactionStatus(t,h.TRANSACTION_STATUSES.DROPPED)}setTxStatusFailed(t,e){var r;const s=e||new Error("Internal metamask failure"),n=this.getTransaction(t);n.err={message:(null===(r=s.message)||void 0===r?void 0:r.toString())||s.toString(),rpc:s.value,stack:s.stack},this.updateTransaction(n,"transactions:tx-state-manager#fail - add error"),this._setTransactionStatus(t,h.TRANSACTION_STATUSES.FAILED)}wipeTransactions(t){const{transactions:e}=this.store.getState(),r=this.getNetwork(),s=this.getCurrentChainId();this.store.updateState({transactions:(0,c.omitBy)(e,(e=>e.txParams.from===t&&(0,d.transactionMatchesNetwork)(e,s,r)))})}clearUnapprovedTxs(){this.store.updateState({transactions:(0,c.omitBy)(this.store.getState().transactions,(t=>t.status===h.TRANSACTION_STATUSES.UNAPPROVED))})}_setTransactionStatus(t,e){const r=this.getTransaction(t);if(r){r.status=e;try{this.updateTransaction(r,`txStateManager: setting status to ${e}`),this.emit(`${r.id}:${e}`,t),this.emit("tx:status-update",t,e),[h.TRANSACTION_STATUSES.SUBMITTED,h.TRANSACTION_STATUSES.REJECTED,h.TRANSACTION_STATUSES.FAILED].includes(e)&&this.emit(`${r.id}:finished`,r),this.emit(l.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}catch(t){o.default.error(t)}}}_addTransactionsToState(t){this.store.updateState({transactions:t.reduce(((t,e)=>(t[e.id]=e,t)),this.store.getState().transactions)})}_deleteTransaction(t){const{transactions:e}=this.store.getState();delete e[t],this.store.updateState({transactions:e})}_deleteTransactions(t){const{transactions:e}=this.store.getState();t.forEach((t=>{delete e[t]})),this.store.updateState({transactions:e})}}r.default=y}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/transactions/tx-state-manager.js"}],[3216,{"./index.js":3201,"aes-js":2063,crypto:2592,"ethereumjs-util":3206,"safe-buffer":6450,scryptsy:6460,utf8:6722},function(){with(this)return function(){"use strict";return function(t,e,r){var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=t("./index.js"),i=t("ethereumjs-util"),a=t("crypto"),o=t("scryptsy"),c=t("utf8"),u=t("aes-js"),h=t("safe-buffer").Buffer;function l(t,e){if(!t)throw new Error(e||"Assertion failed")}var d={};d.fromEtherWallet=function(t,e){var r,i="object"===(void 0===t?"undefined":s(t))?t:JSON.parse(t);if(i.locked){if("string"!=typeof e)throw new Error("Password required");if(e.length<7)throw new Error("Password must be at least 7 characters");var o=i.encrypted?i.private.slice(0,128):i.private;if(o=function(t){var e=h.from(t,"base64");return"Salted__"===e.slice(0,8).toString()?{salt:e.slice(8,16),ciphertext:e.slice(16)}:{ciphertext:e}}(o),!o.salt)throw new Error("Unsupported EtherWallet key format");var u=function(t,e,r){function s(s){var n=a.createHash(r.digest||"md5");n.update(s),n.update(t),n.update(e),s=n.digest();for(var i=1;i<(r.count||1);i++)(n=a.createHash(r.digest||"md5")).update(s),s=n.digest();return s}for(var n=r.keysize||16,i=r.ivsize||16,o=[],c=0;h.concat(o).length<n+i;)o[c]=s(0===c?h.alloc(0):o[c-1]),c++;var u=h.concat(o);return{key:u.slice(0,n),iv:u.slice(n,n+i)}}(h.from(e),o.salt,{keysize:32,ivsize:16});r=function(t,e){return h.concat([t.update(e),t.final()])}(a.createDecipheriv("aes-256-cbc",u.key,u.iv),h.from(o.ciphertext)),r=h.from(c.decode(r.toString()),"hex")}else{if(64!==i.private.length)throw new Error("Invalid private key length");r=h.from(i.private,"hex")}var l=new n(r);if(l.getAddressString()!==i.address)throw new Error("Invalid private key or address");return l},d.fromEtherCamp=function(t){return new n(i.keccak256(h.from(t)))},d.fromKryptoKit=function(t,e){"#"===t[0]&&(t=t.slice(1));var r,s=t[0];if(t=t.slice(1),"d"===s)r=i.sha256(h.from(t));else{if("q"!==s)throw new Error("Unsupported or invalid entropy type");if("string"!=typeof e)throw new Error("Password required");var a=i.sha256(h.from(t.slice(0,30))),c=t.slice(30,46),l=function(t){function e(t){try{return decodeURIComponent(t)}catch(t){return String.fromCharCode(65533)}}for(var r="",s="",n=0;n<t.length;n++)t[n]<=127?(r+=e(s)+String.fromCharCode(t[n]),s=""):s+="%"+t[n].toString(16);return h.from(r+e(s))}(a),d=o(h.from(e,"utf8"),l,16384,8,1,32),p=new u.ModeOfOperation.ecb(d);if(r=h.concat([h.from(p.decrypt(a.slice(0,16))),h.from(p.decrypt(a.slice(16,32)))]),c.length>0&&c!==i.sha256(i.sha256(r)).slice(0,8).toString("hex"))throw new Error("Failed to decrypt input - possibly invalid passphrase")}return new n(r)},d.fromQuorumWallet=function(t,e){l(t.length>=10),l(e.length>=10);var r=t+e;return r=a.pbkdf2Sync(r,r,2e3,32,"sha256"),new n(r)},e.exports=d}}},{package:"ethereumjs-wallet",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/ethereumjs-wallet/thirdparty.js"}],[3201,{bs58check:2488,crypto:2592,"ethereumjs-util":3206,randombytes:6261,"safe-buffer":6450,scryptsy:6460,"uuid/v4":3215},function(){with(this)return function(){"use strict";return function(t,e,r){var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=t("safe-buffer").Buffer,i=t("ethereumjs-util"),a=t("crypto"),o=t("randombytes"),c=t("scryptsy"),u=t("uuid/v4"),h=t("bs58check");function l(t,e){if(!t)throw new Error(e||"Assertion failed")}function d(t,e){return n.concat([t.update(e),t.final()])}var p=function(t,e){if(t&&e)throw new Error("Cannot supply both a private and a public key to the constructor");if(t&&!i.isValidPrivate(t))throw new Error("Private key does not satisfy the curve requirements (ie. it is invalid)");if(e&&!i.isValidPublic(e))throw new Error("Invalid public key");this._privKey=t,this._pubKey=e};Object.defineProperty(p.prototype,"privKey",{get:function(){return l(this._privKey,"This is a public key only wallet"),this._privKey}}),Object.defineProperty(p.prototype,"pubKey",{get:function(){return this._pubKey||(this._pubKey=i.privateToPublic(this.privKey)),this._pubKey}}),p.generate=function(t){if(!t)return new p(o(32));for(var e=new i.BN("088f924eeceeda7fe92e1f5b0fffffffffffffff",16);;){var r=o(32);if(new i.BN(i.privateToAddress(r)).lte(e))return new p(r)}},p.generateVanityAddress=function(t){for("object"!==(void 0===t?"undefined":s(t))&&(t=new RegExp(t));;){var e=o(32),r=i.privateToAddress(e);if(t.test(r.toString("hex")))return new p(e)}},p.prototype.getPrivateKey=function(){return this.privKey},p.prototype.getPrivateKeyString=function(){return i.bufferToHex(this.getPrivateKey())},p.prototype.getPublicKey=function(){return this.pubKey},p.prototype.getPublicKeyString=function(){return i.bufferToHex(this.getPublicKey())},p.prototype.getAddress=function(){return i.publicToAddress(this.pubKey)},p.prototype.getAddressString=function(){return i.bufferToHex(this.getAddress())},p.prototype.getChecksumAddressString=function(){return i.toChecksumAddress(this.getAddressString())},p.prototype.toV3=function(t,e){l(this._privKey,"This is a public key only wallet");var r,s=(e=e||{}).salt||o(32),h=e.iv||o(16),p=e.kdf||"scrypt",m={dklen:e.dklen||32,salt:s.toString("hex")};if("pbkdf2"===p)m.c=e.c||262144,m.prf="hmac-sha256",r=a.pbkdf2Sync(n.from(t),s,m.c,m.dklen,"sha256");else{if("scrypt"!==p)throw new Error("Unsupported kdf");m.n=e.n||262144,m.r=e.r||8,m.p=e.p||1,r=c(n.from(t),s,m.n,m.r,m.p,m.dklen)}var f=a.createCipheriv(e.cipher||"aes-128-ctr",r.slice(0,16),h);if(!f)throw new Error("Unsupported cipher");var g=d(f,this.privKey),y=i.keccak256(n.concat([r.slice(16,32),n.from(g,"hex")]));return{version:3,id:u({random:e.uuid||o(16)}),address:this.getAddress().toString("hex"),crypto:{ciphertext:g.toString("hex"),cipherparams:{iv:h.toString("hex")},cipher:e.cipher||"aes-128-ctr",kdf:p,kdfparams:m,mac:y.toString("hex")}}},p.prototype.getV3Filename=function(t){return["UTC--",(t?new Date(t):new Date).toJSON().replace(/:/g,"-"),"--",this.getAddress().toString("hex")].join("")},p.prototype.toV3String=function(t,e){return JSON.stringify(this.toV3(t,e))},p.fromPublicKey=function(t,e){return e&&(t=i.importPublic(t)),new p(null,t)},p.fromExtendedPublicKey=function(t){return l("xpub"===t.slice(0,4),"Not an extended public key"),t=h.decode(t).slice(45),p.fromPublicKey(t,!0)},p.fromPrivateKey=function(t){return new p(t)},p.fromExtendedPrivateKey=function(t){l("xprv"===t.slice(0,4),"Not an extended private key");var e=h.decode(t);return l(0===e[45],"Invalid extended private key"),p.fromPrivateKey(e.slice(46))},p.fromV1=function(t,e){l("string"==typeof e);var r="object"===(void 0===t?"undefined":s(t))?t:JSON.parse(t);if("1"!==r.Version)throw new Error("Not a V1 wallet");if("scrypt"!==r.Crypto.KeyHeader.Kdf)throw new Error("Unsupported key derivation scheme");var o=r.Crypto.KeyHeader.KdfParams,u=c(n.from(e),n.from(r.Crypto.Salt,"hex"),o.N,o.R,o.P,o.DkLen),h=n.from(r.Crypto.CipherText,"hex");if(i.keccak256(n.concat([u.slice(16,32),h])).toString("hex")!==r.Crypto.MAC)throw new Error("Key derivation failed - possibly wrong passphrase");var m=d(a.createDecipheriv("aes-128-cbc",i.keccak256(u.slice(0,16)).slice(0,16),n.from(r.Crypto.IV,"hex")),h);return new p(m)},p.fromV3=function(t,e,r){l("string"==typeof e);var o,u,h="object"===(void 0===t?"undefined":s(t))?t:JSON.parse(r?t.toLowerCase():t);if(3!==h.version)throw new Error("Not a V3 wallet");if("scrypt"===h.crypto.kdf)u=h.crypto.kdfparams,o=c(n.from(e),n.from(u.salt,"hex"),u.n,u.r,u.p,u.dklen);else{if("pbkdf2"!==h.crypto.kdf)throw new Error("Unsupported key derivation scheme");if("hmac-sha256"!==(u=h.crypto.kdfparams).prf)throw new Error("Unsupported parameters to PBKDF2");o=a.pbkdf2Sync(n.from(e),n.from(u.salt,"hex"),u.c,u.dklen,"sha256")}var m=n.from(h.crypto.ciphertext,"hex");if(i.keccak256(n.concat([o.slice(16,32),m])).toString("hex")!==h.crypto.mac)throw new Error("Key derivation failed - possibly wrong passphrase");var f=d(a.createDecipheriv(h.crypto.cipher,o.slice(0,16),n.from(h.crypto.cipherparams.iv,"hex")),m);return new p(f)},p.fromEthSale=function(t,e){l("string"==typeof e);var r="object"===(void 0===t?"undefined":s(t))?t:JSON.parse(t),o=n.from(r.encseed,"hex"),c=a.pbkdf2Sync(e,e,2e3,32,"sha256").slice(0,16),u=d(a.createDecipheriv("aes-128-cbc",c,o.slice(0,16)),o.slice(16)),h=new p(i.keccak256(u));if(h.getAddress().toString("hex")!==r.ethaddr)throw new Error("Decoded key mismatch - possibly wrong passphrase");return h},e.exports=p}}},{package:"ethereumjs-wallet",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/ethereumjs-wallet/index.js"}],[23,{"../../../../shared/constants/network":6904,"../../../../shared/constants/time":6907,"../../../../shared/modules/fetch-with-timeout":6912,"../../../../shared/modules/network.utils":6915,"./createInfuraClient":18,"./createJsonRpcClient":19,"./createMetamaskMiddleware":20,"@babel/runtime/helpers/defineProperty":207,"@babel/runtime/helpers/interopRequireDefault":213,"@metamask/obs-store":1237,_process:6127,assert:2088,"eth-json-rpc-middleware":3080,"eth-query":3125,events:2479,"json-rpc-engine":5419,loglevel:5876,"safe-event-emitter":6451,"swappable-obj-proxy":6621},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){var s=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.NETWORK_EVENTS=void 0;var n=s(t("@babel/runtime/helpers/defineProperty")),i=t("assert"),a=s(t("events")),o=t("@metamask/obs-store"),c=t("json-rpc-engine"),u=t("eth-json-rpc-middleware"),h=s(t("loglevel")),l=t("swappable-obj-proxy"),d=s(t("eth-query")),p=s(t("safe-event-emitter")),m=t("../../../../shared/constants/network"),f=t("../../../../shared/constants/time"),g=t("../../../../shared/modules/network.utils"),y=s(t("../../../../shared/modules/fetch-with-timeout")),w=s(t("./createMetamaskMiddleware")),v=s(t("./createInfuraClient")),b=s(t("./createJsonRpcClient"));function k(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?k(Object(r),!0).forEach((function(e){(0,n.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}const M=(0,y.default)(30*f.SECOND);let S,P={};S=e.env.IN_TEST?{type:m.NETWORK_TYPE_RPC,rpcUrl:"http://localhost:8545",chainId:"0x539",nickname:"Localhost 8545",ticker:m.ETH_SYMBOL}:{type:m.MISESNETWORK,chainId:m.MISES_CHAIN_ID,ticker:m.MISES_SYMBOL,rpcUrl:m.MISES_RPC_URL};const T=_({},S),x={EIPS:{1559:undefined}},E={NETWORK_DID_CHANGE:"networkDidChange",NETWORK_WILL_CHANGE:"networkWillChange",INFURA_IS_BLOCKED:"infuraIsBlocked",INFURA_IS_UNBLOCKED:"infuraIsUnblocked"};r.NETWORK_EVENTS=E;class A extends p.default{isRunning(){return!0}getCurrentBlock(){return""}getLatestBlock(){return""}checkForLatestBlock(){return""}removeAllListeners(t){return this}}class I extends a.default{constructor(t={}){super(),this.providerStore=new o.ObservableStore(t.provider||_({},T)),this.previousProviderStore=new o.ObservableStore(this.providerStore.getState()),this.networkStore=new o.ObservableStore("loading"),this.networkDetails=new o.ObservableStore(t.networkDetails||_({},x)),this.store=new o.ComposedStore({provider:this.providerStore,previousProviderStore:this.previousProviderStore,network:this.networkStore,networkDetails:this.networkDetails}),this._provider=null,this._blockTracker=null,this._providerProxy=null,this._blockTrackerProxy=null,P=t,this.on(E.NETWORK_DID_CHANGE,this.lookupNetwork)}setInfuraProjectId(t){if(!t||"string"!=typeof t)throw new Error("Invalid Infura project ID");this._infuraProjectId=t}initializeProvider(t){this._baseProviderParams=t;const{type:e,rpcUrl:r,chainId:s}=this.getProviderConfig();this._configureProvider({type:e,rpcUrl:r,chainId:s}),this.lookupNetwork()}getProviderAndBlockTracker(){return{provider:this._providerProxy,blockTracker:this._blockTrackerProxy}}getLatestBlock(){return new Promise(((t,e)=>{const{provider:r}=this.getProviderAndBlockTracker();new d.default(r).sendAsync({method:"eth_getBlockByNumber",params:["latest",!1]},((r,s)=>r?e(r):t(s)))}))}async getEIP1559Compatibility(){const{EIPS:t}=this.networkDetails.getState();if(t[1559]!==undefined)return t[1559];const e=await this.getLatestBlock(),r=e&&e.baseFeePerGas!==undefined;return this.setNetworkEIPSupport(1559,r),r}verifyNetwork(){this.isNetworkLoading()&&this.lookupNetwork()}getNetworkState(){return this.networkStore.getState()}setNetworkState(t){this.networkStore.putState(t)}setNetworkEIPSupport(t,e){this.networkDetails.updateState({EIPS:{[t]:e}})}clearNetworkDetails(){this.networkDetails.putState(_({},x))}isNetworkLoading(){return"loading"===this.getNetworkState()}lookupNetwork(){if(!this._provider)return void h.default.warn("NetworkController - lookupNetwork aborted due to missing provider");if(!this.getCurrentChainId())return h.default.warn("NetworkController - lookupNetwork aborted due to missing chainId"),this.setNetworkState("loading"),void this.clearNetworkDetails();const t=new d.default(this._provider),e=this.getNetworkState(),{type:r}=this.getProviderConfig();m.INFURA_PROVIDER_TYPES.includes(r)?this._checkInfuraAvailability(r):this.emit(E.INFURA_IS_UNBLOCKED),t.sendAsync({method:"net_version"},((t,r)=>{const s=this.getNetworkState();if(e===s){if(t)return this.setNetworkState("loading"),void this.clearNetworkDetails();this.setNetworkState(r),this.getEIP1559Compatibility()}}))}getCurrentChainId(){var t;const{type:e,chainId:r}=this.getProviderConfig();return(null===(t=m.NETWORK_TYPE_TO_ID_MAP[e])||void 0===t?void 0:t.chainId)||r}setRpcTarget(t,e,r="ETH",s="",n){i.strict.ok((0,g.isPrefixedFormattedHexString)(e),`Invalid chain ID "${e}": invalid hex string.`),i.strict.ok((0,g.isSafeChainId)(parseInt(e,16)),`Invalid chain ID "${e}": numerical value greater than max safe value.`),this.setProviderConfig({type:m.NETWORK_TYPE_RPC,rpcUrl:t,chainId:e,ticker:r,nickname:s,rpcPrefs:n})}async setProviderType(t){const e="MisesTestNet"===t;e||(i.strict.notStrictEqual(t,m.NETWORK_TYPE_RPC,`NetworkController - cannot call "setProviderType" with type "${m.NETWORK_TYPE_RPC}". Use "setRpcTarget"`),i.strict.ok(m.INFURA_PROVIDER_TYPES.includes(t),`Unknown Infura provider type "${t}".`));const{chainId:r}=m.NETWORK_TYPE_TO_ID_MAP[t];this.setProviderConfig({type:t,rpcUrl:e?m.MISES_RPC_URL:"",chainId:r,ticker:e?"MIS":"ETH",nickname:e?m.MISES_DISPLAY_NAME:""})}resetConnection(){this.setProviderConfig(this.getProviderConfig())}setProviderConfig(t){this.previousProviderStore.updateState(this.getProviderConfig()),this.providerStore.updateState(t),this._switchNetwork(t)}rollbackToPreviousProvider(){const t=this.previousProviderStore.getState();this.providerStore.updateState(t),this._switchNetwork(t)}getProviderConfig(){return this.providerStore.getState()}getNetworkIdentifier(){const t=this.providerStore.getState();return t.type===m.NETWORK_TYPE_RPC?t.rpcUrl:t.type}async _checkInfuraAvailability(t){const e=`https://${t}.infura.io/v3/${this._infuraProjectId}`;let r=!1;this.once(E.NETWORK_DID_CHANGE,(()=>{r=!0}));try{const t=await M(e,{method:"POST",body:JSON.stringify({jsonrpc:"2.0",method:"eth_blockNumber",params:[],id:1})});if(r)return;if(t.ok)this.emit(E.INFURA_IS_UNBLOCKED);else{const e=await t.json();if(r)return;e.error===m.INFURA_BLOCKED_KEY&&this.emit(E.INFURA_IS_BLOCKED)}}catch(t){h.default.warn("MetaMask - Infura availability check failed",t)}}_switchNetwork(t){this.emit(E.NETWORK_WILL_CHANGE),this.setNetworkState("loading"),this.clearNetworkDetails(),this._configureProvider(t),this.emit(E.NETWORK_DID_CHANGE,t.type)}_configureProvider({type:t,rpcUrl:e,chainId:r}){if(m.INFURA_PROVIDER_TYPES.includes(t))this._configureInfuraProvider(t,this._infuraProjectId);else if(t===m.NETWORK_TYPE_RPC)this._configureStandardProvider(e,r);else{if(t!==m.MISESNETWORK)throw new Error(`NetworkController - _configureProvider - unknown type "${t}"`);{const t=new A,e=(t,e,r,s)=>{if(console.log("MisesMiddleware","req",t),"eth_chainId"===t.method)return e.result=-1,s();if("net_version"===t.method)return e.result="0x4",s();if("eth_getBalance"===t.method)return e.result=0,s();if("eth_getBlockByNumber"===t.method)return e.result=null,s();if("eth_call"===t.method||"eth_sendTransaction"===t.method||"eth_sendTransaction"===t.method)throw new Error(`Your Metamask wallet is now connected to Mises chain, please switch to ETH chain before invoke ${t.method}`);return r()};this._setNetworkClient({networkMiddleware:e,blockTracker:t})}}}_configureInfuraProvider(t,e){h.default.info("NetworkController - configureInfuraProvider",t);const r=(0,v.default)({network:t,projectId:e});this._setNetworkClient(r)}_configureStandardProvider(t,e){h.default.info("NetworkController - configureStandardProvider",t);const r=(0,b.default)({rpcUrl:t,chainId:e});this._setNetworkClient(r)}_setNetworkClient({networkMiddleware:t,blockTracker:e}){const r=(0,w.default)(this._baseProviderParams),s=new c.JsonRpcEngine;s.push(r),s.push(t);const n=(0,u.providerFromEngine)(s);this._setProviderAndBlockTracker({provider:n,blockTracker:e})}_setProviderAndBlockTracker({provider:t,blockTracker:e}){this._providerProxy?this._providerProxy.setTarget(t):this._providerProxy=(0,l.createSwappableProxy)(t),this._blockTrackerProxy?this._blockTrackerProxy.setTarget(e):this._blockTrackerProxy=(0,l.createEventEmitterProxy)(e,{eventFilter:"skipInternal"}),this._provider=t,this._blockTracker=e}mergeNetworkOpts(t){P=_(_({},P),t)}}r.default=I}).call(this)}).call(this,t("_process"))}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/app/scripts/controllers/network/network.js"}],[1361,{"./constants":1362,"./types":1364,"./utils":1365,"@metamask/controllers":1080,"bignumber.js":1366,ethers:3219,"lodash/cloneDeep":5842,"lodash/mapValues":5867},function(){with(this)return function(){"use strict";return function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.CANCELLABLE_INTERVAL=r.DEFAULT_INTERVAL=void 0;const n=t("@metamask/controllers"),i=t("bignumber.js"),a=t("ethers"),o=s(t("lodash/mapValues")),c=s(t("lodash/cloneDeep")),u=t("./types"),h=t("./utils"),l=t("./constants"),{safelyExecute:d}=n.util;r.DEFAULT_INTERVAL=5e3,r.CANCELLABLE_INTERVAL=6e4;class p extends n.BaseController{constructor({onNetworkStateChange:t,getNonceLock:e,getNetwork:s,provider:n,confirmExternalTransaction:i,trackMetaMetricsEvent:o},c,u){super(c,u),this.defaultConfig={interval:r.DEFAULT_INTERVAL,chainId:l.CHAIN_IDS.ETHEREUM,clientId:"default",supportedChainIds:[l.CHAIN_IDS.ETHEREUM,l.CHAIN_IDS.RINKEBY]},this.defaultState={smartTransactionsState:{smartTransactions:{},userOptIn:undefined,fees:undefined,liveness:!0,estimatedGas:{txData:undefined,approvalTxData:undefined}}},this.getNonceLock=e,this.getNetwork=s,this.ethersProvider=new a.ethers.providers.Web3Provider(n),this.confirmExternalTransaction=i,this.trackMetaMetricsEvent=o,this.initialize(),this.initializeSmartTransactionsForChainId(),t((({provider:t})=>{const{chainId:e}=t;this.configure({chainId:e}),this.initializeSmartTransactionsForChainId(),this.checkPoll(this.state),this.ethersProvider=new a.ethers.providers.Web3Provider(n)})),this.subscribe((t=>this.checkPoll(t)))}async fetch(t,e){const{clientId:r}=this.config,s=Object.assign(Object.assign({},e),{headers:Object.assign({"Content-Type":"application/json"},r&&{"X-Client-Id":r})});return h.handleFetch(t,s)}checkPoll(t){const{smartTransactions:e}=t.smartTransactionsState,r=e[this.config.chainId],s=null==r?void 0:r.filter(h.isSmartTransactionPending);!this.timeoutHandle&&(null==s?void 0:s.length)>0?this.poll():this.timeoutHandle&&0===(null==s?void 0:s.length)&&this.stop()}initializeSmartTransactionsForChainId(){var t;if(this.config.supportedChainIds.includes(this.config.chainId)){const{smartTransactionsState:e}=this.state;this.update({smartTransactionsState:Object.assign(Object.assign({},e),{smartTransactions:Object.assign(Object.assign({},e.smartTransactions),{[this.config.chainId]:null!==(t=e.smartTransactions[this.config.chainId])&&void 0!==t?t:[]})})})}}async poll(t){const{chainId:e,supportedChainIds:r}=this.config;t&&this.configure({interval:t},!1,!1),this.timeoutHandle&&clearInterval(this.timeoutHandle),r.includes(e)&&(await d((()=>this.updateSmartTransactions())),this.timeoutHandle=setInterval((()=>{d((()=>this.updateSmartTransactions()))}),this.config.interval))}async stop(){this.timeoutHandle&&clearInterval(this.timeoutHandle),this.timeoutHandle=undefined}setOptInState(t){this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{userOptIn:t})})}trackStxStatusChange(t,e){var r,s;if(!e)return;let n=c.default(t);if(n=Object.assign(Object.assign({},c.default(e)),n),!n.swapMetaData||n.status===e.status&&e.swapMetaData)return;const i={uuid:n.uuid,stx_status:n.status,token_from_address:null===(r=n.txParams)||void 0===r?void 0:r.from,token_from_symbol:n.sourceTokenSymbol,token_to_address:null===(s=n.txParams)||void 0===s?void 0:s.to,token_to_symbol:n.destinationTokenSymbol,processing_time:h.getStxProcessingTime(n.time),stx_enabled:!0,current_stx_enabled:!0,stx_user_opt_in:!0};this.trackMetaMetricsEvent({event:"STX Status Updated",category:"swaps",sensitiveProperties:i})}isNewSmartTransaction(t){const{chainId:e}=this.config,{smartTransactionsState:r}=this.state,{smartTransactions:s}=r,n=s[e],i=null==n?void 0:n.findIndex((e=>e.uuid===t));return-1===i||i===undefined}updateSmartTransaction(t){const{chainId:e}=this.config,{smartTransactionsState:r}=this.state,{smartTransactions:s}=r,n=s[e],i=null==n?void 0:n.findIndex((e=>e.uuid===t.uuid)),a=this.isNewSmartTransaction(t.uuid);if(this.trackStxStatusChange(t,a?undefined:n[i]),a){const s=n.findIndex((e=>{var r,s,n;return(null===(r=e.txParams)||void 0===r?void 0:r.nonce)===(null===(s=t.txParams)||void 0===s?void 0:s.nonce)&&(null===(n=e.status)||void 0===n?void 0:n.startsWith("cancelled"))})),i=[c.default(t)],a=Object.assign(Object.assign({},t),{history:i}),o=s>-1?n.slice(0,s).concat(n.slice(s+1)).concat(a):n.concat(a);this.update({smartTransactionsState:Object.assign(Object.assign({},r),{smartTransactions:Object.assign(Object.assign({},r.smartTransactions),{[e]:o})})})}else{if((t.status===u.SmartTransactionStatuses.SUCCESS||t.status===u.SmartTransactionStatuses.REVERTED)&&!t.confirmed){const e=n[i],r=Object.assign(Object.assign({},e),t);this.confirmSmartTransaction(r)}this.update({smartTransactionsState:Object.assign(Object.assign({},r),{smartTransactions:Object.assign(Object.assign({},r.smartTransactions),{[e]:r.smartTransactions[e].map(((e,r)=>r===i?Object.assign(Object.assign({},e),t):e))})})})}}async updateSmartTransactions(){const{smartTransactions:t}=this.state.smartTransactionsState,{chainId:e}=this.config,r=(null==t?void 0:t[e]).filter(h.isSmartTransactionPending).map((t=>t.uuid));r.length>0&&this.fetchSmartTransactionsStatus(r)}async confirmSmartTransaction(t){var e,r,s;const n=null===(e=t.statusMetadata)||void 0===e?void 0:e.minedHash;try{const e=await this.ethersProvider.getTransactionReceipt(n),i=await this.ethersProvider.getTransaction(n),c=null===(r=i.maxFeePerGas)||void 0===r?void 0:r.toHexString(),u=null===(s=i.maxPriorityFeePerGas)||void 0===s?void 0:s.toHexString();if(null==e?void 0:e.blockNumber){const r=await this.ethersProvider.getBlock(null==e?void 0:e.blockNumber,!1),s=null==r?void 0:r.baseFeePerGas.toHexString(),i=o.default(e,(t=>t instanceof a.ethers.BigNumber?t.toHexString():t)),l=Object.assign(Object.assign({},t.txParams),{maxFeePerGas:c,maxPriorityFeePerGas:u}),d=Object.assign(Object.assign({},t),{id:t.uuid,status:"confirmed",hash:n,txParams:l}),p=h.snapshotFromTxMeta(d),m=h.replayHistory(d.history),f=h.generateHistoryEntry(m,p,"txStateManager: setting status to confirmed"),g=f.length>0?Object.assign(Object.assign({},d),{history:d.history.concat(f)}):d;this.confirmExternalTransaction(g,i,s),this.trackMetaMetricsEvent({event:"STX Confirmed",category:"swaps"}),this.updateSmartTransaction(Object.assign(Object.assign({},t),{confirmed:!0}))}}catch(t){this.trackMetaMetricsEvent({event:"STX Confirmation Failed",category:"swaps"}),console.error("confirm error",t)}}async fetchSmartTransactionsStatus(t){const{chainId:e}=this.config,r=new URLSearchParams({uuids:t.join(",")}),s=`${h.getAPIRequestURL(u.APIType.BATCH_STATUS,e)}?${r.toString()}`,n=await this.fetch(s);return Object.entries(n).forEach((([t,e])=>{this.updateSmartTransaction({statusMetadata:e,status:h.calculateStatus(e),uuid:t})})),n}async addNonceToTransaction(t){const e=await this.getNonceLock(t.from),r=e.nextNonce;return e.releaseLock(),Object.assign(Object.assign({},t),{nonce:`0x${r.toString(16)}`})}async getFees(t){const{chainId:e}=this.config,r=await this.addNonceToTransaction(t),s=await this.fetch(h.getAPIRequestURL(u.APIType.GET_FEES,e),{method:"POST",body:JSON.stringify({tx:r})});return this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{fees:s})}),s}async estimateGas(t,e){const{chainId:r}=this.config;let s;if(e){const t=await this.addNonceToTransaction(e);s=await this.fetch(h.getAPIRequestURL(u.APIType.ESTIMATE_GAS,r),{method:"POST",body:JSON.stringify({tx:t})})}const n=await this.addNonceToTransaction(t),i=await this.fetch(h.getAPIRequestURL(u.APIType.ESTIMATE_GAS,r),{method:"POST",body:JSON.stringify(Object.assign({tx:n},e&&{pending_txs:[e]}))});return this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{estimatedGas:{txData:i,approvalTxData:s}})}),i}async submitSignedTransactions({txParams:t,signedTransactions:e,signedCanceledTransactions:s}){const{chainId:n}=this.config,o=await this.fetch(h.getAPIRequestURL(u.APIType.SUBMIT_TRANSACTIONS,n),{method:"POST",body:JSON.stringify({rawTxs:e,rawCancelTxs:s})}),c=Date.now(),l=this.getNetwork();let d;try{const e=await this.ethersProvider.getBalance(null==t?void 0:t.from);d=new i.BigNumber(e.toHexString()).toString(16)}catch(t){console.error("ethers error",t)}const p=await this.getNonceLock(null==t?void 0:t.from),m=a.ethers.utils.hexlify(p.nextNonce);t&&!(null==t?void 0:t.nonce)&&(t.nonce=m);const{nonceDetails:f}=p;return this.updateSmartTransaction({chainId:n,nonceDetails:f,metamaskNetworkId:l,preTxBalance:d,status:u.SmartTransactionStatuses.PENDING,time:c,txParams:t,uuid:o.uuid,cancellable:!0}),setTimeout((()=>{this.isNewSmartTransaction(o.uuid)||this.updateSmartTransaction({uuid:o.uuid,cancellable:!1})}),r.CANCELLABLE_INTERVAL),p.releaseLock(),o}async cancelSmartTransaction(t){const{chainId:e}=this.config;await this.fetch(h.getAPIRequestURL(u.APIType.CANCEL,e),{method:"POST",body:JSON.stringify({uuid:t})})}async fetchLiveness(){const{chainId:t}=this.config;let e=!1;try{const r=await this.fetch(h.getAPIRequestURL(u.APIType.LIVENESS,t));e=Boolean(r.lastBlock)}catch(t){console.log('"fetchLiveness" API call failed')}return this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{liveness:e})}),e}async setStatusRefreshInterval(t){t!==this.config.interval&&this.configure({interval:t},!1,!1)}getTransactions({addressFrom:t,status:e}){const{smartTransactions:r}=this.state.smartTransactionsState,{chainId:s}=this.config,n=null==r?void 0:r[s];return n&&0!==n.length?n.filter((r=>{var s;return r.status===e&&(null===(s=r.txParams)||void 0===s?void 0:s.from)===t})):[]}}r.default=p}}},{package:"@metamask/smart-transactions-controller",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/@metamask/smart-transactions-controller/dist/SmartTransactionsController.js"}],[1135,{assert:2088,coinstring:2526,crypto:2592,"safe-buffer":6450,secp256k1:1142},function(){with(this)return function(){"use strict";return function(t,e,r){var s=t("assert"),n=t("safe-buffer").Buffer,i=t("crypto"),a=t("coinstring"),o=t("secp256k1"),c=n.from("Bitcoin seed","utf8"),u=2147483648,h={private:76066276,public:76067358};function l(t){this.versions=t||h,this.depth=0,this.index=0,this._privateKey=null,this._publicKey=null,this.chainCode=null,this._fingerprint=0,this.parentFingerprint=0}function d(t,e,r){var s=n.allocUnsafe(78);s.writeUInt32BE(e,0),s.writeUInt8(t.depth,4);var i=t.depth?t.parentFingerprint:0;return s.writeUInt32BE(i,5),s.writeUInt32BE(t.index,9),t.chainCode.copy(s,13),r.copy(s,45),s}function p(t){var e=i.createHash("sha256").update(t).digest();return i.createHash("rmd160").update(e).digest()}Object.defineProperty(l.prototype,"fingerprint",{get:function(){return this._fingerprint}}),Object.defineProperty(l.prototype,"identifier",{get:function(){return this._identifier}}),Object.defineProperty(l.prototype,"pubKeyHash",{get:function(){return this.identifier}}),Object.defineProperty(l.prototype,"privateKey",{get:function(){return this._privateKey},set:function(t){s.equal(t.length,32,"Private key must be 32 bytes."),s(!0===o.privateKeyVerify(t),"Invalid private key"),this._privateKey=t,this._publicKey=o.publicKeyCreate(t,!0),this._identifier=p(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0)}}),Object.defineProperty(l.prototype,"publicKey",{get:function(){return this._publicKey},set:function(t){s(33===t.length||65===t.length,"Public key must be 33 or 65 bytes."),s(!0===o.publicKeyVerify(t),"Invalid public key"),this._publicKey=o.publicKeyConvert(t,!0),this._identifier=p(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0),this._privateKey=null}}),Object.defineProperty(l.prototype,"privateExtendedKey",{get:function(){return this._privateKey?a.encode(d(this,this.versions.private,n.concat([n.alloc(1,0),this.privateKey]))):null}}),Object.defineProperty(l.prototype,"publicExtendedKey",{get:function(){return a.encode(d(this,this.versions.public,this.publicKey))}}),l.prototype.derive=function(t){if("m"===t||"M"===t||"m'"===t||"M'"===t)return this;var e=t.split("/"),r=this;return e.forEach((function(t,e){if(0!==e){var n=t.length>1&&"'"===t[t.length-1],i=parseInt(t,10);s(i<u,"Invalid index"),n&&(i+=u),r=r.deriveChild(i)}else s(t,"m","Invalid path")})),r},l.prototype.deriveChild=function(t){var e,r=t>=u,a=n.allocUnsafe(4);if(a.writeUInt32BE(t,0),r){s(this.privateKey,"Could not derive hardened child key");var c=this.privateKey,h=n.alloc(1,0);c=n.concat([h,c]),e=n.concat([c,a])}else e=n.concat([this.publicKey,a]);var d=i.createHmac("sha512",this.chainCode).update(e).digest(),p=d.slice(0,32),m=d.slice(32),f=new l(this.versions);if(this.privateKey)try{f.privateKey=o.privateKeyTweakAdd(this.privateKey,p)}catch(e){return this.derive(t+1)}else try{f.publicKey=o.publicKeyTweakAdd(this.publicKey,p,!0)}catch(e){return this.derive(t+1,r)}return f.chainCode=m,f.depth=this.depth+1,f.parentFingerprint=this.fingerprint,f.index=t,f},l.prototype.sign=function(t){return o.sign(t,this.privateKey).signature},l.prototype.verify=function(t,e){return o.verify(t,e,this.publicKey)},l.prototype.toJSON=function(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}},l.fromMasterSeed=function(t,e){var r=i.createHmac("sha512",c).update(t).digest(),s=r.slice(0,32),n=r.slice(32),a=new l(e);return a.chainCode=n,a.privateKey=s,a},l.fromExtendedKey=function(t,e){var r=new l(e=e||h),n=a.decode(t),i=n.readUInt32BE(0);s(i===e.private||i===e.public,"Version mismatch: does not match private or public"),r.depth=n.readUInt8(4),r.parentFingerprint=n.readUInt32BE(5),r.index=n.readUInt32BE(9),r.chainCode=n.slice(13,45);var o=n.slice(45);return 0===o.readUInt8(0)?(s(i===e.private,"Version mismatch: version does not match private"),r.privateKey=o.slice(1)):(s(i===e.public,"Version mismatch: version does not match public"),r.publicKey=o),r},l.fromJSON=function(t){return l.fromExtendedKey(t.xpriv)},l.HARDENED_OFFSET=u,e.exports=l}}},{package:"hdkey",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/hdkey/lib/hdkey.js"}],[1132,{buffer:2478,"ethereumjs-abi":3175,"ethereumjs-util":1133,tweetnacl:6705,"tweetnacl-util":6704},function(){with(this)return function(){"use strict";return function(t,e,r){const{Buffer:s}=t("buffer"),n=t("ethereumjs-util"),i=t("ethereumjs-abi"),a=t("tweetnacl");a.util=t("tweetnacl-util");const o={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},c={encodeData(t,e,r,a=!0){const o=["bytes32"],c=[this.hashType(t,r)];if(a){const u=(t,e,o)=>{if(r[e]!==undefined)return["bytes32",null===o||o===undefined?"0x0000000000000000000000000000000000000000000000000000000000000000":n.keccak(this.encodeData(e,o,r,a))];if(o===undefined)throw new Error(`missing value for field ${t} of type ${e}`);if("bytes"===e)return["bytes32",n.keccak(o)];if("string"===e)return"string"==typeof o&&(o=s.from(o,"utf8")),["bytes32",n.keccak(o)];if(e.lastIndexOf("]")===e.length-1){const r=e.slice(0,e.lastIndexOf("[")),s=o.map((e=>u(t,r,e)));return["bytes32",n.keccak(i.rawEncode(s.map((([t])=>t)),s.map((([,t])=>t))))]}return[e,o]};for(const s of r[t]){const[t,r]=u(s.name,s.type,e[s.name]);o.push(t),c.push(r)}}else for(const i of r[t]){let t=e[i.name];if(t!==undefined)if("bytes"===i.type)o.push("bytes32"),t=n.keccak(t),c.push(t);else if("string"===i.type)o.push("bytes32"),"string"==typeof t&&(t=s.from(t,"utf8")),t=n.keccak(t),c.push(t);else if(r[i.type]!==undefined)o.push("bytes32"),t=n.keccak(this.encodeData(i.type,t,r,a)),c.push(t);else{if(i.type.lastIndexOf("]")===i.type.length-1)throw new Error("Arrays currently unimplemented in encodeData");o.push(i.type),c.push(t)}}return i.rawEncode(o,c)},encodeType(t,e){let r="",s=this.findTypeDependencies(t,e).filter((e=>e!==t));s=[t].concat(s.sort());for(const t of s){if(!e[t])throw new Error(`No type definition specified: ${t}`);r+=`${t}(${e[t].map((({name:t,type:e})=>`${e} ${t}`)).join(",")})`}return r},findTypeDependencies(t,e,r=[]){const[s]=t.match(/^\w*/u);if(t=s,r.includes(t)||e[t]===undefined)return r;r.push(t);for(const s of e[t])for(const t of this.findTypeDependencies(s.type,e,r))!r.includes(t)&&r.push(t);return r},hashStruct(t,e,r,s=!0){return n.keccak(this.encodeData(t,e,r,s))},hashType(t,e){return n.keccak(this.encodeType(t,e))},sanitizeData(t){const e={};for(const r of Object.keys(o.properties))t[r]&&(e[r]=t[r]);return e.types&&(e.types={EIP712Domain:[],...e.types}),e},sign(t,e=!0){const r=this.sanitizeData(t),i=[s.from("1901","hex")];return i.push(this.hashStruct("EIP712Domain",r.domain,r.types,e)),"EIP712Domain"!==r.primaryType&&i.push(this.hashStruct(r.primaryType,r.message,r.types,e)),n.keccak(s.concat(i))}};function u(t){const e=new Error("Expect argument to be non-empty array");if("object"!=typeof t||!t.length)throw e;const r=t.map((function(t){return"bytes"===t.type?n.toBuffer(t.value):t.value})),s=t.map((function(t){return t.type})),a=t.map((function(t){if(!t.name)throw e;return`${t.type} ${t.name}`}));return i.soliditySHA3(["bytes32","bytes32"],[i.soliditySHA3(new Array(t.length).fill("string"),a),i.soliditySHA3(s,r)])}function h(t,e){const r=n.toBuffer(e),s=n.fromRpcSig(r);return n.ecrecover(t,s.v,s.r,s.s)}function l(t){const e=n.toBuffer(t.data);return h(n.hashPersonalMessage(e),t.sig)}function d(t,e){let r=`${t}`;for(;r.length<e;)r=`0${r}`;return r}function p(t){const e=s.from(t,"hex").toString("base64");return a.util.decodeBase64(e)}e.exports={TYPED_MESSAGE_SCHEMA:o,TypedDataUtils:c,concatSig(t,e,r){const s=n.fromSigned(e),i=n.fromSigned(r),a=n.bufferToInt(t),o=d(n.toUnsigned(s).toString("hex"),64),c=d(n.toUnsigned(i).toString("hex"),64),u=n.stripHexPrefix(n.intToHex(a));return n.addHexPrefix(o.concat(c,u)).toString("hex")},normalize(t){if(!t)return undefined;if("number"==typeof t){const e=n.toBuffer(t);t=n.bufferToHex(e)}if("string"!=typeof t){let e="eth-sig-util.normalize() requires hex string or integer input.";throw e+=` received ${typeof t}: ${t}`,new Error(e)}return n.addHexPrefix(t.toLowerCase())},personalSign(t,e){const r=n.toBuffer(e.data),s=n.hashPersonalMessage(r),i=n.ecsign(s,t);return n.bufferToHex(this.concatSig(i.v,i.r,i.s))},recoverPersonalSignature(t){const e=l(t),r=n.publicToAddress(e);return n.bufferToHex(r)},extractPublicKey:t=>`0x${l(t).toString("hex")}`,typedSignatureHash(t){const e=u(t);return n.bufferToHex(e)},signTypedDataLegacy(t,e){const r=u(e.data),s=n.ecsign(r,t);return n.bufferToHex(this.concatSig(s.v,s.r,s.s))},recoverTypedSignatureLegacy(t){const e=h(u(t.data),t.sig),r=n.publicToAddress(e);return n.bufferToHex(r)},encrypt(t,e,r){if("x25519-xsalsa20-poly1305"===r){if(void 0===e.data)throw new Error('Cannot detect secret message, message params should be of the form {data: "secret message"} ');const r=a.box.keyPair();let s;try{s=a.util.decodeBase64(t)}catch(t){throw new Error("Bad public key")}const n=a.util.decodeUTF8(e.data),i=a.randomBytes(a.box.nonceLength),o=a.box(n,i,s,r.secretKey);return{version:"x25519-xsalsa20-poly1305",nonce:a.util.encodeBase64(i),ephemPublicKey:a.util.encodeBase64(r.publicKey),ciphertext:a.util.encodeBase64(o)}}throw new Error("Encryption type/version not supported")},encryptSafely(t,e,r){const{data:n}=e;if(!n)throw new Error("Cannot encrypt empty msg.data");if("object"==typeof n&&n.toJSON)throw new Error("Cannot encrypt with toJSON property.  Please remove toJSON property");const i={data:n,padding:""},a=s.byteLength(JSON.stringify(i),"utf-8")%2048;let o=0;a>0&&(o=2048-a-16),i.padding="0".repeat(o);const c={data:JSON.stringify(i)};return this.encrypt(t,c,r)},decrypt(t,e){if("x25519-xsalsa20-poly1305"===t.version){const r=p(e),s=a.box.keyPair.fromSecretKey(r).secretKey,n=a.util.decodeBase64(t.nonce),i=a.util.decodeBase64(t.ciphertext),o=a.util.decodeBase64(t.ephemPublicKey),c=a.box.open(i,n,o,s);let u;try{u=a.util.encodeUTF8(c)}catch(t){throw new Error("Decryption failed.")}if(u)return u;throw new Error("Decryption failed.")}throw new Error("Encryption type/version not supported.")},decryptSafely(t,e){return JSON.parse(this.decrypt(t,e)).data},getEncryptionPublicKey(t){const e=p(t),r=a.box.keyPair.fromSecretKey(e).publicKey;return a.util.encodeBase64(r)},signTypedMessage(t,e,r="V4"){switch(r){case"V1":return this.signTypedDataLegacy(t,e);case"V3":return this.signTypedData(t,e);default:return this.signTypedData_v4(t,e)}},recoverTypedMessage(t,e="V4"){switch(e){case"V1":return this.recoverTypedSignatureLegacy(t);case"V3":return this.recoverTypedSignature(t);default:return this.recoverTypedSignature_v4(t)}},signTypedData(t,e){const r=c.sign(e.data,!1),s=n.ecsign(r,t);return n.bufferToHex(this.concatSig(s.v,s.r,s.s))},signTypedData_v4(t,e){const r=c.sign(e.data),s=n.ecsign(r,t);return n.bufferToHex(this.concatSig(s.v,s.r,s.s))},recoverTypedSignature(t){const e=h(c.sign(t.data,!1),t.sig),r=n.publicToAddress(e);return n.bufferToHex(r)},recoverTypedSignature_v4(t){const e=h(c.sign(t.data),t.sig),r=n.publicToAddress(e);return n.bufferToHex(r)}}}}},{package:"eth-sig-util",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/@metamask/eth-ledger-bridge-keyring/node_modules/eth-sig-util/index.js"}],[3082,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ethersProviderAsMiddleware=r.providerAsMiddleware=void 0,r.providerAsMiddleware=function(t){return(e,r,s,n)=>{t.sendAsync(e,((t,e)=>t?n(t):(Object.assign(r,e),n())))}},r.ethersProviderAsMiddleware=function(t){return(e,r,s,n)=>{t.send(e,((t,e)=>t?n(t):(Object.assign(r,e),n())))}}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/providerAsMiddleware.js"}],[3075,{"./utils/cache":3086,"json-rpc-engine":5419},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockCacheMiddleware=void 0;const s=t("json-rpc-engine"),n=t("./utils/cache"),i=[undefined,null,"<nil>"];class a{constructor(){this.cache={}}getBlockCacheForPayload(t,e){const r=Number.parseInt(e,16);let s=this.cache[r];if(!s){const t={};this.cache[r]=t,s=t}return s}async get(t,e){const r=this.getBlockCacheForPayload(t,e),s=(0,n.cacheIdentifierForPayload)(t,!0);return s?r[s]:undefined}async set(t,e,r){if(!this.canCacheResult(t,r))return;const s=(0,n.cacheIdentifierForPayload)(t,!0);if(!s)return;this.getBlockCacheForPayload(t,e)[s]=r}canCacheRequest(t){if(!(0,n.canCache)(t))return!1;return"pending"!==(0,n.blockTagForPayload)(t)}canCacheResult(t,e){return!i.includes(e)&&!(t.method&&["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(t.method)&&(!e||!e.blockHash||"0x0000000000000000000000000000000000000000000000000000000000000000"===e.blockHash))}clearBefore(t){const e=Number.parseInt(t,16);Object.keys(this.cache).map(Number).filter((t=>t<e)).forEach((t=>delete this.cache[t]))}}r.createBlockCacheMiddleware=function({blockTracker:t}={}){if(!t)throw new Error("createBlockCacheMiddleware - No PollingBlockTracker specified");const e=new a,r={perma:e,block:e,fork:e};return(0,s.createAsyncMiddleware)((async(s,i,a)=>{if(s.skipCache)return a();const o=(0,n.cacheTypeForPayload)(s),c=r[o];if(!c)return a();if(!c.canCacheRequest(s))return a();let u,h=(0,n.blockTagForPayload)(s);if(h||(h="latest"),"earliest"===h)u="0x00";else if("latest"===h){const r=await t.getLatestBlock();e.clearBefore(r),u=r}else u=h;const l=await c.get(s,u);return l===undefined?(await a(),await c.set(s,u,i.result)):i.result=l,undefined}))}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/block-cache.js"}],[3076,{"./utils/cache":3086,"json-rpc-engine":5419},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefRewriteMiddleware=void 0;const s=t("json-rpc-engine"),n=t("./utils/cache");r.createBlockRefRewriteMiddleware=function({blockTracker:t}={}){if(!t)throw Error('BlockRefRewriteMiddleware - mandatory "blockTracker" option is missing.');return(0,s.createAsyncMiddleware)((async(e,r,s)=>{var i;const a=(0,n.blockTagParamIndex)(e);if(a===undefined)return s();let o=null===(i=e.params)||void 0===i?void 0:i[a];if(o===undefined&&(o="latest"),"latest"!==o)return s();const c=await t.getLatestBlock();return e.params&&(e.params[a]=c),s()}))}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/block-ref-rewrite.js"}],[3081,{"./utils/cache":3086,clone:2524,"json-rpc-engine":5419},function(){with(this)return function(){"use strict";return function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.createInflightCacheMiddleware=void 0;const n=s(t("clone")),i=t("json-rpc-engine"),a=t("./utils/cache");r.createInflightCacheMiddleware=function(){const t={};return(0,i.createAsyncMiddleware)((async(e,r,s)=>{if(e.skipCache)return s();const i=(0,a.cacheIdentifierForPayload)(e);if(!i)return s();let o=t[i];return o?(await function(t,e){const{resolve:r,promise:s}=function(){let t;const e=new Promise((e=>{t=e}));return{resolve:t,promise:e}}();return e.push((e=>{t.result=(0,n.default)(e.result),t.error=(0,n.default)(e.error),r()})),s}(r,o),undefined):(o=[],t[i]=o,await s(),delete t[i],function(t,e){setTimeout((()=>{e.forEach((e=>{try{e(t)}catch(t){console.error(t)}}))}))}(r,o),undefined)}))}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/inflight-cache.js"}],[3078,{"json-rpc-engine":5419},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockTrackerInspectorMiddleware=void 0;const s=t("json-rpc-engine"),n=["eth_getTransactionByHash","eth_getTransactionReceipt"];r.createBlockTrackerInspectorMiddleware=function({blockTracker:t}){return(0,s.createAsyncMiddleware)((async(e,r,s)=>{var i;if(!n.includes(e.method))return s();if(await s(),!(null===(i=r.result)||void 0===i?void 0:i.blockNumber))return undefined;if("string"==typeof r.result.blockNumber){Number.parseInt(r.result.blockNumber,16)>Number.parseInt(t.getCurrentBlock(),16)&&await t.checkForLatestBlock()}return undefined}))}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/block-tracker-inspector.js"}],[3079,{btoa:2477,"eth-rpc-errors":3129,"json-rpc-engine":5419,"node-fetch":2477},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createFetchConfigFromReq=r.createFetchMiddleware=void 0;const s=t("json-rpc-engine"),n=t("eth-rpc-errors"),i=global.fetch||t("node-fetch"),a=global.btoa||t("btoa"),o=["Gateway timeout","ETIMEDOUT","failed to parse response body","Failed to fetch"];function c(t){switch(t.status){case 405:throw n.ethErrors.rpc.methodNotFound();case 418:throw n.ethErrors.rpc.internal({message:"Request is being rate limited."});case 503:case 504:throw function(){let t="Gateway timeout. The request took too long to process. ";return t+="This can happen when querying logs over too wide a block range.",n.ethErrors.rpc.internal({message:t})}()}}function u(t,e){if(200!==t.status)throw n.ethErrors.rpc.internal({message:`Non-200 status code: '${t.status}'`,data:e});if(e.error)throw n.ethErrors.rpc.internal({data:e.error});return e.result}function h({req:t,rpcUrl:e,originHttpHeaderKey:r}){const s=new URL(e),n=function(t){let e="";e+=t.protocol,e+=`//${t.hostname}`,t.port&&(e+=`:${t.port}`);return e+=`${t.pathname}`,e+=`${t.search}`,e}(s),i={id:t.id,jsonrpc:t.jsonrpc,method:t.method,params:t.params},o=t.origin,c={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)};if(s.username&&s.password){const t=`${s.username}:${s.password}`,e=a(t);c.headers.Authorization=`Basic ${e}`}return r&&o&&(c.headers[r]=o),{fetchUrl:n,fetchParams:c}}function l(t){return new Promise((e=>setTimeout(e,t)))}r.createFetchMiddleware=function({rpcUrl:t,originHttpHeaderKey:e}){return(0,s.createAsyncMiddleware)((async(r,s,n)=>{const{fetchUrl:a,fetchParams:d}=h({req:r,rpcUrl:t,originHttpHeaderKey:e});for(let t=0;t<5;t++){try{const t=await i(a,d);c(t);const e=await t.text();let r;try{r=JSON.parse(e)}catch(t){throw new Error(`FetchMiddleware - failed to parse response body: "${e}"`)}const n=u(t,r);return void(s.result=n)}catch(t){const e=t.toString();if(!o.some((t=>e.includes(t))))throw t}await l(1e3)}}))},r.createFetchConfigFromReq=h}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/fetch.js"}],[3085,{"./utils/cache":3086,clone:2524,"json-rpc-engine":5419,pify:3109},function(){with(this)return function(){"use strict";return function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.createRetryOnEmptyMiddleware=void 0;const n=s(t("clone")),i=t("json-rpc-engine"),a=s(t("pify")),o=t("./utils/cache"),c=[undefined,null,"<nil>"];function u(t){return new Promise((e=>setTimeout(e,t)))}r.createRetryOnEmptyMiddleware=function({provider:t,blockTracker:e}={}){if(!t)throw Error('RetryOnEmptyMiddleware - mandatory "provider" option is missing.');if(!e)throw Error('RetryOnEmptyMiddleware - mandatory "blockTracker" option is missing.');return(0,i.createAsyncMiddleware)((async(r,s,i)=>{var h;const l=(0,o.blockTagParamIndex)(r);if(l===undefined)return i();let d=null===(h=r.params)||void 0===h?void 0:h[l];if(d===undefined&&(d="latest"),["latest","pending"].includes(d))return i();const p=Number.parseInt(d.slice(2),16);if(Number.isNaN(p))return i();const m=await e.getLatestBlock();if(p>Number.parseInt(m.slice(2),16))return i();const f=(0,n.default)(r),g=await async function(t,e){for(let r=0;r<t;r++)try{return await e()}catch(t){await u(1e3)}throw new Error("RetryOnEmptyMiddleware - retries exhausted")}(10,(async()=>{const e=await(0,a.default)(t.sendAsync).call(t,f);if(c.includes(e))throw new Error(`RetryOnEmptyMiddleware - empty response "${JSON.stringify(e)}" for request "${JSON.stringify(f)}"`);return e}));return s.result=g.result,s.error=g.error,i()}))}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/retryOnEmpty.js"}],[3084,{"./providerFromEngine":3083,"json-rpc-engine":5419},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.providerFromMiddleware=void 0;const s=t("json-rpc-engine"),n=t("./providerFromEngine");r.providerFromMiddleware=function(t){const e=new s.JsonRpcEngine;return e.push(t),(0,n.providerFromEngine)(e)}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/providerFromMiddleware.js"}],[3083,{"@metamask/safe-event-emitter":1359},function(){with(this)return function(){"use strict";return function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.providerFromEngine=void 0;const n=s(t("@metamask/safe-event-emitter"));r.providerFromEngine=function(t){const e=new n.default;return e.sendAsync=t.handle.bind(t),e.send=(e,r)=>{if("function"!=typeof r)throw new Error('Must provide callback to "send" method.');t.handle(e,r)},t.on&&t.on("notification",(t=>{e.emit("data",null,t)})),e}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/providerFromEngine.js"}],[3077,{"./utils/cache":3086,clone:2524,"json-rpc-engine":5419,pify:3109},function(){with(this)return function(){"use strict";return function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefMiddleware=void 0;const n=t("json-rpc-engine"),i=s(t("clone")),a=s(t("pify")),o=t("./utils/cache");r.createBlockRefMiddleware=function({provider:t,blockTracker:e}={}){if(!t)throw Error('BlockRefMiddleware - mandatory "provider" option is missing.');if(!e)throw Error('BlockRefMiddleware - mandatory "blockTracker" option is missing.');return(0,n.createAsyncMiddleware)((async(r,s,n)=>{var c;const u=(0,o.blockTagParamIndex)(r);if(u===undefined)return n();let h=null===(c=r.params)||void 0===c?void 0:c[u];if(h===undefined&&(h="latest"),"latest"!==h)return n();const l=await e.getLatestBlock(),d=(0,i.default)(r);d.params&&(d.params[u]=l);const p=await(0,a.default)(t.sendAsync).call(t,d);return s.result=p.result,s.error=p.error,n()}))}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/block-ref.js"}],[3087,{"eth-rpc-errors":3129,"eth-sig-util":3088,"json-rpc-engine":5419},function(){with(this)return function(){"use strict";return function(t,e,r){var s=this&&this.__createBinding||(Object.create?function(t,e,r,s){s===undefined&&(s=r),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,s){s===undefined&&(s=r),t[s]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&s(e,t,r);return n(e,t),e};Object.defineProperty(r,"__esModule",{value:!0}),r.createWalletMiddleware=void 0;const a=t("json-rpc-engine"),o=i(t("eth-sig-util")),c=t("eth-rpc-errors");function u(t){return 42===t.length}r.createWalletMiddleware=function({getAccounts:t,processDecryptMessage:e,processEncryptionPublicKey:r,processEthSignMessage:s,processPersonalMessage:n,processTransaction:i,processSignTransaction:h,processTypedMessage:l,processTypedMessageV3:d,processTypedMessageV4:p}){if(!t)throw new Error("opts.getAccounts is required");return(0,a.createScaffoldMiddleware)({eth_accounts:(0,a.createAsyncMiddleware)((async function(e,r){r.result=await t(e)})),eth_coinbase:(0,a.createAsyncMiddleware)((async function(e,r){const s=await t(e);r.result=s[0]||null})),eth_sendTransaction:(0,a.createAsyncMiddleware)((async function(t,e){if(!i)throw c.ethErrors.rpc.methodNotSupported();const r=t.params[0]||{};r.from=await m(r.from,t),e.result=await i(r,t)})),eth_signTransaction:(0,a.createAsyncMiddleware)((async function(t,e){if(!h)throw c.ethErrors.rpc.methodNotSupported();const r=t.params[0]||{};r.from=await m(r.from,t),e.result=await h(r,t)})),eth_sign:(0,a.createAsyncMiddleware)((async function(t,e){if(!s)throw c.ethErrors.rpc.methodNotSupported();const r=await m(t.params[0],t),n=t.params[1],i=t.params[2]||{},a=Object.assign(Object.assign({},i),{from:r,data:n});e.result=await s(a,t)})),eth_signTypedData:(0,a.createAsyncMiddleware)((async function(t,e){if(!l)throw c.ethErrors.rpc.methodNotSupported();const r=t.params[0],s=await m(t.params[1],t),n=t.params[2]||{},i=Object.assign(Object.assign({},n),{from:s,data:r});e.result=await l(i,t,"V1")})),eth_signTypedData_v3:(0,a.createAsyncMiddleware)((async function(t,e){if(!d)throw c.ethErrors.rpc.methodNotSupported();const r=await m(t.params[0],t),s=t.params[1],n={data:s,from:r,version:"V3"};e.result=await d(n,t,"V3")})),eth_signTypedData_v4:(0,a.createAsyncMiddleware)((async function(t,e){if(!p)throw c.ethErrors.rpc.methodNotSupported();const r=await m(t.params[0],t),s=t.params[1],n={data:s,from:r,version:"V4"};e.result=await p(n,t,"V4")})),personal_sign:(0,a.createAsyncMiddleware)((async function(t,e){if(!n)throw c.ethErrors.rpc.methodNotSupported();const r=t.params[0],s=t.params[1],i=t.params[2]||{};let a,o;if(u(r)&&!u(s)){let t="The eth_personalSign method requires params ordered ";t+="[message, address]. This was previously handled incorrectly, ",t+="and has been corrected automatically. ",t+="Please switch this param order for smooth behavior in the future.",e.warning=t,a=r,o=s}else o=r,a=s;a=await m(a,t);const h=Object.assign(Object.assign({},i),{from:a,data:o});e.result=await n(h,t)})),eth_getEncryptionPublicKey:(0,a.createAsyncMiddleware)((async function(t,e){if(!r)throw c.ethErrors.rpc.methodNotSupported();const s=await m(t.params[0],t);e.result=await r(s,t)})),eth_decrypt:(0,a.createAsyncMiddleware)((async function(t,r){if(!e)throw c.ethErrors.rpc.methodNotSupported();const s=t.params[0],n=await m(t.params[1],t),i=t.params[2]||{},a=Object.assign(Object.assign({},i),{from:n,data:s});r.result=await e(a,t)})),personal_ecRecover:(0,a.createAsyncMiddleware)((async function(t,e){const r=t.params[0],s=t.params[1],n=t.params[2]||{},i=Object.assign(Object.assign({},n),{sig:s,data:r}),a=o.recoverPersonalSignature(i);e.result=a}))});async function m(e,r){if("string"==typeof e&&e.length>0){const s=(await t(r)).map((t=>t.toLowerCase())),n=e.toLowerCase();if(s.includes(n))return n}throw c.ethErrors.rpc.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}}}}},{package:"eth-json-rpc-middleware",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-json-rpc-middleware/dist/wallet.js"}],[3118,{buffer:2477},function(){with(this)return function(){"use strict";return function(t,e,r){!function(e,r){function s(t,e){if(!t)throw new Error(e||"Assertion failed")}function n(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}function i(t,e,r){if(i.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(r=e,e=10),this._init(t||0,e||10,r||"be"))}var a;"object"==typeof e?e.exports=i:r.BN=i,i.BN=i,i.wordSize=26;try{a="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:t("buffer").Buffer}catch(t){}function o(t,e){var r=t.charCodeAt(e);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void s(!1,"Invalid character in "+t)}function c(t,e,r){var s=o(t,r);return r-1>=e&&(s|=o(t,r-1)<<4),s}function u(t,e,r,n){for(var i=0,a=0,o=Math.min(t.length,r),c=e;c<o;c++){var u=t.charCodeAt(c)-48;i*=n,a=u>=49?u-49+10:u>=17?u-17+10:u,s(u>=0&&a<n,"Invalid character"),i+=a}return i}function h(t,e){t.words=e.words,t.length=e.length,t.negative=e.negative,t.red=e.red}if(i.isBN=function(t){return t instanceof i||null!==t&&"object"==typeof t&&t.constructor.wordSize===i.wordSize&&Array.isArray(t.words)},i.max=function(t,e){return t.cmp(e)>0?t:e},i.min=function(t,e){return t.cmp(e)<0?t:e},i.prototype._init=function(t,e,r){if("number"==typeof t)return this._initNumber(t,e,r);if("object"==typeof t)return this._initArray(t,e,r);"hex"===e&&(e=16),s(e===(0|e)&&e>=2&&e<=36);var n=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(n++,this.negative=1),n<t.length&&(16===e?this._parseHex(t,n,r):(this._parseBase(t,e,n),"le"===r&&this._initArray(this.toArray(),e,r)))},i.prototype._initNumber=function(t,e,r){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(s(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),e,r)},i.prototype._initArray=function(t,e,r){if(s("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,a,o=0;if("be"===r)for(n=t.length-1,i=0;n>=0;n-=3)a=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[i]|=a<<o&67108863,this.words[i+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,i++);else if("le"===r)for(n=0,i=0;n<t.length;n+=3)a=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[i]|=a<<o&67108863,this.words[i+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,i++);return this._strip()},i.prototype._parseHex=function(t,e,r){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var s=0;s<this.length;s++)this.words[s]=0;var n,i=0,a=0;if("be"===r)for(s=t.length-1;s>=e;s-=2)n=c(t,e,s)<<i,this.words[a]|=67108863&n,i>=18?(i-=18,a+=1,this.words[a]|=n>>>26):i+=8;else for(s=(t.length-e)%2==0?e+1:e;s<t.length;s+=2)n=c(t,e,s)<<i,this.words[a]|=67108863&n,i>=18?(i-=18,a+=1,this.words[a]|=n>>>26):i+=8;this._strip()},i.prototype._parseBase=function(t,e,r){this.words=[0],this.length=1;for(var s=0,n=1;n<=67108863;n*=e)s++;s--,n=n/e|0;for(var i=t.length-r,a=i%s,o=Math.min(i,i-a)+r,c=0,h=r;h<o;h+=s)c=u(t,h,h+s,e),this.imuln(n),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==a){var l=1;for(c=u(t,h,t.length,e),h=0;h<a;h++)l*=e;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this._strip()},i.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},i.prototype._move=function(t){h(t,this)},i.prototype.clone=function(){var t=new i(null);return this.copy(t),t},i.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},i.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=l}catch(t){i.prototype.inspect=l}else i.prototype.inspect=l;function l(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],p=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],m=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(t,e){var r;if(e=0|e||1,16===(t=t||10)||"hex"===t){r="";for(var n=0,i=0,a=0;a<this.length;a++){var o=this.words[a],c=(16777215&(o<<n|i)).toString(16);r=0!==(i=o>>>24-n&16777215)||a!==this.length-1?d[6-c.length]+c+r:c+r,(n+=2)>=26&&(n-=26,a--)}for(0!==i&&(r=i.toString(16)+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(t===(0|t)&&t>=2&&t<=36){var u=p[t],h=m[t];r="";var l=this.clone();for(l.negative=0;!l.isZero();){var f=l.modrn(h).toString(t);r=(l=l.idivn(h)).isZero()?f+r:d[u-f.length]+f+r}for(this.isZero()&&(r="0"+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}s(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&s(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},i.prototype.toJSON=function(){return this.toString(16,2)},a&&(i.prototype.toBuffer=function(t,e){return this.toArrayLike(a,t,e)}),i.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)};function f(t,e,r){r.negative=e.negative^t.negative;var s=t.length+e.length|0;r.length=s,s=s-1|0;var n=0|t.words[0],i=0|e.words[0],a=n*i,o=67108863&a,c=a/67108864|0;r.words[0]=o;for(var u=1;u<s;u++){for(var h=c>>>26,l=67108863&c,d=Math.min(u,e.length-1),p=Math.max(0,u-t.length+1);p<=d;p++){var m=u-p|0;h+=(a=(n=0|t.words[m])*(i=0|e.words[p])+l)/67108864|0,l=67108863&a}r.words[u]=0|l,c=0|h}return 0!==c?r.words[u]=0|c:r.length--,r._strip()}i.prototype.toArrayLike=function(t,e,r){this._strip();var n=this.byteLength(),i=r||Math.max(1,n);s(n<=i,"byte array longer than desired length"),s(i>0,"Requested array length <= 0");var a=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}(t,i);return this["_toArrayLike"+("le"===e?"LE":"BE")](a,n),a},i.prototype._toArrayLikeLE=function(t,e){for(var r=0,s=0,n=0,i=0;n<this.length;n++){var a=this.words[n]<<i|s;t[r++]=255&a,r<t.length&&(t[r++]=a>>8&255),r<t.length&&(t[r++]=a>>16&255),6===i?(r<t.length&&(t[r++]=a>>24&255),s=0,i=0):(s=a>>>24,i+=2)}if(r<t.length)for(t[r++]=s;r<t.length;)t[r++]=0},i.prototype._toArrayLikeBE=function(t,e){for(var r=t.length-1,s=0,n=0,i=0;n<this.length;n++){var a=this.words[n]<<i|s;t[r--]=255&a,r>=0&&(t[r--]=a>>8&255),r>=0&&(t[r--]=a>>16&255),6===i?(r>=0&&(t[r--]=a>>24&255),s=0,i=0):(s=a>>>24,i+=2)}if(r>=0)for(t[r--]=s;r>=0;)t[r--]=0},Math.clz32?i.prototype._countBits=function(t){return 32-Math.clz32(t)}:i.prototype._countBits=function(t){var e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e},i.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&r++,r},i.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var r=this._zeroBits(this.words[e]);if(t+=r,26!==r)break}return t},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},i.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return 0!==this.negative},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this._strip()},i.prototype.ior=function(t){return s(0==(this.negative|t.negative)),this.iuor(t)},i.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},i.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},i.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var r=0;r<e.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=e.length,this._strip()},i.prototype.iand=function(t){return s(0==(this.negative|t.negative)),this.iuand(t)},i.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},i.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},i.prototype.iuxor=function(t){var e,r;this.length>t.length?(e=this,r=t):(e=t,r=this);for(var s=0;s<r.length;s++)this.words[s]=e.words[s]^r.words[s];if(this!==e)for(;s<e.length;s++)this.words[s]=e.words[s];return this.length=e.length,this._strip()},i.prototype.ixor=function(t){return s(0==(this.negative|t.negative)),this.iuxor(t)},i.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},i.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},i.prototype.inotn=function(t){s("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),r=t%26;this._expand(e),r>0&&e--;for(var n=0;n<e;n++)this.words[n]=67108863&~this.words[n];return r>0&&(this.words[n]=~this.words[n]&67108863>>26-r),this._strip()},i.prototype.notn=function(t){return this.clone().inotn(t)},i.prototype.setn=function(t,e){s("number"==typeof t&&t>=0);var r=t/26|0,n=t%26;return this._expand(r+1),this.words[r]=e?this.words[r]|1<<n:this.words[r]&~(1<<n),this._strip()},i.prototype.iadd=function(t){var e,r,s;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(r=this,s=t):(r=t,s=this);for(var n=0,i=0;i<s.length;i++)e=(0|r.words[i])+(0|s.words[i])+n,this.words[i]=67108863&e,n=e>>>26;for(;0!==n&&i<r.length;i++)e=(0|r.words[i])+n,this.words[i]=67108863&e,n=e>>>26;if(this.length=r.length,0!==n)this.words[this.length]=n,this.length++;else if(r!==this)for(;i<r.length;i++)this.words[i]=r.words[i];return this},i.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},i.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r,s,n=this.cmp(t);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(r=this,s=t):(r=t,s=this);for(var i=0,a=0;a<s.length;a++)i=(e=(0|r.words[a])-(0|s.words[a])+i)>>26,this.words[a]=67108863&e;for(;0!==i&&a<r.length;a++)i=(e=(0|r.words[a])+i)>>26,this.words[a]=67108863&e;if(0===i&&a<r.length&&r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this.length=Math.max(this.length,a),r!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(t){return this.clone().isub(t)};var g=function(t,e,r){var s,n,i,a=t.words,o=e.words,c=r.words,u=0,h=0|a[0],l=8191&h,d=h>>>13,p=0|a[1],m=8191&p,f=p>>>13,g=0|a[2],y=8191&g,w=g>>>13,v=0|a[3],b=8191&v,k=v>>>13,_=0|a[4],M=8191&_,S=_>>>13,P=0|a[5],T=8191&P,x=P>>>13,E=0|a[6],A=8191&E,I=E>>>13,O=0|a[7],C=8191&O,N=O>>>13,j=0|a[8],D=8191&j,B=j>>>13,R=0|a[9],L=8191&R,U=R>>>13,F=0|o[0],H=8191&F,K=F>>>13,q=0|o[1],$=8191&q,G=q>>>13,V=0|o[2],z=8191&V,W=V>>>13,J=0|o[3],Y=8191&J,Z=J>>>13,X=0|o[4],Q=8191&X,tt=X>>>13,et=0|o[5],rt=8191&et,st=et>>>13,nt=0|o[6],it=8191&nt,at=nt>>>13,ot=0|o[7],ct=8191&ot,ut=ot>>>13,ht=0|o[8],lt=8191&ht,dt=ht>>>13,pt=0|o[9],mt=8191&pt,ft=pt>>>13;r.negative=t.negative^e.negative,r.length=19;var gt=(u+(s=Math.imul(l,H))|0)+((8191&(n=(n=Math.imul(l,K))+Math.imul(d,H)|0))<<13)|0;u=((i=Math.imul(d,K))+(n>>>13)|0)+(gt>>>26)|0,gt&=67108863,s=Math.imul(m,H),n=(n=Math.imul(m,K))+Math.imul(f,H)|0,i=Math.imul(f,K);var yt=(u+(s=s+Math.imul(l,$)|0)|0)+((8191&(n=(n=n+Math.imul(l,G)|0)+Math.imul(d,$)|0))<<13)|0;u=((i=i+Math.imul(d,G)|0)+(n>>>13)|0)+(yt>>>26)|0,yt&=67108863,s=Math.imul(y,H),n=(n=Math.imul(y,K))+Math.imul(w,H)|0,i=Math.imul(w,K),s=s+Math.imul(m,$)|0,n=(n=n+Math.imul(m,G)|0)+Math.imul(f,$)|0,i=i+Math.imul(f,G)|0;var wt=(u+(s=s+Math.imul(l,z)|0)|0)+((8191&(n=(n=n+Math.imul(l,W)|0)+Math.imul(d,z)|0))<<13)|0;u=((i=i+Math.imul(d,W)|0)+(n>>>13)|0)+(wt>>>26)|0,wt&=67108863,s=Math.imul(b,H),n=(n=Math.imul(b,K))+Math.imul(k,H)|0,i=Math.imul(k,K),s=s+Math.imul(y,$)|0,n=(n=n+Math.imul(y,G)|0)+Math.imul(w,$)|0,i=i+Math.imul(w,G)|0,s=s+Math.imul(m,z)|0,n=(n=n+Math.imul(m,W)|0)+Math.imul(f,z)|0,i=i+Math.imul(f,W)|0;var vt=(u+(s=s+Math.imul(l,Y)|0)|0)+((8191&(n=(n=n+Math.imul(l,Z)|0)+Math.imul(d,Y)|0))<<13)|0;u=((i=i+Math.imul(d,Z)|0)+(n>>>13)|0)+(vt>>>26)|0,vt&=67108863,s=Math.imul(M,H),n=(n=Math.imul(M,K))+Math.imul(S,H)|0,i=Math.imul(S,K),s=s+Math.imul(b,$)|0,n=(n=n+Math.imul(b,G)|0)+Math.imul(k,$)|0,i=i+Math.imul(k,G)|0,s=s+Math.imul(y,z)|0,n=(n=n+Math.imul(y,W)|0)+Math.imul(w,z)|0,i=i+Math.imul(w,W)|0,s=s+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,Z)|0)+Math.imul(f,Y)|0,i=i+Math.imul(f,Z)|0;var bt=(u+(s=s+Math.imul(l,Q)|0)|0)+((8191&(n=(n=n+Math.imul(l,tt)|0)+Math.imul(d,Q)|0))<<13)|0;u=((i=i+Math.imul(d,tt)|0)+(n>>>13)|0)+(bt>>>26)|0,bt&=67108863,s=Math.imul(T,H),n=(n=Math.imul(T,K))+Math.imul(x,H)|0,i=Math.imul(x,K),s=s+Math.imul(M,$)|0,n=(n=n+Math.imul(M,G)|0)+Math.imul(S,$)|0,i=i+Math.imul(S,G)|0,s=s+Math.imul(b,z)|0,n=(n=n+Math.imul(b,W)|0)+Math.imul(k,z)|0,i=i+Math.imul(k,W)|0,s=s+Math.imul(y,Y)|0,n=(n=n+Math.imul(y,Z)|0)+Math.imul(w,Y)|0,i=i+Math.imul(w,Z)|0,s=s+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,tt)|0)+Math.imul(f,Q)|0,i=i+Math.imul(f,tt)|0;var kt=(u+(s=s+Math.imul(l,rt)|0)|0)+((8191&(n=(n=n+Math.imul(l,st)|0)+Math.imul(d,rt)|0))<<13)|0;u=((i=i+Math.imul(d,st)|0)+(n>>>13)|0)+(kt>>>26)|0,kt&=67108863,s=Math.imul(A,H),n=(n=Math.imul(A,K))+Math.imul(I,H)|0,i=Math.imul(I,K),s=s+Math.imul(T,$)|0,n=(n=n+Math.imul(T,G)|0)+Math.imul(x,$)|0,i=i+Math.imul(x,G)|0,s=s+Math.imul(M,z)|0,n=(n=n+Math.imul(M,W)|0)+Math.imul(S,z)|0,i=i+Math.imul(S,W)|0,s=s+Math.imul(b,Y)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(k,Y)|0,i=i+Math.imul(k,Z)|0,s=s+Math.imul(y,Q)|0,n=(n=n+Math.imul(y,tt)|0)+Math.imul(w,Q)|0,i=i+Math.imul(w,tt)|0,s=s+Math.imul(m,rt)|0,n=(n=n+Math.imul(m,st)|0)+Math.imul(f,rt)|0,i=i+Math.imul(f,st)|0;var _t=(u+(s=s+Math.imul(l,it)|0)|0)+((8191&(n=(n=n+Math.imul(l,at)|0)+Math.imul(d,it)|0))<<13)|0;u=((i=i+Math.imul(d,at)|0)+(n>>>13)|0)+(_t>>>26)|0,_t&=67108863,s=Math.imul(C,H),n=(n=Math.imul(C,K))+Math.imul(N,H)|0,i=Math.imul(N,K),s=s+Math.imul(A,$)|0,n=(n=n+Math.imul(A,G)|0)+Math.imul(I,$)|0,i=i+Math.imul(I,G)|0,s=s+Math.imul(T,z)|0,n=(n=n+Math.imul(T,W)|0)+Math.imul(x,z)|0,i=i+Math.imul(x,W)|0,s=s+Math.imul(M,Y)|0,n=(n=n+Math.imul(M,Z)|0)+Math.imul(S,Y)|0,i=i+Math.imul(S,Z)|0,s=s+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,tt)|0)+Math.imul(k,Q)|0,i=i+Math.imul(k,tt)|0,s=s+Math.imul(y,rt)|0,n=(n=n+Math.imul(y,st)|0)+Math.imul(w,rt)|0,i=i+Math.imul(w,st)|0,s=s+Math.imul(m,it)|0,n=(n=n+Math.imul(m,at)|0)+Math.imul(f,it)|0,i=i+Math.imul(f,at)|0;var Mt=(u+(s=s+Math.imul(l,ct)|0)|0)+((8191&(n=(n=n+Math.imul(l,ut)|0)+Math.imul(d,ct)|0))<<13)|0;u=((i=i+Math.imul(d,ut)|0)+(n>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,s=Math.imul(D,H),n=(n=Math.imul(D,K))+Math.imul(B,H)|0,i=Math.imul(B,K),s=s+Math.imul(C,$)|0,n=(n=n+Math.imul(C,G)|0)+Math.imul(N,$)|0,i=i+Math.imul(N,G)|0,s=s+Math.imul(A,z)|0,n=(n=n+Math.imul(A,W)|0)+Math.imul(I,z)|0,i=i+Math.imul(I,W)|0,s=s+Math.imul(T,Y)|0,n=(n=n+Math.imul(T,Z)|0)+Math.imul(x,Y)|0,i=i+Math.imul(x,Z)|0,s=s+Math.imul(M,Q)|0,n=(n=n+Math.imul(M,tt)|0)+Math.imul(S,Q)|0,i=i+Math.imul(S,tt)|0,s=s+Math.imul(b,rt)|0,n=(n=n+Math.imul(b,st)|0)+Math.imul(k,rt)|0,i=i+Math.imul(k,st)|0,s=s+Math.imul(y,it)|0,n=(n=n+Math.imul(y,at)|0)+Math.imul(w,it)|0,i=i+Math.imul(w,at)|0,s=s+Math.imul(m,ct)|0,n=(n=n+Math.imul(m,ut)|0)+Math.imul(f,ct)|0,i=i+Math.imul(f,ut)|0;var St=(u+(s=s+Math.imul(l,lt)|0)|0)+((8191&(n=(n=n+Math.imul(l,dt)|0)+Math.imul(d,lt)|0))<<13)|0;u=((i=i+Math.imul(d,dt)|0)+(n>>>13)|0)+(St>>>26)|0,St&=67108863,s=Math.imul(L,H),n=(n=Math.imul(L,K))+Math.imul(U,H)|0,i=Math.imul(U,K),s=s+Math.imul(D,$)|0,n=(n=n+Math.imul(D,G)|0)+Math.imul(B,$)|0,i=i+Math.imul(B,G)|0,s=s+Math.imul(C,z)|0,n=(n=n+Math.imul(C,W)|0)+Math.imul(N,z)|0,i=i+Math.imul(N,W)|0,s=s+Math.imul(A,Y)|0,n=(n=n+Math.imul(A,Z)|0)+Math.imul(I,Y)|0,i=i+Math.imul(I,Z)|0,s=s+Math.imul(T,Q)|0,n=(n=n+Math.imul(T,tt)|0)+Math.imul(x,Q)|0,i=i+Math.imul(x,tt)|0,s=s+Math.imul(M,rt)|0,n=(n=n+Math.imul(M,st)|0)+Math.imul(S,rt)|0,i=i+Math.imul(S,st)|0,s=s+Math.imul(b,it)|0,n=(n=n+Math.imul(b,at)|0)+Math.imul(k,it)|0,i=i+Math.imul(k,at)|0,s=s+Math.imul(y,ct)|0,n=(n=n+Math.imul(y,ut)|0)+Math.imul(w,ct)|0,i=i+Math.imul(w,ut)|0,s=s+Math.imul(m,lt)|0,n=(n=n+Math.imul(m,dt)|0)+Math.imul(f,lt)|0,i=i+Math.imul(f,dt)|0;var Pt=(u+(s=s+Math.imul(l,mt)|0)|0)+((8191&(n=(n=n+Math.imul(l,ft)|0)+Math.imul(d,mt)|0))<<13)|0;u=((i=i+Math.imul(d,ft)|0)+(n>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,s=Math.imul(L,$),n=(n=Math.imul(L,G))+Math.imul(U,$)|0,i=Math.imul(U,G),s=s+Math.imul(D,z)|0,n=(n=n+Math.imul(D,W)|0)+Math.imul(B,z)|0,i=i+Math.imul(B,W)|0,s=s+Math.imul(C,Y)|0,n=(n=n+Math.imul(C,Z)|0)+Math.imul(N,Y)|0,i=i+Math.imul(N,Z)|0,s=s+Math.imul(A,Q)|0,n=(n=n+Math.imul(A,tt)|0)+Math.imul(I,Q)|0,i=i+Math.imul(I,tt)|0,s=s+Math.imul(T,rt)|0,n=(n=n+Math.imul(T,st)|0)+Math.imul(x,rt)|0,i=i+Math.imul(x,st)|0,s=s+Math.imul(M,it)|0,n=(n=n+Math.imul(M,at)|0)+Math.imul(S,it)|0,i=i+Math.imul(S,at)|0,s=s+Math.imul(b,ct)|0,n=(n=n+Math.imul(b,ut)|0)+Math.imul(k,ct)|0,i=i+Math.imul(k,ut)|0,s=s+Math.imul(y,lt)|0,n=(n=n+Math.imul(y,dt)|0)+Math.imul(w,lt)|0,i=i+Math.imul(w,dt)|0;var Tt=(u+(s=s+Math.imul(m,mt)|0)|0)+((8191&(n=(n=n+Math.imul(m,ft)|0)+Math.imul(f,mt)|0))<<13)|0;u=((i=i+Math.imul(f,ft)|0)+(n>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,s=Math.imul(L,z),n=(n=Math.imul(L,W))+Math.imul(U,z)|0,i=Math.imul(U,W),s=s+Math.imul(D,Y)|0,n=(n=n+Math.imul(D,Z)|0)+Math.imul(B,Y)|0,i=i+Math.imul(B,Z)|0,s=s+Math.imul(C,Q)|0,n=(n=n+Math.imul(C,tt)|0)+Math.imul(N,Q)|0,i=i+Math.imul(N,tt)|0,s=s+Math.imul(A,rt)|0,n=(n=n+Math.imul(A,st)|0)+Math.imul(I,rt)|0,i=i+Math.imul(I,st)|0,s=s+Math.imul(T,it)|0,n=(n=n+Math.imul(T,at)|0)+Math.imul(x,it)|0,i=i+Math.imul(x,at)|0,s=s+Math.imul(M,ct)|0,n=(n=n+Math.imul(M,ut)|0)+Math.imul(S,ct)|0,i=i+Math.imul(S,ut)|0,s=s+Math.imul(b,lt)|0,n=(n=n+Math.imul(b,dt)|0)+Math.imul(k,lt)|0,i=i+Math.imul(k,dt)|0;var xt=(u+(s=s+Math.imul(y,mt)|0)|0)+((8191&(n=(n=n+Math.imul(y,ft)|0)+Math.imul(w,mt)|0))<<13)|0;u=((i=i+Math.imul(w,ft)|0)+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,s=Math.imul(L,Y),n=(n=Math.imul(L,Z))+Math.imul(U,Y)|0,i=Math.imul(U,Z),s=s+Math.imul(D,Q)|0,n=(n=n+Math.imul(D,tt)|0)+Math.imul(B,Q)|0,i=i+Math.imul(B,tt)|0,s=s+Math.imul(C,rt)|0,n=(n=n+Math.imul(C,st)|0)+Math.imul(N,rt)|0,i=i+Math.imul(N,st)|0,s=s+Math.imul(A,it)|0,n=(n=n+Math.imul(A,at)|0)+Math.imul(I,it)|0,i=i+Math.imul(I,at)|0,s=s+Math.imul(T,ct)|0,n=(n=n+Math.imul(T,ut)|0)+Math.imul(x,ct)|0,i=i+Math.imul(x,ut)|0,s=s+Math.imul(M,lt)|0,n=(n=n+Math.imul(M,dt)|0)+Math.imul(S,lt)|0,i=i+Math.imul(S,dt)|0;var Et=(u+(s=s+Math.imul(b,mt)|0)|0)+((8191&(n=(n=n+Math.imul(b,ft)|0)+Math.imul(k,mt)|0))<<13)|0;u=((i=i+Math.imul(k,ft)|0)+(n>>>13)|0)+(Et>>>26)|0,Et&=67108863,s=Math.imul(L,Q),n=(n=Math.imul(L,tt))+Math.imul(U,Q)|0,i=Math.imul(U,tt),s=s+Math.imul(D,rt)|0,n=(n=n+Math.imul(D,st)|0)+Math.imul(B,rt)|0,i=i+Math.imul(B,st)|0,s=s+Math.imul(C,it)|0,n=(n=n+Math.imul(C,at)|0)+Math.imul(N,it)|0,i=i+Math.imul(N,at)|0,s=s+Math.imul(A,ct)|0,n=(n=n+Math.imul(A,ut)|0)+Math.imul(I,ct)|0,i=i+Math.imul(I,ut)|0,s=s+Math.imul(T,lt)|0,n=(n=n+Math.imul(T,dt)|0)+Math.imul(x,lt)|0,i=i+Math.imul(x,dt)|0;var At=(u+(s=s+Math.imul(M,mt)|0)|0)+((8191&(n=(n=n+Math.imul(M,ft)|0)+Math.imul(S,mt)|0))<<13)|0;u=((i=i+Math.imul(S,ft)|0)+(n>>>13)|0)+(At>>>26)|0,At&=67108863,s=Math.imul(L,rt),n=(n=Math.imul(L,st))+Math.imul(U,rt)|0,i=Math.imul(U,st),s=s+Math.imul(D,it)|0,n=(n=n+Math.imul(D,at)|0)+Math.imul(B,it)|0,i=i+Math.imul(B,at)|0,s=s+Math.imul(C,ct)|0,n=(n=n+Math.imul(C,ut)|0)+Math.imul(N,ct)|0,i=i+Math.imul(N,ut)|0,s=s+Math.imul(A,lt)|0,n=(n=n+Math.imul(A,dt)|0)+Math.imul(I,lt)|0,i=i+Math.imul(I,dt)|0;var It=(u+(s=s+Math.imul(T,mt)|0)|0)+((8191&(n=(n=n+Math.imul(T,ft)|0)+Math.imul(x,mt)|0))<<13)|0;u=((i=i+Math.imul(x,ft)|0)+(n>>>13)|0)+(It>>>26)|0,It&=67108863,s=Math.imul(L,it),n=(n=Math.imul(L,at))+Math.imul(U,it)|0,i=Math.imul(U,at),s=s+Math.imul(D,ct)|0,n=(n=n+Math.imul(D,ut)|0)+Math.imul(B,ct)|0,i=i+Math.imul(B,ut)|0,s=s+Math.imul(C,lt)|0,n=(n=n+Math.imul(C,dt)|0)+Math.imul(N,lt)|0,i=i+Math.imul(N,dt)|0;var Ot=(u+(s=s+Math.imul(A,mt)|0)|0)+((8191&(n=(n=n+Math.imul(A,ft)|0)+Math.imul(I,mt)|0))<<13)|0;u=((i=i+Math.imul(I,ft)|0)+(n>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,s=Math.imul(L,ct),n=(n=Math.imul(L,ut))+Math.imul(U,ct)|0,i=Math.imul(U,ut),s=s+Math.imul(D,lt)|0,n=(n=n+Math.imul(D,dt)|0)+Math.imul(B,lt)|0,i=i+Math.imul(B,dt)|0;var Ct=(u+(s=s+Math.imul(C,mt)|0)|0)+((8191&(n=(n=n+Math.imul(C,ft)|0)+Math.imul(N,mt)|0))<<13)|0;u=((i=i+Math.imul(N,ft)|0)+(n>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,s=Math.imul(L,lt),n=(n=Math.imul(L,dt))+Math.imul(U,lt)|0,i=Math.imul(U,dt);var Nt=(u+(s=s+Math.imul(D,mt)|0)|0)+((8191&(n=(n=n+Math.imul(D,ft)|0)+Math.imul(B,mt)|0))<<13)|0;u=((i=i+Math.imul(B,ft)|0)+(n>>>13)|0)+(Nt>>>26)|0,Nt&=67108863;var jt=(u+(s=Math.imul(L,mt))|0)+((8191&(n=(n=Math.imul(L,ft))+Math.imul(U,mt)|0))<<13)|0;return u=((i=Math.imul(U,ft))+(n>>>13)|0)+(jt>>>26)|0,jt&=67108863,c[0]=gt,c[1]=yt,c[2]=wt,c[3]=vt,c[4]=bt,c[5]=kt,c[6]=_t,c[7]=Mt,c[8]=St,c[9]=Pt,c[10]=Tt,c[11]=xt,c[12]=Et,c[13]=At,c[14]=It,c[15]=Ot,c[16]=Ct,c[17]=Nt,c[18]=jt,0!==u&&(c[19]=u,r.length++),r};function y(t,e,r){r.negative=e.negative^t.negative,r.length=t.length+e.length;for(var s=0,n=0,i=0;i<r.length-1;i++){var a=n;n=0;for(var o=67108863&s,c=Math.min(i,e.length-1),u=Math.max(0,i-t.length+1);u<=c;u++){var h=i-u,l=(0|t.words[h])*(0|e.words[u]),d=67108863&l;o=67108863&(d=d+o|0),n+=(a=(a=a+(l/67108864|0)|0)+(d>>>26)|0)>>>26,a&=67108863}r.words[i]=o,s=a,a=n}return 0!==s?r.words[i]=s:r.length--,r._strip()}function w(t,e,r){return y(t,e,r)}function v(t,e){this.x=t,this.y=e}Math.imul||(g=f),i.prototype.mulTo=function(t,e){var r=this.length+t.length;return 10===this.length&&10===t.length?g(this,t,e):r<63?f(this,t,e):r<1024?y(this,t,e):w(this,t,e)},v.prototype.makeRBT=function(t){for(var e=new Array(t),r=i.prototype._countBits(t)-1,s=0;s<t;s++)e[s]=this.revBin(s,r,t);return e},v.prototype.revBin=function(t,e,r){if(0===t||t===r-1)return t;for(var s=0,n=0;n<e;n++)s|=(1&t)<<e-n-1,t>>=1;return s},v.prototype.permute=function(t,e,r,s,n,i){for(var a=0;a<i;a++)s[a]=e[t[a]],n[a]=r[t[a]]},v.prototype.transform=function(t,e,r,s,n,i){this.permute(i,t,e,r,s,n);for(var a=1;a<n;a<<=1)for(var o=a<<1,c=Math.cos(2*Math.PI/o),u=Math.sin(2*Math.PI/o),h=0;h<n;h+=o)for(var l=c,d=u,p=0;p<a;p++){var m=r[h+p],f=s[h+p],g=r[h+p+a],y=s[h+p+a],w=l*g-d*y;y=l*y+d*g,g=w,r[h+p]=m+g,s[h+p]=f+y,r[h+p+a]=m-g,s[h+p+a]=f-y,p!==o&&(w=c*l-u*d,d=c*d+u*l,l=w)}},v.prototype.guessLen13b=function(t,e){var r=1|Math.max(e,t),s=1&r,n=0;for(r=r/2|0;r;r>>>=1)n++;return 1<<n+1+s},v.prototype.conjugate=function(t,e,r){if(!(r<=1))for(var s=0;s<r/2;s++){var n=t[s];t[s]=t[r-s-1],t[r-s-1]=n,n=e[s],e[s]=-e[r-s-1],e[r-s-1]=-n}},v.prototype.normalize13b=function(t,e){for(var r=0,s=0;s<e/2;s++){var n=8192*Math.round(t[2*s+1]/e)+Math.round(t[2*s]/e)+r;t[s]=67108863&n,r=n<67108864?0:n/67108864|0}return t},v.prototype.convert13b=function(t,e,r,n){for(var i=0,a=0;a<e;a++)i+=0|t[a],r[2*a]=8191&i,i>>>=13,r[2*a+1]=8191&i,i>>>=13;for(a=2*e;a<n;++a)r[a]=0;s(0===i),s(0==(-8192&i))},v.prototype.stub=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e},v.prototype.mulp=function(t,e,r){var s=2*this.guessLen13b(t.length,e.length),n=this.makeRBT(s),i=this.stub(s),a=new Array(s),o=new Array(s),c=new Array(s),u=new Array(s),h=new Array(s),l=new Array(s),d=r.words;d.length=s,this.convert13b(t.words,t.length,a,s),this.convert13b(e.words,e.length,u,s),this.transform(a,i,o,c,s,n),this.transform(u,i,h,l,s,n);for(var p=0;p<s;p++){var m=o[p]*h[p]-c[p]*l[p];c[p]=o[p]*l[p]+c[p]*h[p],o[p]=m}return this.conjugate(o,c,s),this.transform(o,c,d,i,s,n),this.conjugate(d,i,s),this.normalize13b(d,s),r.negative=t.negative^e.negative,r.length=t.length+e.length,r._strip()},i.prototype.mul=function(t){var e=new i(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},i.prototype.mulf=function(t){var e=new i(null);return e.words=new Array(this.length+t.length),w(this,t,e)},i.prototype.imul=function(t){return this.clone().mulTo(t,this)},i.prototype.imuln=function(t){var e=t<0;e&&(t=-t),s("number"==typeof t),s(t<67108864);for(var r=0,n=0;n<this.length;n++){var i=(0|this.words[n])*t,a=(67108863&i)+(67108863&r);r>>=26,r+=i/67108864|0,r+=a>>>26,this.words[n]=67108863&a}return 0!==r&&(this.words[n]=r,this.length++),e?this.ineg():this},i.prototype.muln=function(t){return this.clone().imuln(t)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),r=0;r<e.length;r++){var s=r/26|0,n=r%26;e[r]=t.words[s]>>>n&1}return e}(t);if(0===e.length)return new i(1);for(var r=this,s=0;s<e.length&&0===e[s];s++,r=r.sqr());if(++s<e.length)for(var n=r.sqr();s<e.length;s++,n=n.sqr())0!==e[s]&&(r=r.mul(n));return r},i.prototype.iushln=function(t){s("number"==typeof t&&t>=0);var e,r=t%26,n=(t-r)/26,i=67108863>>>26-r<<26-r;if(0!==r){var a=0;for(e=0;e<this.length;e++){var o=this.words[e]&i,c=(0|this.words[e])-o<<r;this.words[e]=c|a,a=o>>>26-r}a&&(this.words[e]=a,this.length++)}if(0!==n){for(e=this.length-1;e>=0;e--)this.words[e+n]=this.words[e];for(e=0;e<n;e++)this.words[e]=0;this.length+=n}return this._strip()},i.prototype.ishln=function(t){return s(0===this.negative),this.iushln(t)},i.prototype.iushrn=function(t,e,r){var n;s("number"==typeof t&&t>=0),n=e?(e-e%26)/26:0;var i=t%26,a=Math.min((t-i)/26,this.length),o=67108863^67108863>>>i<<i,c=r;if(n-=a,n=Math.max(0,n),c){for(var u=0;u<a;u++)c.words[u]=this.words[u];c.length=a}if(0===a);else if(this.length>a)for(this.length-=a,u=0;u<this.length;u++)this.words[u]=this.words[u+a];else this.words[0]=0,this.length=1;var h=0;for(u=this.length-1;u>=0&&(0!==h||u>=n);u--){var l=0|this.words[u];this.words[u]=h<<26-i|l>>>i,h=l&o}return c&&0!==h&&(c.words[c.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(t,e,r){return s(0===this.negative),this.iushrn(t,e,r)},i.prototype.shln=function(t){return this.clone().ishln(t)},i.prototype.ushln=function(t){return this.clone().iushln(t)},i.prototype.shrn=function(t){return this.clone().ishrn(t)},i.prototype.ushrn=function(t){return this.clone().iushrn(t)},i.prototype.testn=function(t){s("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26,n=1<<e;return!(this.length<=r)&&!!(this.words[r]&n)},i.prototype.imaskn=function(t){s("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26;if(s(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==e&&r++,this.length=Math.min(r,this.length),0!==e){var n=67108863^67108863>>>e<<e;this.words[this.length-1]&=n}return this._strip()},i.prototype.maskn=function(t){return this.clone().imaskn(t)},i.prototype.iaddn=function(t){return s("number"==typeof t),s(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<=t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},i.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},i.prototype.isubn=function(t){if(s("number"==typeof t),s(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this._strip()},i.prototype.addn=function(t){return this.clone().iaddn(t)},i.prototype.subn=function(t){return this.clone().isubn(t)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(t,e,r){var n,i,a=t.length+r;this._expand(a);var o=0;for(n=0;n<t.length;n++){i=(0|this.words[n+r])+o;var c=(0|t.words[n])*e;o=((i-=67108863&c)>>26)-(c/67108864|0),this.words[n+r]=67108863&i}for(;n<this.length-r;n++)o=(i=(0|this.words[n+r])+o)>>26,this.words[n+r]=67108863&i;if(0===o)return this._strip();for(s(-1===o),o=0,n=0;n<this.length;n++)o=(i=-(0|this.words[n])+o)>>26,this.words[n]=67108863&i;return this.negative=1,this._strip()},i.prototype._wordDiv=function(t,e){var r=(this.length,t.length),s=this.clone(),n=t,a=0|n.words[n.length-1];0!==(r=26-this._countBits(a))&&(n=n.ushln(r),s.iushln(r),a=0|n.words[n.length-1]);var o,c=s.length-n.length;if("mod"!==e){(o=new i(null)).length=c+1,o.words=new Array(o.length);for(var u=0;u<o.length;u++)o.words[u]=0}var h=s.clone()._ishlnsubmul(n,1,c);0===h.negative&&(s=h,o&&(o.words[c]=1));for(var l=c-1;l>=0;l--){var d=67108864*(0|s.words[n.length+l])+(0|s.words[n.length+l-1]);for(d=Math.min(d/a|0,67108863),s._ishlnsubmul(n,d,l);0!==s.negative;)d--,s.negative=0,s._ishlnsubmul(n,1,l),s.isZero()||(s.negative^=1);o&&(o.words[l]=d)}return o&&o._strip(),s._strip(),"div"!==e&&0!==r&&s.iushrn(r),{div:o||null,mod:s}},i.prototype.divmod=function(t,e,r){return s(!t.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:0!==this.negative&&0===t.negative?(o=this.neg().divmod(t,e),"mod"!==e&&(n=o.div.neg()),"div"!==e&&(a=o.mod.neg(),r&&0!==a.negative&&a.iadd(t)),{div:n,mod:a}):0===this.negative&&0!==t.negative?(o=this.divmod(t.neg(),e),"mod"!==e&&(n=o.div.neg()),{div:n,mod:o.mod}):0!=(this.negative&t.negative)?(o=this.neg().divmod(t.neg(),e),"div"!==e&&(a=o.mod.neg(),r&&0!==a.negative&&a.isub(t)),{div:o.div,mod:a}):t.length>this.length||this.cmp(t)<0?{div:new i(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new i(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new i(this.modrn(t.words[0]))}:this._wordDiv(t,e);var n,a,o},i.prototype.div=function(t){return this.divmod(t,"div",!1).div},i.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},i.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},i.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var r=0!==e.div.negative?e.mod.isub(t):e.mod,s=t.ushrn(1),n=t.andln(1),i=r.cmp(s);return i<0||1===n&&0===i?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},i.prototype.modrn=function(t){var e=t<0;e&&(t=-t),s(t<=67108863);for(var r=(1<<26)%t,n=0,i=this.length-1;i>=0;i--)n=(r*n+(0|this.words[i]))%t;return e?-n:n},i.prototype.modn=function(t){return this.modrn(t)},i.prototype.idivn=function(t){var e=t<0;e&&(t=-t),s(t<=67108863);for(var r=0,n=this.length-1;n>=0;n--){var i=(0|this.words[n])+67108864*r;this.words[n]=i/t|0,r=i%t}return this._strip(),e?this.ineg():this},i.prototype.divn=function(t){return this.clone().idivn(t)},i.prototype.egcd=function(t){s(0===t.negative),s(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var n=new i(1),a=new i(0),o=new i(0),c=new i(1),u=0;e.isEven()&&r.isEven();)e.iushrn(1),r.iushrn(1),++u;for(var h=r.clone(),l=e.clone();!e.isZero();){for(var d=0,p=1;0==(e.words[0]&p)&&d<26;++d,p<<=1);if(d>0)for(e.iushrn(d);d-- >0;)(n.isOdd()||a.isOdd())&&(n.iadd(h),a.isub(l)),n.iushrn(1),a.iushrn(1);for(var m=0,f=1;0==(r.words[0]&f)&&m<26;++m,f<<=1);if(m>0)for(r.iushrn(m);m-- >0;)(o.isOdd()||c.isOdd())&&(o.iadd(h),c.isub(l)),o.iushrn(1),c.iushrn(1);e.cmp(r)>=0?(e.isub(r),n.isub(o),a.isub(c)):(r.isub(e),o.isub(n),c.isub(a))}return{a:o,b:c,gcd:r.iushln(u)}},i.prototype._invmp=function(t){s(0===t.negative),s(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var n,a=new i(1),o=new i(0),c=r.clone();e.cmpn(1)>0&&r.cmpn(1)>0;){for(var u=0,h=1;0==(e.words[0]&h)&&u<26;++u,h<<=1);if(u>0)for(e.iushrn(u);u-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);for(var l=0,d=1;0==(r.words[0]&d)&&l<26;++l,d<<=1);if(l>0)for(r.iushrn(l);l-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);e.cmp(r)>=0?(e.isub(r),a.isub(o)):(r.isub(e),o.isub(a))}return(n=0===e.cmpn(1)?a:o).cmpn(0)<0&&n.iadd(t),n},i.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),r=t.clone();e.negative=0,r.negative=0;for(var s=0;e.isEven()&&r.isEven();s++)e.iushrn(1),r.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;r.isEven();)r.iushrn(1);var n=e.cmp(r);if(n<0){var i=e;e=r,r=i}else if(0===n||0===r.cmpn(1))break;e.isub(r)}return r.iushln(s)},i.prototype.invm=function(t){return this.egcd(t).a.umod(t)},i.prototype.isEven=function(){return 0==(1&this.words[0])},i.prototype.isOdd=function(){return 1==(1&this.words[0])},i.prototype.andln=function(t){return this.words[0]&t},i.prototype.bincn=function(t){s("number"==typeof t);var e=t%26,r=(t-e)/26,n=1<<e;if(this.length<=r)return this._expand(r+1),this.words[r]|=n,this;for(var i=n,a=r;0!==i&&a<this.length;a++){var o=0|this.words[a];i=(o+=i)>>>26,o&=67108863,this.words[a]=o}return 0!==i&&(this.words[a]=i,this.length++),this},i.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},i.prototype.cmpn=function(t){var e,r=t<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)e=1;else{r&&(t=-t),s(t<=67108863,"Number is too big");var n=0|this.words[0];e=n===t?0:n<t?-1:1}return 0!==this.negative?0|-e:e},i.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},i.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,r=this.length-1;r>=0;r--){var s=0|this.words[r],n=0|t.words[r];if(s!==n){s<n?e=-1:s>n&&(e=1);break}}return e},i.prototype.gtn=function(t){return 1===this.cmpn(t)},i.prototype.gt=function(t){return 1===this.cmp(t)},i.prototype.gten=function(t){return this.cmpn(t)>=0},i.prototype.gte=function(t){return this.cmp(t)>=0},i.prototype.ltn=function(t){return-1===this.cmpn(t)},i.prototype.lt=function(t){return-1===this.cmp(t)},i.prototype.lten=function(t){return this.cmpn(t)<=0},i.prototype.lte=function(t){return this.cmp(t)<=0},i.prototype.eqn=function(t){return 0===this.cmpn(t)},i.prototype.eq=function(t){return 0===this.cmp(t)},i.red=function(t){return new T(t)},i.prototype.toRed=function(t){return s(!this.red,"Already a number in reduction context"),s(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},i.prototype.fromRed=function(){return s(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(t){return this.red=t,this},i.prototype.forceRed=function(t){return s(!this.red,"Already a number in reduction context"),this._forceRed(t)},i.prototype.redAdd=function(t){return s(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},i.prototype.redIAdd=function(t){return s(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},i.prototype.redSub=function(t){return s(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},i.prototype.redISub=function(t){return s(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},i.prototype.redShl=function(t){return s(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},i.prototype.redMul=function(t){return s(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},i.prototype.redIMul=function(t){return s(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},i.prototype.redSqr=function(){return s(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return s(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return s(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return s(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return s(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(t){return s(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var b={k256:null,p224:null,p192:null,p25519:null};function k(t,e){this.name=t,this.p=new i(e,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function _(){k.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function M(){k.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function S(){k.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P(){k.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(t){if("string"==typeof t){var e=i._prime(t);this.m=e.p,this.prime=e}else s(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function x(t){T.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}k.prototype._tmp=function(){var t=new i(null);return t.words=new Array(Math.ceil(this.n/13)),t},k.prototype.ireduce=function(t){var e,r=t;do{this.split(r,this.tmp),e=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(e>this.n);var s=e<this.n?-1:r.ucmp(this.p);return 0===s?(r.words[0]=0,r.length=1):s>0?r.isub(this.p):r.strip!==undefined?r.strip():r._strip(),r},k.prototype.split=function(t,e){t.iushrn(this.n,0,e)},k.prototype.imulK=function(t){return t.imul(this.k)},n(_,k),_.prototype.split=function(t,e){for(var r=4194303,s=Math.min(t.length,9),n=0;n<s;n++)e.words[n]=t.words[n];if(e.length=s,t.length<=9)return t.words[0]=0,void(t.length=1);var i=t.words[9];for(e.words[e.length++]=i&r,n=10;n<t.length;n++){var a=0|t.words[n];t.words[n-10]=(a&r)<<4|i>>>22,i=a}i>>>=22,t.words[n-10]=i,0===i&&t.length>10?t.length-=10:t.length-=9},_.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,r=0;r<t.length;r++){var s=0|t.words[r];e+=977*s,t.words[r]=67108863&e,e=64*s+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},n(M,k),n(S,k),n(P,k),P.prototype.imulK=function(t){for(var e=0,r=0;r<t.length;r++){var s=19*(0|t.words[r])+e,n=67108863&s;s>>>=26,t.words[r]=n,e=s}return 0!==e&&(t.words[t.length++]=e),t},i._prime=function(t){if(b[t])return b[t];var e;if("k256"===t)e=new _;else if("p224"===t)e=new M;else if("p192"===t)e=new S;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new P}return b[t]=e,e},T.prototype._verify1=function(t){s(0===t.negative,"red works only with positives"),s(t.red,"red works only with red numbers")},T.prototype._verify2=function(t,e){s(0==(t.negative|e.negative),"red works only with positives"),s(t.red&&t.red===e.red,"red works only with red numbers")},T.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(h(t,t.umod(this.m)._forceRed(this)),t)},T.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},T.prototype.add=function(t,e){this._verify2(t,e);var r=t.add(e);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},T.prototype.iadd=function(t,e){this._verify2(t,e);var r=t.iadd(e);return r.cmp(this.m)>=0&&r.isub(this.m),r},T.prototype.sub=function(t,e){this._verify2(t,e);var r=t.sub(e);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},T.prototype.isub=function(t,e){this._verify2(t,e);var r=t.isub(e);return r.cmpn(0)<0&&r.iadd(this.m),r},T.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},T.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},T.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},T.prototype.isqr=function(t){return this.imul(t,t.clone())},T.prototype.sqr=function(t){return this.mul(t,t)},T.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(s(e%2==1),3===e){var r=this.m.add(new i(1)).iushrn(2);return this.pow(t,r)}for(var n=this.m.subn(1),a=0;!n.isZero()&&0===n.andln(1);)a++,n.iushrn(1);s(!n.isZero());var o=new i(1).toRed(this),c=o.redNeg(),u=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new i(2*h*h).toRed(this);0!==this.pow(h,u).cmp(c);)h.redIAdd(c);for(var l=this.pow(h,n),d=this.pow(t,n.addn(1).iushrn(1)),p=this.pow(t,n),m=a;0!==p.cmp(o);){for(var f=p,g=0;0!==f.cmp(o);g++)f=f.redSqr();s(g<m);var y=this.pow(l,new i(1).iushln(m-g-1));d=d.redMul(y),l=y.redSqr(),p=p.redMul(l),m=g}return d},T.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},T.prototype.pow=function(t,e){if(e.isZero())return new i(1).toRed(this);if(0===e.cmpn(1))return t.clone();var r=new Array(16);r[0]=new i(1).toRed(this),r[1]=t;for(var s=2;s<r.length;s++)r[s]=this.mul(r[s-1],t);var n=r[0],a=0,o=0,c=e.bitLength()%26;for(0===c&&(c=26),s=e.length-1;s>=0;s--){for(var u=e.words[s],h=c-1;h>=0;h--){var l=u>>h&1;n!==r[0]&&(n=this.sqr(n)),0!==l||0!==a?(a<<=1,a|=l,(4===++o||0===s&&0===h)&&(n=this.mul(n,r[a]),o=0,a=0)):o=0}c=26}return n},T.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},T.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},i.mont=function(t){return new x(t)},n(x,T),x.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},x.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},x.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(e),s=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(s).iushrn(this.shift),i=n;return n.cmp(this.m)>=0?i=n.isub(this.m):n.cmpn(0)<0&&(i=n.iadd(this.m)),i._forceRed(this)},x.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new i(0)._forceRed(this);var r=t.mul(e),s=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(s).iushrn(this.shift),a=n;return n.cmp(this.m)>=0?a=n.isub(this.m):n.cmpn(0)<0&&(a=n.iadd(this.m)),a._forceRed(this)},x.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===e||e,this)}}},{package:"bn.js",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/eth-lattice-keyring/node_modules/bn.js/lib/bn.js"}],[5001,{"./client":4996,"./constants":4997},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Constants=r.Client=void 0;var s=t("./client");Object.defineProperty(r,"Client",{enumerable:!0,get:function(){return s.Client}});var n=t("./constants");Object.defineProperty(r,"Constants",{enumerable:!0,get:function(){return n.EXTERNAL}})}}},{package:"gridplus-sdk",file:"/Users/mac/code/a-mises/metamask-extension/node_modules/gridplus-sdk/dist/index.js"}],[7517,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getBaseApi=r.MISES_SITE_API=r.MISES_POINT=void 0;const s="https://api.alb.mises.site/api/v1";r.MISES_SITE_API=s;r.MISES_POINT="http://127.0.0.1:26657";r.getBaseApi=t=>{switch(t){case"signin":return`${s}/signin`;case"gasprices":return`${s}/mises/gasprices`;case"assets":return`${s}/opensea/assets`;case"single_asset":return`${s}/opensea/single_asset`;case"assets_contract":return`${s}/opensea/assets_contract`;default:throw new Error("getBaseApi requires an api call type")}}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/ui/misesPages/accountSet/misesNetwork.util.js"}],[7461,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.request=function(t){return new Promise(((e,r)=>{window.fetch(t.url,{method:t.method||"GET",body:JSON.stringify(t.body||t.params),headers:t.headers||{"Content-Type":"application/json;charset=utf-8"}}).then((async s=>{if(200===s.status){const n=await s.json();t.isCustom&&e(n),0===n.code?e(n.data):r(n.message)}else r(s.statusText)})).catch(r)}))}}}},{package:"<root>",file:"/Users/mac/code/a-mises/metamask-extension/ui/helpers/utils/fetch.js"}]],[],{});